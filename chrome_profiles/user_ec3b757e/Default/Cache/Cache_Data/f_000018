(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"/qTK":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),c=n("tk/3");let a=(()=>{class e{constructor(e){this.http=e}filter(e,t,n){let i=`?ordering=-pk&page=${t}&page_size=${e}`;return Object.keys(n).forEach(e=>{null!==n[e]&&n[e]&&(i+="&"+e+"="+n[e])}),this.http.get("/api/voicemailmessages/"+i)}list(e,t){return this.http.get(t?`/api/voicemailmessages/?page=${t}&page_size=${e}&ordering=-pk`:`/api/voicemailmessages/?page_size=${e}&ordering=-pk`)}getByVoicemail(e,t,n,i){let c=`?ordering=-pk&voice_mail_id=${e}\n\t\t\t${t?"&page_size="+t:""}${n?"&page="+n:""}`;return i&&Object.keys(i).forEach(e=>{null!==i[e]&&i[e]&&(c+="&"+e+"="+i[e])}),this.http.get("/api/voicemailmessages/"+c)}getByVoicemailQueue(e,t){let n="?ordering=-pk&voice_mail_queue_id="+e;return t&&Object.keys(t).forEach(e=>{null!==t[e]&&t[e]&&(n+="&"+e+"="+t[e])}),this.http.get("/api/voicemailmessages/"+n)}deleteAll(){return this.http.delete("/api/voicemailmessages/bulkdelete/",{observe:"response"})}bulkDelete(e){return this.http.delete("/api/voicemailmessages/bulkdelete/?id__in="+e,{observe:"response"})}delete(e){return this.http.delete(`/api/voicemailmessages/${e}/`)}updateReviewedOnDate(e){const t=(new Date).toISOString();return this.http.patch(`/api/voicemailmessages/${e}/`,{reviewed_on:t})}}return e.\u0275fac=function(t){return new(t||e)(i.nc(c.b))},e.\u0275prov=i.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},DD8m:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),c=n("tk/3");let a=(()=>{class e{constructor(e){this.http=e}getDestinationsByType(e,t){return this.http.get(`/api/destinations/?${e}=${t}`)}getDestinationParents(e){return this.http.get(`/api/destinations/${e}/parents/`)}list(e,t,n){return this.http.get(t?`/api/destinations/?ordering=destination_type&page=${t}&page_size=${e}${n?"&has_extension=true":""}`:`/api/destinations/?ordering=destination_type&page_size=${e}${n?"&has_extension=true":""}`)}get(e){return this.http.get(`/api/destinations/${e}/`)}getByIds(e){return this.http.get("/api/destinations/?page_size=max&id__in="+e)}getByUrl(e){return this.http.get(""+e)}search(e,t){return this.http.get(`/api/destinations/?page=${e}&page_size=250&search=${t}`)}}return e.\u0275fac=function(t){return new(t||e)(i.nc(c.b))},e.\u0275prov=i.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},H4hi:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),c=n("tk/3");let a=(()=>{class e{constructor(e){this.http=e}list(e,t){return this.http.get(t?`/api/inboundroutesminimal/?ordering=-pk&page=${t}&page_size=${e}`:"/api/inboundroutesminimal/?ordering=-pk&page_size="+e)}get(e){return this.http.get(`/api/inboundroutesminimal/${e}/`)}getIdIn(e){return this.http.get(`/api/inboundroutesminimal/?id__in=${e}&page_size=max`)}getByUrl(e){return this.http.get(""+e)}search(e,t){return this.http.get(`/api/inboundroutesminimal/?page=${e}&search=${t}`)}filter(e,t,n){let i=`?ordering=-pk&page=${t}&page_size=${e}`;return Object.keys(n).forEach(e=>{null!==n[e]&&""!==n[e]&&(i+="&"+e+"="+n[e])}),this.http.get("/api/inboundroutesminimal/"+i)}}return e.\u0275fac=function(t){return new(t||e)(i.nc(c.b))},e.\u0275prov=i.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},M4Aq:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("XNiG"),c=n("Evvo"),a=n("zBIn"),o=n("N/25"),s=n("BGFF"),r=n("fXoL");let d=(()=>{class e{constructor(e,t,n){this.accountSettingService=e,this.authService=t,this.userService=n,this.accountSettingsSubject=new i.a,s.listen(e=>{"streaming_api"===e.method&&"accountsettings"===e.model&&this.accountSettingsSubject.next(e.instance)})}getAccountSettings(){this.userService.get(this.authService.getUserId()).subscribe({next:e=>{this.accountSettingService.getByAccountId(e.account_id).subscribe({next:e=>{this.accountSettingsSubject.next(e),this.accountSettings=e}})}})}updateBannerAction(e,t){return this.accountSettingService.updateBannerAction(e,t)}}return e.\u0275fac=function(t){return new(t||e)(r.nc(c.a),r.nc(o.a),r.nc(a.a))},e.\u0275prov=r.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},MkU4:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("fXoL"),c=n("tk/3");let a=(()=>{class e{constructor(e){this.http=e}list(e,t,n){return this.http.get(t?`/api/voicemails/?page=${t}&page_size=${e}${n?"&search="+n:""}`:"/api/voicemails/?page_size="+e)}getByUserId(e,t,n){return this.http.get(`/api/voicemails/?app_user=${e}&page_size=${t}${n?"&page="+n:""}`)}create(e){return this.http.post("/api/voicemails/",e)}update(e,t){return this.http.patch(`/api/voicemails/${e}/`,t)}delete(e){return this.http.delete(`/api/voicemails/${e}/`)}}return e.\u0275fac=function(t){return new(t||e)(i.nc(c.b))},e.\u0275prov=i.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},PyWE:function(e,t,n){"use strict";n.r(t),n.d(t,"AgentModule",(function(){return lv}));var i=n("PCNd"),c=n("tyNb"),a=n("fXoL"),o=n("R0Ic"),s=n("/6jY"),r=n("N/25"),d=n("NkwR"),l=n("qqew"),u=n("IbGr"),g=n("5Tly"),h=n("LVVo"),b=n("gy+x"),p=n("SqhC"),v=n("gFx0"),m=n("fkGI"),f=n("d0VH"),S=n("nfIR"),_=n("SNGp"),y=n("DD8m"),C=n("8nRA"),P=n("M4Aq");let w=(()=>{class e{constructor(e,t,n,i){this.agentContactService=e,this.agentStatusService=t,this.agentCampaignService=n,this.webPhoneSessionsService=i}getReportingStats(){let e={};const t=this.agentContactService.campaignContactSubject.value,n=this.agentContactService.contactSubject.value;if(n&&n.id){if(this.webPhoneSessionsService.callVariables[n.id]){const t=this.webPhoneSessionsService.callVariables[n.id];e.campaign=t.campaign,e.bucket=t.bucket,e.live_filter=t.live_filter,e.inbound_route=t.inbound_route,e.queue=t.queue}else if(t&&t.id===n.id&&this.agentStatusService.agentStatusSubject.value&&this.agentStatusService.agentStatusSubject.value.campaign){const t=this.agentCampaignService.campaignMap[this.agentStatusService.agentStatusSubject.value.campaign];e.campaign=t.id,e.bucket=t.bucket,e.live_filter=t.live_filter}}else if(this.webPhoneSessionsService.callVariables.newContact){const t=this.webPhoneSessionsService.callVariables.newContact;e.campaign=t.campaign,e.bucket=t.bucket,e.live_filter=t.live_filter,e.inbound_route=t.inbound_route,e.queue=t.queue}else if(this.agentStatusService.agentStatusSubject.value&&this.agentStatusService.agentStatusSubject.value.campaign){const t=this.agentCampaignService.campaignMap[this.agentStatusService.agentStatusSubject.value.campaign];e.campaign=t.id,e.bucket=t.bucket,e.live_filter=t.live_filter}return e}}return e.\u0275fac=function(t){return new(t||e)(a.nc(f.a),a.nc(p.a),a.nc(l.a),a.nc(C.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M=n("w0BY"),x=n("2Vo4"),B=n("FtZ2"),k=n("dNgK");let F=(()=>{class e{constructor(e,t,n,i,c){this._snackBar=e,this._webPhoneSessionsService=t,this._webPhoneWindowService=n,this._livePhoneCallsService=i,this._webPhoneService=c,this.transferInitiated=!1,this.threeWayCallInitiated=!1,this.dialExtensionDelay=100,this.transferControlDelay=3200,this.callPendingTransfer=new x.a(null),this.callPendingIntervalSpeed=3e3,this.phoneEventSubscription=this._webPhoneService.phoneEvents.subscribe(e=>{e&&"ended"===e.type&&(this.transferInitiated||this.threeWayCallInitiated)&&(this.transferInitiated=!1,this.threeWayCallInitiated=!1)}),this.callPendingTransfer.subscribe({next:e=>{e?this._startInterval():this._stopInterval()}})}ngOnDestroy(){this.phoneEventSubscription.unsubscribe()}handleConnectorTransfer(e,t){this._webPhoneSessionsService.activeSession?"Blind Transfer"===e.transfer_type?(this.initiateBlindTransfer(),setTimeout(()=>{this._webPhoneSessionsService.sendDTMF(t)},this.dialExtensionDelay)):"Attended Transfer"===e.transfer_type&&(this.initiateTransfer(),setTimeout(()=>{this._webPhoneSessionsService.sendDTMF(t),setTimeout(()=>{this._showTransferControls()},this.transferControlDelay)},this.dialExtensionDelay)):this._webPhoneSessionsService.call(JSON.stringify(t))}_showTransferControls(){this.threeWayCallInitiated=!1,this.transferInitiated=!0,this._webPhoneWindowService.changeSelectedWindow("transfer-controls")}initiateTransfer(){this.callPendingTransfer.next(this._webPhoneSessionsService.activeSession.data.callUuid),this._webPhoneService.initiateTransfer(this._webPhoneSessionsService.activeSession)}initiateBlindTransfer(){this._webPhoneService.initiateBlindTransfer(this._webPhoneSessionsService.activeSession)}_startInterval(){this.interval=setInterval(()=>{this._webPhoneSessionsService.activeSession?this._livePhoneCallsService.getByCallUuid(this.callPendingTransfer.value).subscribe({error:e=>{404===e.status&&(this._stopInterval(),this._snackBar.open("Call pending transfer has ended","X",{duration:7e3,verticalPosition:"top",panelClass:["error"]}),this.callPendingTransfer.next(null),this.transferInitiated=!1,this._webPhoneWindowService.changeSelectedWindow("current-call"))}}):this._stopInterval()},this.callPendingIntervalSpeed)}_stopInterval(){this.interval&&(clearInterval(this.interval),this.interval=null)}}return e.\u0275fac=function(t){return new(t||e)(a.nc(k.a),a.nc(C.a),a.nc(M.a),a.nc(B.a),a.nc(s.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=n("zBIn"),D=n("+3se"),T=n("mqbH");let j=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p){this._snackBar=e,this._userService=t,this._authService=n,this._utils=i,this._agentContactService=c,this._connectorButtonService=a,this._connectorButtonEventService=o,this._agentContactFieldService=s,this._destinationService=r,this._agentUserService=d,this._contactNoteService=l,this._agentReportingStatService=u,this._agentAccountSettingsService=g,this._webPhoneSessionsService=h,this._webPhoneService=b,this._webPhoneTransferService=p,this.connectorButtonMap=[],this.orderedBaseConnectorButtons=[],this.connectorRunning=null,this.lastNote="",this._normalizePhoneNumber=e=>{let t=e.startsWith("+")?e.substring(1):e;return t.startsWith("1")&&t.length>10&&(t=t.substring(1)),t=t.replace(/[^0-9]/g,""),t},this.phoneEventSubscription=this._webPhoneService.phoneEvents.subscribe(e=>{e&&("confirmed"===e.type?this._handleConfirmedCall():"ended"===e.type&&this._handleEndedCall())})}ngOnDestroy(){this.phoneEventSubscription.unsubscribe()}_handleEndedCall(){if(this._authService.currentUser.value&&this._authService.currentUser.value.auto_call_end_connector){const e=this.connectorButtonMap[this._authService.currentUser.value.auto_call_end_connector],t=this._agentContactService.contactSubject.value;e&&t&&!e.transfer_type&&(this._createConnectorButtonEvent(e.id,!0),this.runConnector(this._authService.currentUser.value.auto_call_end_connector))}}_handleConfirmedCall(){if(this._webPhoneSessionsService.activeSession&&this._authService.currentUser.value&&this._authService.currentUser.value.auto_call_start_connector){const e=this.connectorButtonMap[this._authService.currentUser.value.auto_call_start_connector],t=this._agentContactService.contactSubject.value;if(e&&t&&!e.transfer_type){const n=this._webPhoneSessionsService.activeSession.data.phoneNumber;if(t._phone_numbers&&t._phone_numbers.length){const i=this._normalizePhoneNumber(n);-1!==t._phone_numbers.findIndex(e=>this._normalizePhoneNumber(e.phone_number)===i)&&(this._createConnectorButtonEvent(e.id,!0),this.runConnector(this._authService.currentUser.value.auto_call_start_connector))}}}}getConnectors(){this._userService.getUserConnectors(this._authService.getUserId()).subscribe({next:e=>{this.orderedBaseConnectorButtons=e.ordered_base_connectors,this.campaignConnectorButtons=e.campaign_connectors,this.queueConnectorButtons=e.queue_connectors,this.connectorButtonMap.length||this.buildConnectorButtonMap()}})}buildConnectorButtonMap(){this._connectorButtonService.list("max").subscribe({next:e=>{e.results.forEach(e=>{this.connectorButtonMap[e.id]=e})}})}_createConnectorButtonEvent(e,t){const n=this._agentContactService.contactSubject.value,i=this._getActiveNumber(),c={connector_button:e,app_user:this._authService.getUserId(),phone_number:i,contact:n?n.id:null},a=this._agentReportingStatService.getReportingStats();Object.keys(a).forEach(e=>{a[e]&&(c[e]=a[e])}),t&&(c.auto_call_triggered=!0),this._connectorButtonEventService.create(c).subscribe()}onConnectorButtonClick(e){var t;const n=this.connectorButtonMap[e];if(n&&("Attended Transfer"===(null==n?void 0:n.transfer_type)||"Blind Transfer"===(null==n?void 0:n.transfer_type))&&this._webPhoneSessionsService.activeSession&&(null===(t=this._webPhoneSessionsService.activeSession.data)||void 0===t?void 0:t.callStartTime)){const e=10;if(this._utils.getEpochTimeDifference(this._webPhoneSessionsService.activeSession.data.callStartTime)<e)return void this._snackBar.open(`Cannot transfer call until ${e} seconds have passed`,"X",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}this._createConnectorButtonEvent(e),this.runConnector(e)}runConnector(e){const t=JSON.parse(JSON.stringify(this.connectorButtonMap[e]));if(this.connectorRunning=e,setTimeout(()=>{this.connectorRunning=null},5e3),this._agentContactService.contactSubject.value||t.transfer_type&&t.destination){if(t.url&&(this._getActiveNumber(),this._agentContactService.contactSubject.value&&this._agentContactService.contactSubject.value.id?this._contactNoteService.getContactsMostRecentNote(this._agentContactService.contactSubject.value.id).subscribe({next:e=>{this.lastNote=e.results.length?e.results[0].note:"",this._buildAndSubmitForm(t)},error:()=>{this.lastNote="",this._buildAndSubmitForm(t)}}):(this.lastNote="",this._buildAndSubmitForm(t))),t.transfer_type){if(!t.destination)return void this._snackBar.open("This connector is missing a destination value","X",{duration:3e3,verticalPosition:"top",panelClass:"error"});if(this._webPhoneSessionsService.activeSession&&(0===this._webPhoneSessionsService.activeSession._status||1===this._webPhoneSessionsService.activeSession._status||2===this._webPhoneSessionsService.activeSession._status||5===this._webPhoneSessionsService.activeSession._status||8===this._webPhoneSessionsService.activeSession._status))return this._snackBar.open("Cannot complete transfer while a call is currently in progress..","",{duration:8e3,verticalPosition:"top",panelClass:"error"}),void(this.connectorRunning=null);this._destinationService.get(t.destination).subscribe({next:e=>{this._webPhoneTransferService.handleConnectorTransfer(t,e.extension)}})}}else this._snackBar.open("Please select a contact.","X",{duration:2500,verticalPosition:"top",panelClass:["error"]})}_buildAndSubmitForm(e){let t=this._formatFields(e),n=this._createFormHTML(t,this._getConnectorUrl(e),e),i=this._createElementFromHTML(n);e.use_popup?(this.externalPopUpWindow&&this.externalPopUpWindow.close(),this.externalPopUpWindow=window.open(e.url,"formResult",`width=${e.popup_width},\n\t\t\t\theight=${e.popup_height},\n\t\t\t\tleft=${e.popup_position_left},\n\t\t\t\ttop=${e.popup_position_top}`),window&&this.externalPopUpWindow&&window.focus&&this.externalPopUpWindow.focus(),this.externalPopUpWindow&&this.externalPopUpWindow.document.body.appendChild(i).submit()):document.body.appendChild(i).submit()}_createElementFromHTML(e){let t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}_formatFields(e){let t={},n=[],i=[];return e.headers.forEach(e=>{const c=e.value.match(/[^{]+(?=\})/g),a=e.value.match(/[^<]+(?=\>)/g);let o=new RegExp('"',"g");e.value=e.value.replace(o,"'"),e.value=e.value.replace(/[\u0000-\u0019]+/g,""),c&&(c.forEach(e=>{if(e.includes("-ncc")&&"active_number-ncc"!==e){let t="";t=e.replace("-ncc",""),n[e]=this._agentContactService.contactSubject.value[t]?this._stripCountryCode(this._agentContactService.contactSubject.value[t]):""}else this._agentContactService.contactSubject.value[e]&&(n[e]=this._agentContactService.contactSubject.value[e])}),c.forEach(t=>{"last_note_text"!==t&&"active_number"!==t&&"call_uuid"!==t&&"campaign_id"!==t&&"queue_id"!==t&&"userInfo_user_id"!==t&&"userInfo_full_name"!==t&&"userInfo_first_name"!==t&&"userInfo_last_name"!==t&&"userInfo_email"!==t&&"active_number-ncc"!==t?e.value=e.value.split("{"+t+"}").join(n[t]?n[t]:""):"call_uuid"===t?e.value=e.value.split("{call_uuid}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.callUuid?this._webPhoneSessionsService.previousCall.data.callUuid:""):"campaign_id"===t?e.value=e.value.split("{campaign_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.campaignId?this._webPhoneSessionsService.previousCall.data.campaignId.toString():""):"queue_id"===t?e.value=e.value.split("{queue_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.queueId?this._webPhoneSessionsService.previousCall.data.queueId.toString():""):"userInfo_user_id"===t?e.value=e.value.split("{userInfo_user_id}").join(this._authService.currentUser.value?this._authService.currentUser.value.app_user:""):"userInfo_full_name"===t?e.value=e.value.split("{userInfo_full_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.full_name:""):"userInfo_first_name"===t?e.value=e.value.split("{userInfo_first_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.first_name:""):"userInfo_last_name"===t?e.value=e.value.split("{userInfo_last_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.last_name:""):"userInfo_email"===t?e.value=e.value.split("{userInfo_email}").join(this._authService.currentUser.value?this._authService.currentUser.value.email:""):"last_note_text"===t?e.value=e.value.split("{last_note_text}").join(this.lastNote?this.lastNote:""):"active_number"!==t&&"active_number-ncc"!==t||(e.value=e.value.split("active_number"===t?"{active_number}":"{active_number-ncc}").join(this._getActiveNumber()?"active_number"===t?this._getActiveNumber():this._stripCountryCode(this._getActiveNumber()):""))})),a&&(a.forEach(e=>{this._agentUserService.user.custom_settings[e]?i[e]=this._agentUserService.user.custom_settings[e]:this._agentAccountSettingsService.accountSettings.custom_settings[e]&&(i[e]=this._agentAccountSettingsService.accountSettings.custom_settings[e])}),a.forEach(t=>{e.value=e.value.split("<"+t+">").join(i[t]?i[t]:"")})),t[e.key]=e.value.trim()}),e.body.forEach(e=>{const c=e.value.match(/[^{]+(?=\})/g),a=e.value.match(/[^<]+(?=\>)/g);let o=new RegExp('"',"g");e.value=e.value.replace(o,"'"),e.value=e.value.replace(/[\u0000-\u0019]+/g,""),c&&(c.forEach(e=>{if(e.includes("-ncc")&&"active_number-ncc"!==e){let t="";t=e.replace("-ncc",""),n[e]=this._agentContactService.contactSubject.value[t]?this._stripCountryCode(this._agentContactService.contactSubject.value[t]):""}else this._agentContactService.contactSubject.value[e]&&(n[e]=this._agentContactService.contactSubject.value[e])}),c.forEach(t=>{"last_note_text"!==t&&"call_uuid"!==t&&"campaign_id"!==t&&"queue_id"!==t&&"userInfo_user_id"!==t&&"userInfo_full_name"!==t&&"userInfo_first_name"!==t&&"userInfo_last_name"!==t&&"userInfo_email"!==t&&"active_number"!==t&&"active_number-ncc"!==t?e.value=e.value.split("{"+t+"}").join(n[t]?n[t]:""):"call_uuid"===t?e.value=e.value.split("{call_uuid}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.callUuid?this._webPhoneSessionsService.previousCall.data.callUuid:""):"campaign_id"===t?e.value=e.value.split("{campaign_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.campaignId?this._webPhoneSessionsService.previousCall.data.campaignId.toString():""):"queue_id"===t?e.value=e.value.split("{queue_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.queueId?this._webPhoneSessionsService.previousCall.data.queueId.toString():""):"userInfo_user_id"===t?e.value=e.value.split("{userInfo_user_id}").join(this._authService.currentUser.value?this._authService.currentUser.value.app_user:""):"userInfo_full_name"===t?e.value=e.value.split("{userInfo_full_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.full_name:""):"userInfo_first_name"===t?e.value=e.value.split("{userInfo_first_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.first_name:""):"userInfo_last_name"===t?e.value=e.value.split("{userInfo_last_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.last_name:""):"userInfo_email"===t?e.value=e.value.split("{userInfo_email}").join(this._authService.currentUser.value?this._authService.currentUser.value.email:""):"last_note_text"===t?e.value=e.value.split("{last_note_text}").join(this.lastNote?this.lastNote:""):"active_number"!==t&&"active_number-ncc"!==t||(e.value=e.value.split("active_number"===t?"{active_number}":"{active_number-ncc}").join(this._getActiveNumber()?"active_number"===t?this._getActiveNumber():this._stripCountryCode(this._getActiveNumber()):""))})),a&&(a.forEach(e=>{this._agentUserService.user.custom_settings[e]?i[e]=this._agentUserService.user.custom_settings[e]:this._agentAccountSettingsService.accountSettings.custom_settings[e]&&(i[e]=this._agentAccountSettingsService.accountSettings.custom_settings[e])}),a.forEach(t=>{e.value=e.value.split("<"+t+">").join(i[t]?i[t]:"")})),t[e.key]=e.value.trim()}),t}_createFormHTML(e,t,n){const i=n.request_type,c=n.content_type;let a=e,o=[];const s=t.match(/[^<]+(?=\>)/g);s&&(s.forEach(e=>{this._agentUserService.user.custom_settings[e]?o.push(this._agentUserService.user.custom_settings[e]):this._agentAccountSettingsService.accountSettings.custom_settings[e]&&o.push(this._agentAccountSettingsService.accountSettings.custom_settings[e])}),s.forEach((e,n)=>{t=t.split("<"+s[n]+">").join(o[n])}));const r=t.match(/[^{]+(?=\})/g);let d=[];r&&(r.forEach(e=>{if(e.includes("-ncc")&&"active_number-ncc"!==e){let t="";t=e.replace("-ncc",""),d[e]=this._agentContactService.contactSubject.value[t]?this._stripCountryCode(this._agentContactService.contactSubject.value[t]):""}else this._agentContactService.contactSubject.value[e]&&(d[e]=this._agentContactService.contactSubject.value[e])}),r.forEach(e=>{"last_note_text"!==e&&"call_uuid"!==e&&"campaign_id"!==e&&"queue_id"!==e&&"userInfo_user_id"!==e&&"userInfo_full_name"!==e&&"userInfo_first_name"!==e&&"userInfo_last_name"!==e&&"userInfo_email"!==e&&"active_number"!==e&&"active_number-ncc"!==e?t=t.split("{"+e+"}").join(d[e]?d[e]:""):"call_uuid"===e?t=t.split("{call_uuid}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.callUuid?this._webPhoneSessionsService.previousCall.data.callUuid:""):"campaign_id"===e?t=t.split("{campaign_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.campaignId?this._webPhoneSessionsService.previousCall.data.campaignId.toString():""):"queue_id"===e?t=t.split("{queue_id}").join(this._webPhoneSessionsService.previousCall&&this._webPhoneSessionsService.previousCall.data.queueId?this._webPhoneSessionsService.previousCall.data.queueId.toString():""):"userInfo_user_id"===e?t=t.split("{userInfo_user_id}").join(this._authService.currentUser.value?this._authService.currentUser.value.app_user:""):"userInfo_full_name"===e?t=t.split("{userInfo_full_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.full_name:""):"userInfo_first_name"===e?t=t.split("{userInfo_first_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.first_name:""):"userInfo_last_name"===e?t=t.split("{userInfo_last_name}").join(this._authService.currentUser.value?this._authService.currentUser.value.last_name:""):"userInfo_email"===e?t=t.split("{userInfo_email}").join(this._authService.currentUser.value?this._authService.currentUser.value.email:""):"last_note_text"===e?t=t.split("{last_note_text}").join(this.lastNote?this.lastNote:""):"active_number"!==e&&"active_number-ncc"!==e||(t=t.split("active_number"===e?"{active_number}":"{active_number-ncc}").join(this._getActiveNumber()?"active_number"===e?this._getActiveNumber():this._stripCountryCode(this._getActiveNumber()):""))}));let l=`<form id="hiddenForm" \n\t\t\tmethod="${i}"\n\t\t\taction="${t}" \n\t\t\tenctype="${c}"\n\t\t\ttarget="${n.use_popup?"formResult":"_blank"}">`,u="";if("Get"===i&&t.indexOf("?")>0){let e=l.substr(l.indexOf('action="')+8,l.length);if(e=e.substr(0,e.indexOf('"')),e.indexOf("?")>0){let t=e.substr(e.indexOf("?")+1,e.length),n="",i="",c="";t.indexOf("&")>0?t.split("&").forEach(e=>{i=e.substr(0,e.indexOf("=")),c=e.substr(e.indexOf("=")+1,e.length),u+='<input type="hidden" id="'+i+'" name="'+i+'" value="'+this._filterDoubleQuotes(c)+'">'}):(n=t,i=n.substr(0,n.indexOf("=")),c=n.substr(n.indexOf("=")+1,n.length),u+='<input type="hidden" id="'+i+'" name="'+i+'" value="'+this._filterDoubleQuotes(c)+'">')}}return Object.keys(a).forEach(e=>{u=u+'<input type="hidden" id="'+e+'" name="'+e+'" value="'+this._filterDoubleQuotes(a[e])+'"/>'}),l=l+u+"</form>",this._agentContactFieldService.contactFieldNames.forEach((e,t)=>{l=this._fieldSubstitute(l,this._agentContactFieldService.contactFieldNames[t])}),l}_filterDoubleQuotes(e){return e.replace(/"/g,"")}_filterCurlyBrackets(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}_getConnectorUrl(e){let t=e.query_params?e.query_params:"";return"?"===e.url.substr(-1)&&t.startsWith("?")&&(e.url=e.url.substring(0,e.url.length-1)),e.url.includes("?")&&"&"!==e.url.substr(-1)&&(t.startsWith("&")||(t="&"+t)),e.url+t}_replaceAll(e,t,n){return e.replace(new RegExp(this._filterCurlyBrackets(t),"g"),n)}_getActiveNumber(){return this._agentContactService.contactSubject.value&&this._webPhoneSessionsService.previousActiveNumber&&this._agentContactService.contactSubject.value._phone_numbers&&this._agentContactService.contactSubject.value._phone_numbers.length&&this._agentContactService.contactSubject.value._phone_numbers.find(e=>this._stripCountryCode(e.phone_number)===this._stripCountryCode(this._webPhoneSessionsService.previousActiveNumber))?this._webPhoneSessionsService.previousActiveNumber:null}_stripCountryCode(e){return e.replace("+1","")}_fieldSubstitute(e,t){let n="";return this._agentContactService.contactSubject.value&&this._agentContactService.contactSubject.value.hasOwnProperty(t)&&this._agentContactService.contactSubject.value[t]&&(n=this._filterDoubleQuotes(this._agentContactService.contactSubject.value[t].toString())),this._replaceAll(e,"{"+t+"}",n)}}return e.\u0275fac=function(t){return new(t||e)(a.nc(k.a),a.nc(I.a),a.nc(r.a),a.nc(D.a),a.nc(f.a),a.nc(_.a),a.nc(S.a),a.nc(h.a),a.nc(y.a),a.nc(g.a),a.nc(T.a),a.nc(w),a.nc(P.a),a.nc(C.a),a.nc(s.a),a.nc(F))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var O=n("CMHf");let N=(()=>{class e{constructor(e){this.callDispositionService=e,this.contactDispositions=[],this.contactDispositionMap=[]}getContactDispositions(){this.callDispositionService.list("max").subscribe({next:e=>{this.contactDispositions=e.results,e.results.forEach(e=>{this.contactDispositionMap[e.id]=e.name})}})}}return e.\u0275fac=function(t){return new(t||e)(a.nc(O.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var q=n("Z181"),$=n("BGFF"),E=n("yEXm"),A=n("VxG0"),Q=n("SXQ7"),R=n("9wxl"),U=n("roal"),V=n("CZaT"),W=n("tk/3");let z=(()=>{class e{constructor(e){this.http=e}get(){return this.http.get("/api/myfullagentstatus/")}}return e.\u0275fac=function(t){return new(t||e)(a.nc(W.b))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var H=n("SxV6");let L=(()=>{class e{constructor(){}get dailyStats(){return this._dailyStats}set dailyStats(e){this._dailyStats=e}updateDailyStatField(e,t){this._dailyStats?this._dailyStats[e]=t:this._dailyStats={[e]:t}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var X=n("bBQQ"),G=n("U2C9"),Y=n("0IaG"),J=n("ofXK"),Z=n("f1Ku"),K=n("kmnG"),ee=n("d3UM"),te=n("3Pt+"),ne=n("FKr1");const ie=function(e){return{background:e}};function ce(e,t){if(1&e&&a.dc(0,"span",8),2&e){const e=a.uc(2);a.Bc("ngStyle",a.Gc(1,ie,e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status]&&e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status].color?e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status].color:"#c9cfd2"))}}function ae(e,t){if(1&e&&(a.ic(0,"mat-option",9),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.id)("disabled",!e.agent_can_select),a.Pb(1),a.ed(e.name)}}const oe=function(e){return{"border-bottom-color":e}};function se(e,t){if(1&e){const e=a.kc();a.ic(0,"div",1),a.ic(1,"div",2),a.bd(2,ce,1,3,"span",3),a.hc(),a.ic(3,"mat-form-field",4),a.ic(4,"mat-label"),a.dd(5,"Status"),a.hc(),a.ic(6,"mat-select",5),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().statusValue=t}))("ngModelChange",(function(t){return a.Qc(e),a.uc().onDropdownChanged(t)})),a.ic(7,"mat-option",6),a.dd(8,"Select Status"),a.hc(),a.bd(9,ae,2,3,"mat-option",7),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Bc("ngStyle",a.Gc(5,oe,e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status]&&e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status].color?e.agentStatusService.statusMap[e.agentStatusService.agentStatusSubject.value.agent_status].color:"#c9cfd2")),a.Pb(2),a.Bc("ngIf",e.agentStatusService.statusMap.length),a.Pb(4),a.Bc("ngModel",e.statusValue),a.Pb(1),a.Bc("value",null),a.Pb(2),a.Bc("ngForOf",e.agentStatusService.statuses)}}let re=(()=>{class e{constructor(e,t,n,i){this.agentStatusService=e,this._snackBar=t,this._myAgentStatusService=n,this._webPhoneOverlayService=i,this.statusValue=null,this.userId="",this.agentStatusSubscription=this.agentStatusService.agentStatusSubject.subscribe({next:e=>{e&&(this.statusValue=e.agent_status)}})}ngOnDestroy(){this.agentStatusSubscription&&this.agentStatusSubscription.unsubscribe()}onDropdownChanged(e){this._webPhoneOverlayService.showOverlay&&(this._webPhoneOverlayService.showOverlay=!1),this.agentStatusService.getUserId()?this._myAgentStatusService.update(this.agentStatusService.getUserId(),{agent_status:e}).subscribe({next:e=>{this.agentStatusService.agentStatusSubject.next(e)},error:()=>{setTimeout(()=>{this.statusValue=this.agentStatusService.agentStatusSubject.value.agent_status},500),this._snackBar.open("Status update failed please try again","X",{duration:5e3,verticalPosition:"top",panelClass:"error"})}}):console.error("No agent id found")}}return e.\u0275fac=function(t){return new(t||e)(a.bc(p.a),a.bc(k.a),a.bc(Q.a),a.bc(V.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["status-dropdown"]],decls:1,vars:1,consts:[["class","dyn-card dyn-flex dyn-space-between dyn-align-items dyn-m-b-10 dyn-p-r-40 dyn-p-b-0","style","border-bottom:5px solid #f1f1f1;width:250px;",3,"ngStyle",4,"ngIf"],[1,"dyn-card","dyn-flex","dyn-space-between","dyn-align-items","dyn-m-b-10","dyn-p-r-40","dyn-p-b-0",2,"border-bottom","5px solid #f1f1f1","width","250px",3,"ngStyle"],[1,"dyn-text-center","dyn-m-r-10"],["style","width: 8px; height: 8px;display: inline-block; border-radius: 100%;",3,"ngStyle",4,"ngIf"],["appearance","outline",1,"dyn-full-width","status-dropdown-container"],["disableRipple","",1,"dyn-full-width","status-dropdown",3,"ngModel","ngModelChange"],[1,"dyn-menu-option-sm",3,"value"],["class","dyn-menu-option-sm",3,"value","disabled",4,"ngFor","ngForOf"],[2,"width","8px","height","8px","display","inline-block","border-radius","100%",3,"ngStyle"],[1,"dyn-menu-option-sm",3,"value","disabled"]],template:function(e,t){1&e&&a.bd(0,se,10,7,"div",0),2&e&&a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value)},directives:[J.p,J.q,K.b,K.f,ee.a,te.p,te.s,ne.o,J.o],encapsulation:2}),e})();var de=n("xyEW"),le=n("bTqV"),ue=n("Qu3c"),ge=n("NFeN");function he(e,t){if(1&e){const e=a.kc();a.ic(0,"button",8),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneWindowService.changeSelectedWindow("dial-pad")})),a.dd(1,"Back"),a.hc()}}function be(e,t){if(1&e){const e=a.kc();a.ic(0,"button",8),a.qc("click",(function(){return a.Qc(e),a.uc().connectWebphone()})),a.dd(1,"Connect"),a.hc()}}function pe(e,t){if(1&e){const e=a.kc();a.ic(0,"button",8),a.qc("click",(function(){return a.Qc(e),a.uc().disconnectWebphone()})),a.dd(1,"Disconnect"),a.hc()}}let ve=(()=>{class e{constructor(e,t,n){this.webPhoneService=e,this.webPhoneSessionsService=t,this.webPhoneWindowService=n,this.webPhoneCredentials={ws_url:"",sip_uri:"",password:""},this.webPhoneCredentialSubscription=this.webPhoneService.webPhoneCredentials.subscribe({next:e=>{this.webPhoneCredentials.ws_url=e.ws_url,this.webPhoneCredentials.sip_uri=e.sip_uri,this.webPhoneCredentials.password=e.password,this.connectWebphone()}})}ngOnDestroy(){this.webPhoneCredentialSubscription.unsubscribe()}connectWebphone(){this.webPhoneService.connectWebphone(this.webPhoneCredentials)}disconnectWebphone(){this.webPhoneService.disconnectWebphone()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(s.a),a.bc(C.a),a.bc(M.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["web-phone-settings"]],decls:23,vars:9,consts:[["id","dyn-phone-settings-container"],[1,"dyn-label"],[1,"dyn-settings-input",3,"disabled","ngModel","ngModelChange"],[1,"dyn-label","dyn-m-t-15"],[1,"dyn-m-t-10"],[1,"dyn-half-block"],["mat-raised-button","","class","dyn-btn",3,"click",4,"ngIf"],[1,"dyn-half-block","dyn-text-right"],["mat-raised-button","",1,"dyn-btn",3,"click"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div"),a.ic(2,"div"),a.ic(3,"label"),a.ic(4,"span",1),a.dd(5,"Web Socket Server"),a.hc(),a.ic(6,"input",2),a.qc("ngModelChange",(function(e){return t.webPhoneCredentials.ws_url=e})),a.hc(),a.hc(),a.hc(),a.ic(7,"div"),a.ic(8,"label"),a.ic(9,"span",3),a.dd(10,"Uri"),a.hc(),a.ic(11,"input",2),a.qc("ngModelChange",(function(e){return t.webPhoneCredentials.sip_uri=e})),a.hc(),a.hc(),a.hc(),a.ic(12,"div"),a.ic(13,"label"),a.ic(14,"span",3),a.dd(15,"Password"),a.hc(),a.ic(16,"input",2),a.qc("ngModelChange",(function(e){return t.webPhoneCredentials.password=e})),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(17,"div",4),a.ic(18,"div",5),a.bd(19,he,2,0,"button",6),a.hc(),a.ic(20,"div",7),a.bd(21,be,2,0,"button",6),a.bd(22,pe,2,0,"button",6),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(6),a.Bc("disabled",t.webPhoneSessionsService.registered)("ngModel",t.webPhoneCredentials.ws_url),a.Pb(5),a.Bc("disabled",t.webPhoneSessionsService.registered)("ngModel",t.webPhoneCredentials.sip_uri),a.Pb(5),a.Bc("disabled",t.webPhoneSessionsService.registered)("ngModel",t.webPhoneCredentials.password),a.Pb(3),a.Bc("ngIf",t.webPhoneSessionsService.registered),a.Pb(2),a.Bc("ngIf",!t.webPhoneSessionsService.registered),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.registered))},directives:[te.d,te.p,te.s,J.p,le.b],styles:["#dyn-phone-settings-container[_ngcontent-%COMP%]{padding:20px}#dyn-phone-settings-container[_ngcontent-%COMP%]   .dyn-half-block[_ngcontent-%COMP%]{display:inline-block;width:50%}#dyn-phone-settings-container[_ngcontent-%COMP%]   .dyn-label[_ngcontent-%COMP%]{display:block;margin-left:2px;font-size:14px;color:#6e6e6e}#dyn-phone-settings-container[_ngcontent-%COMP%]   .dyn-settings-input[_ngcontent-%COMP%]{display:block;padding:5px;width:100%;box-sizing:border-box}#dyn-phone-settings-container[_ngcontent-%COMP%]   .dyn-settings-input[_ngcontent-%COMP%]:focus{outline:none}"]}),e})();var me=n("qFsG"),fe=n("Xa2L");function Se(e,t){if(1&e){const e=a.kc();a.ic(0,"input",9),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().webPhoneSessionsService.phoneNumberInput=t}))("keydown",(function(t){return a.Qc(e),a.uc().onPhoneNumberInputChange(t)}))("keyup.enter",(function(){a.Qc(e);const t=a.uc();return t.webPhoneSessionsService.call(t.webPhoneSessionsService.phoneNumberInput)})),a.hc()}if(2&e){const e=a.uc();a.Bc("ngModel",e.webPhoneSessionsService.phoneNumberInput)}}function _e(e,t){if(1&e&&(a.ic(0,"div",10),a.dc(1,"input",11),a.hc()),2&e){const e=a.uc();a.Bc("matTooltipDisabled",!e.permissionService.hasPermission("web_phone_dial_pad"))}}function ye(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",14),a.ic(2,"button",15),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).digitClicked(n)})),a.ic(3,"p"),a.dd(4),a.hc(),a.ic(5,"p"),a.dd(6),a.vc(7,"uppercase"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc(2);a.Pb(1),a.Bc("matTooltipDisabled",n.permissionService.hasPermission("web_phone_dial_pad")),a.Pb(1),a.Bc("disabled",!n.permissionService.hasPermission("web_phone_dial_pad")),a.Pb(2),a.ed(e.number),a.Pb(2),a.ed(a.wc(7,4,e.letters))}}const Ce=function(e){return{"dyn-m-t-20":e}};function Pe(e,t){if(1&e&&(a.ic(0,"div",12),a.bd(1,ye,8,6,"div",13),a.hc()),2&e){const e=t.$implicit;a.Bc("ngClass",a.Gc(2,Ce,0==t.index)),a.Pb(1),a.Bc("ngForOf",e)}}function we(e,t){1&e&&a.dc(0,"mat-spinner",23)}function Me(e,t){if(1&e){const e=a.kc();a.ic(0,"div",16),a.ic(1,"div",2),a.ic(2,"button",17),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneSessionsService.redial()})),a.ic(3,"mat-icon"),a.dd(4,"phone_callback"),a.hc(),a.hc(),a.hc(),a.ic(5,"div",18),a.ic(6,"button",19),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.webPhoneSessionsService.call(t.webPhoneSessionsService.phoneNumberInput)})),a.ic(7,"mat-icon"),a.dd(8,"phone"),a.hc(),a.bd(9,we,1,0,"mat-spinner",20),a.hc(),a.hc(),a.ic(10,"div",21),a.ic(11,"button",22),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.webPhoneSessionsService.phoneNumberInput=t.webPhoneSessionsService.phoneNumberInput.slice(0,-1)})),a.ic(12,"mat-icon"),a.dd(13,"backspace"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(2),a.Bc("disabled",e.webPhoneSessionsService.gettingLastCall),a.Pb(4),a.Bc("disabled",e.webPhoneSessionsService.showDialBtnSpinner||e.agentPostCallService.selectedCall.value&&e.agentPostCallService.selectedCall.value.forcePostCall),a.Pb(3),a.Bc("ngIf",e.webPhoneSessionsService.showDialBtnSpinner)}}function xe(e,t){1&e&&(a.ic(0,"div",24),a.dc(1,"mat-progress-spinner",25),a.dd(2," Registering...\n"),a.hc())}let Be=(()=>{class e{constructor(e,t,n,i,c,a){this._snackBar=e,this.webPhoneSessionsService=t,this.webPhoneWindowService=n,this.agentPostCallService=i,this.permissionService=c,this.agentContactService=a,this.dialPadDigits=[[{number:"1",letters:""},{number:"2",letters:"abc"},{number:"3",letters:"def"}],[{number:"4",letters:"ghi"},{number:"5",letters:"jkl"},{number:"6",letters:"mno"}],[{number:"7",letters:"pqrs"},{number:"8",letters:"tuv"},{number:"9",letters:"wxyz"}],[{number:"*",letters:""},{number:"0",letters:""},{number:"#",letters:""}]]}digitClicked(e){if(!this.permissionService.hasPermission("web_phone_dial_pad"))return;const t=this.webPhoneSessionsService.activeSession;if(t){if(0===t._status||1===t._status||2===t._status||5===t._status||8===t._status)return void this._snackBar.open("Call is still in progress","",{duration:3e3,verticalPosition:"top",panelClass:"error"});this.webPhoneSessionsService.sendDTMF(e.number,t)}this.webPhoneSessionsService.playDTMF(e.number),this.webPhoneSessionsService.phoneNumberInput+=e.number}onPhoneNumberInputChange(e){if(-1!==["1","2","3","4","5","6","7","8","9","*","0","#"].indexOf(e.key)){this.webPhoneSessionsService.playDTMF(e.key);const t=this.webPhoneSessionsService.activeSession;t&&0!==t._status&&2!==t._status&&5!==t._status&&this.webPhoneSessionsService.sendDTMF(e.key,t)}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(C.a),a.bc(M.a),a.bc(v.a),a.bc(A.a),a.bc(f.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dial-pad"]],decls:11,vars:7,consts:[["id","dyn-dial-pad-container",1,"dyn-p-20","dyn-p-t-0","dyn-m-t-10",3,"hidden"],[1,"dyn-flex"],[1,"dyn-full-width"],["matInput","","type","text","name","phoneNumber",3,"ngModel","ngModelChange","keydown","keyup.enter",4,"ngIf"],["matTooltip","You must have the 'web_phone_dial_pad' permission to access the web phone input",3,"matTooltipDisabled",4,"ngIf"],["class","dyn-flex dyn-space-between dyn-m-t-10",3,"ngClass",4,"ngFor","ngForOf"],["class","dyn-flex dyn-space-between dyn-align-items dyn-m-t-20",4,"ngIf"],["class","dyn-text-center","style","height: 500px; line-height: 500px;",4,"ngIf"],[3,"hidden"],["matInput","","type","text","name","phoneNumber",3,"ngModel","ngModelChange","keydown","keyup.enter"],["matTooltip","You must have the 'web_phone_dial_pad' permission to access the web phone input",3,"matTooltipDisabled"],["matInput","","type","text","name","phoneNumber","disabled",""],[1,"dyn-flex","dyn-space-between","dyn-m-t-10",3,"ngClass"],[4,"ngFor","ngForOf"],["matTooltip","You must have the 'web_phone_dial_pad' permission to access the dialpad",3,"matTooltipDisabled"],["mat-fab","","color","",1,"dyn-digit",3,"disabled","click"],[1,"dyn-flex","dyn-space-between","dyn-align-items","dyn-m-t-20"],["mat-icon-button","","matTooltip","Redial",1,"dyn-hover",3,"disabled","click"],[1,"dyn-full-width","dyn-text-center"],["mat-fab","",1,"dyn-phone-dial","dyn-no-shadow",2,"height","70px!important","width","70px!important",3,"disabled","click"],["class","grey-spinner","diameter","70","strokeWidth","2","color","#ddd","style","position: absolute;top: 0;bottom: 0;left: 0;right: 0;",4,"ngIf"],[1,"dyn-full-width","dyn-text-right"],["mat-icon-button","",1,"dyn-hover",3,"click"],["diameter","70","strokeWidth","2","color","#ddd",1,"grey-spinner",2,"position","absolute","top","0","bottom","0","left","0","right","0"],[1,"dyn-text-center",2,"height","500px","line-height","500px"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"mat-form-field",2),a.ic(3,"mat-label"),a.dd(4,"Enter a number"),a.hc(),a.bd(5,Se,1,1,"input",3),a.bd(6,_e,2,1,"div",4),a.hc(),a.hc(),a.bd(7,Pe,2,4,"div",5),a.bd(8,Me,14,3,"div",6),a.hc(),a.bd(9,xe,3,0,"div",7),a.dc(10,"web-phone-settings",8)),2&e&&(a.Bc("hidden","dial-pad"!=t.webPhoneWindowService.selectedWindow||!t.webPhoneSessionsService.registered),a.Pb(5),a.Bc("ngIf",t.permissionService.hasPermission("web_phone_dial_pad")),a.Pb(1),a.Bc("ngIf",!t.permissionService.hasPermission("web_phone_dial_pad")),a.Pb(1),a.Bc("ngForOf",t.dialPadDigits),a.Pb(1),a.Bc("ngIf",!t.webPhoneSessionsService.activeSession),a.Pb(1),a.Bc("ngIf",!t.webPhoneSessionsService.registered),a.Pb(1),a.Bc("hidden","phone-settings"!=t.webPhoneWindowService.selectedWindow))},directives:[K.b,K.f,J.p,J.o,ve,me.b,te.d,te.p,te.s,ue.a,J.n,le.b,ge.a,fe.c,fe.a],pipes:[J.z],styles:["#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-from-field[_ngcontent-%COMP%], #dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-to-field[_ngcontent-%COMP%]{width:40px;font-size:.8rem;text-align:right}#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-input[_ngcontent-%COMP%]{font-size:.8rem;width:160px;height:35px;border:1px solid #fff;box-shadow:0 2px 4px 0 rgba(0,0,0,.17);outline:none}#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-digit[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #edf0f5;transition:.3s;background:#fff}#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-digit[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin:-7px 0 0}#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-digit[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{color:#9eafca;font-size:.7rem}#dyn-dial-pad-container[_ngcontent-%COMP%]   .dyn-digit[_ngcontent-%COMP%]:not([disabled]):hover{border-color:#ced4de;background:#f7f8f9}"]}),e})(),ke=(()=>{class e{transform(e){if(!e)return e;let t=(""+e).replace(/\D/g,"").match(/^(1|)?(\d{3})(\d{3})(\d{4})$/);return t?[t[1]?"+1 ":"","(",t[2],") ",t[3],"-",t[4]].join(""):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.ac({name:"phoneNumberFormatter",type:e,pure:!0}),e})();function Fe(e,t){1&e&&(a.ic(0,"div",9),a.dd(1,"No Current Call"),a.hc())}function Ie(e,t){if(1&e&&(a.gc(0),a.ic(1,"span",17),a.dd(2),a.hc(),a.fc()),2&e){const e=a.uc(2);a.Pb(2),a.fd(" Connected to ",e.webPhoneSessionsService.activeSession.data.transferredByAgent.full_name," ")}}function De(e,t){if(1&e&&(a.dd(0),a.vc(1,"phoneNumberFormatter")),2&e){const e=a.uc(2);a.fd(" ",a.wc(1,1,e.webPhoneSessionsService.activeSession.data.phoneNumber)," ")}}function Te(e,t){if(1&e){const e=a.kc();a.ic(0,"div",10),a.ic(1,"p",11),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneWindowService.changeSelectedWindow("current-call")})),a.bd(2,Ie,3,1,"ng-container",12),a.bd(3,De,2,3,"ng-template",null,13,a.cd),a.hc(),a.ic(5,"div",14),a.ic(6,"button",15),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.webPhoneSessionsService.hold(t.webPhoneSessionsService.activeSession)})),a.ic(7,"mat-icon"),a.dd(8,"pause"),a.hc(),a.hc(),a.ic(9,"button",16),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.webPhoneSessionsService.hangUp(t.webPhoneSessionsService.activeSession)})),a.ic(10,"mat-icon"),a.dd(11,"call_end"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.Mc(4),t=a.uc();a.Pb(2),a.Bc("ngIf",t.webPhoneSessionsService.activeSession&&(null==t.webPhoneSessionsService.activeSession.data?null:t.webPhoneSessionsService.activeSession.data.transferredByAgent))("ngIfElse",e)}}function je(e,t){1&e&&(a.ic(0,"div",9),a.dd(1,"No Calls On Hold"),a.hc())}function Oe(e,t){if(1&e){const e=a.kc();a.ic(0,"div",19),a.ic(1,"p",11),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).getContact(n.data)})),a.dd(2),a.vc(3,"phoneNumberFormatter"),a.hc(),a.ic(4,"div",14),a.ic(5,"button",20),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).webPhoneSessionsService.unHold(n)})),a.ic(6,"mat-icon"),a.dd(7,"phone"),a.hc(),a.hc(),a.ic(8,"button",21),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).webPhoneSessionsService.hangUp(n)})),a.ic(9,"mat-icon"),a.dd(10,"call_end"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(2),a.fd(" ",a.wc(3,1,e.data.phoneNumber)," ")}}function Ne(e,t){if(1&e&&(a.gc(0),a.bd(1,Oe,11,3,"div",18),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.webPhoneSessionsService.onHold)}}let qe=(()=>{class e{constructor(e,t,n,i){this.agentNavService=e,this.agentContactService=t,this.webPhoneSessionsService=n,this.webPhoneWindowService=i}getContact(e){e.contactId&&(this.agentContactService.getContact(e.contactId),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact"))}}return e.\u0275fac=function(t){return new(t||e)(a.bc(d.a),a.bc(f.a),a.bc(C.a),a.bc(M.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["active-calls"]],decls:16,vars:5,consts:[["id","dyn-active-calls"],[1,"dyn-badge-btn","dyn-text-sm"],[1,"dyn-m-t-5","dyn-m-b-10"],["class","dyn-text-muted dyn-text-sm",4,"ngIf"],["class","dyn-flex dyn-space-between",4,"ngIf"],[1,"dyn-m-t-20"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[2,"font-size",".8rem","font-weight","600","background","#f1f1f1","border-radius","100px","width","22px","height","22px","text-align","center","line-height","22px"],[4,"ngIf"],[1,"dyn-text-muted","dyn-text-sm"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-contact-number","dyn-clickable",3,"click"],[4,"ngIf","ngIfElse"],["showPhoneNumber",""],[1,"dyn-call-actions"],["mat-mini-fab","",1,"dyn-hold",3,"click"],["mat-mini-fab","",1,"dyn-hang-up","dyn-m-l-5",3,"click"],[1,"dyn-text-xs-sm"],["class","dyn-flex dyn-space-between dyn-m-t-10",4,"ngFor","ngForOf"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10"],["mat-mini-fab","",1,"dyn-answer","dyn-m-r-10",3,"click"],["mat-mini-fab","",1,"dyn-hang-up",3,"click"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div"),a.ic(2,"span",1),a.dd(3,"Current Call"),a.hc(),a.dc(4,"hr",2),a.bd(5,Fe,2,0,"div",3),a.bd(6,Te,12,2,"div",4),a.hc(),a.ic(7,"div",5),a.ic(8,"div",6),a.ic(9,"span",1),a.dd(10,"Calls On Hold"),a.hc(),a.ic(11,"span",7),a.dd(12),a.hc(),a.hc(),a.dc(13,"hr",2),a.bd(14,je,2,0,"div",3),a.bd(15,Ne,2,1,"ng-container",8),a.hc(),a.hc()),2&e&&(a.Pb(5),a.Bc("ngIf",!t.webPhoneSessionsService.activeSession),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.activeSession),a.Pb(6),a.fd(" ",t.webPhoneSessionsService.onHold.length," "),a.Pb(2),a.Bc("ngIf",!t.webPhoneSessionsService.onHold.length),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.onHold.length))},directives:[J.p,le.b,ge.a,J.o],pipes:[ke],styles:["#dyn-active-calls{padding:20px}#dyn-active-calls .dyn-current-call,#dyn-active-calls .dyn-on-hold{font-size:1rem;color:#2979ff;border-bottom:1px solid #ddd}#dyn-active-calls .dyn-contact-name{margin-bottom:5px}#dyn-active-calls .dyn-contact-number{color:#9eafca;font-size:.9rem;margin-top:7px}#dyn-active-calls .dyn-contact-number.dyn-clickable{cursor:pointer}#dyn-active-calls .dyn-contact-number.dyn-clickable:hover{color:#2979ff}#dyn-active-calls .dyn-call-actions .dyn-hold{background:#878787;color:#fff}#dyn-active-calls .dyn-call-actions .dyn-hang-up{background:#f24c4c;color:#fff}#dyn-active-calls .dyn-call-actions .dyn-answer{background:#26c281;color:#fff}#dyn-active-calls .dyn-call-actions .dyn-answer,#dyn-active-calls .dyn-call-actions .dyn-hang-up,#dyn-active-calls .dyn-call-actions .dyn-hold{height:28px;width:28px;line-height:28px;box-shadow:none}#dyn-active-calls .dyn-call-actions .dyn-answer .mat-button-wrapper,#dyn-active-calls .dyn-call-actions .dyn-hang-up .mat-button-wrapper,#dyn-active-calls .dyn-call-actions .dyn-hold .mat-button-wrapper{padding:4px 0}#dyn-active-calls .dyn-call-actions .dyn-answer .mat-button-wrapper .mat-icon,#dyn-active-calls .dyn-call-actions .dyn-hang-up .mat-button-wrapper .mat-icon,#dyn-active-calls .dyn-call-actions .dyn-hold .mat-button-wrapper .mat-icon{font-size:20px}"],encapsulation:2}),e})();var $e=n("LVKg");function Ee(e,t){1&e&&(a.ic(0,"div",4),a.dc(1,"mat-progress-spinner",5),a.hc())}function Ae(e,t){1&e&&(a.ic(0,"div",6),a.dd(1," No Recent Calls "),a.hc())}function Qe(e,t){if(1&e&&(a.ic(0,"div",15),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.fd(" ",e.inbound?e.source:e.destination," ")}}function Re(e,t){if(1&e){const e=a.kc();a.ic(0,"div",16),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc().getContact(t.contact)})),a.dd(1),a.hc()}if(2&e){const e=a.uc().$implicit;a.Pb(1),a.fd(" ",e.inbound?e.source:e.destination," ")}}function Ue(e,t){1&e&&a.dc(0,"hr",17)}function Ve(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",7),a.ic(2,"div"),a.bd(3,Qe,2,1,"div",8),a.bd(4,Re,2,1,"div",9),a.ic(5,"div",10),a.ic(6,"mat-icon",11),a.dd(7),a.hc(),a.dd(8),a.vc(9,"date"),a.hc(),a.hc(),a.ic(10,"button",12),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().webPhoneSessionsService.call(n.inbound?n.source:n.destination)})),a.ic(11,"mat-icon",13),a.dd(12,"phone"),a.hc(),a.hc(),a.hc(),a.bd(13,Ue,1,0,"hr",14),a.fc()}if(2&e){const e=t.$implicit,n=t.last;a.Pb(3),a.Bc("ngIf",!e.contact),a.Pb(1),a.Bc("ngIf",e.contact),a.Pb(2),a.Bc("matTooltip",e.inbound?"Inbound":"Outbound"),a.Pb(1),a.fd(" ",e.inbound?"call_received":"call_made"," "),a.Pb(1),a.fd(" ",a.xc(9,6,e.created_on,"MMM d, y, h:mm a")," "),a.Pb(5),a.Bc("ngIf",!n)}}let We=(()=>{class e{constructor(e,t,n,i,c,a,o,s){this.snackBar=e,this.authService=t,this.utils=n,this.webPhoneWindowService=i,this.agentContactService=c,this.agentNavService=a,this._myRecentCallsService=o,this.webPhoneSessionsService=s,this.recentCalls=[],this.timerCount=0,this.loading=!1}ngOnInit(){this.webPhoneWindowSubscription=this.webPhoneWindowService.selectedWindowSubject.subscribe(e=>{"recent-calls"===e&&this._getRecentCalls()})}ngOnDestroy(){this.webPhoneWindowSubscription.unsubscribe(),this.webPhoneWindowService.changeSelectedWindow("dial-pad")}getContact(e){this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id===e||this.agentContactService.getContact(e),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact")}_getRecentCalls(){this.timerInterval||(this.loading=!0,this._myRecentCallsService.getWebPhoneCallHistory().subscribe({next:e=>{this.recentCalls=e.results,this._startInterval(),this.loading=!1},error:e=>{this.loading=!1,this.snackBar.open(this.utils.handleErrorResponse(e,"Error Getting Recent Calls"),"X",{duration:3e4,verticalPosition:"top",panelClass:["error"]})}}))}_startInterval(){this.timerInterval=setInterval(()=>{this.timerCount++,this.timerCount>=1&&(clearInterval(this.timerInterval),this.timerInterval=null,this.timerCount=0)},1e3)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(r.a),a.bc(D.a),a.bc(M.a),a.bc(f.a),a.bc(d.a),a.bc($e.a),a.bc(C.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["recent-calls"]],decls:4,vars:3,consts:[[1,"dyn-p-20"],["class","dyn-text-center",4,"ngIf"],["class","dyn-text-muted dyn-text-sm dyn-text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"dyn-text-center"],["mode","indeterminate","diameter","20",1,"dyn-inline-block","dyn-m-r-10"],[1,"dyn-text-muted","dyn-text-sm","dyn-text-center"],[1,"dyn-flex","dyn-space-between","dyn-align-items","phone-recent-calls"],["class","recent-call-number",4,"ngIf"],["class","dyn-link dyn-underline",3,"click",4,"ngIf"],[1,"dyn-text-muted","dyn-text-xs-sm"],[1,"dyn-icon-sm","dyn-vertical-middle",3,"matTooltip"],["mat-icon-button","","color","primary","matTooltip","Call Back",3,"click"],[1,"call-back-icon"],["class","dyn-m-t-5 dyn-m-b-5",4,"ngIf"],[1,"recent-call-number"],[1,"dyn-link","dyn-underline",3,"click"],[1,"dyn-m-t-5","dyn-m-b-5"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.bd(1,Ee,2,0,"div",1),a.bd(2,Ae,2,0,"div",2),a.bd(3,Ve,14,9,"ng-container",3),a.hc()),2&e&&(a.Pb(1),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.recentCalls.length&&!t.loading),a.Pb(1),a.Bc("ngForOf",t.recentCalls))},directives:[J.p,J.o,fe.a,ge.a,ue.a,le.b],pipes:[J.f],styles:["#dyn-active-calls[_ngcontent-%COMP%]{padding:20px}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-current-call[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-on-hold[_ngcontent-%COMP%]{font-size:1rem;color:#2979ff;border-bottom:1px solid #ddd}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-contact-name[_ngcontent-%COMP%]{margin-bottom:5px}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-contact-number[_ngcontent-%COMP%]{color:#9eafca;font-size:.9rem;margin-top:7px}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-contact-number.dyn-clickable[_ngcontent-%COMP%]{cursor:pointer}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-contact-number.dyn-clickable[_ngcontent-%COMP%]:hover{color:#2979ff}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hold[_ngcontent-%COMP%]{background:#878787;color:#fff}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%]{background:#f24c4c;color:#fff}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-answer[_ngcontent-%COMP%]{background:#26c281;color:#fff}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-answer[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hold[_ngcontent-%COMP%]{height:28px;width:28px;line-height:28px;box-shadow:none}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-answer[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hold[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]{padding:4px 0}#dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-answer[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], #dyn-active-calls[_ngcontent-%COMP%]   .dyn-call-actions[_ngcontent-%COMP%]   .dyn-hold[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px}"]}),e})();var ze=n("fFgH");function He(e,t){if(1&e&&(a.ic(0,"div",14),a.ic(1,"mat-icon",15),a.dd(2,"person"),a.hc(),a.ic(3,"div"),a.dd(4," Connected With"),a.dc(5,"br"),a.dd(6),a.hc(),a.hc()),2&e){const e=a.uc();a.Pb(6),a.fd(" ",e.webPhoneSessionsService.activeSession.data.transferredByAgent.full_name," ")}}function Le(e,t){if(1&e){const e=a.kc();a.ic(0,"div",16),a.ic(1,"p",17),a.qc("click",(function(){return a.Qc(e),a.uc().onPhoneNumberClick()})),a.dd(2),a.vc(3,"phoneNumberFormatter"),a.hc(),a.ic(4,"span"),a.dd(5),a.vc(6,"phoneNumberFormatter"),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(2),a.fd(" ",a.wc(3,2,e.webPhoneSessionsService.activeSession.data.phoneNumber)," "),a.Pb(3),a.fd(" ",e.webPhoneSessionsService.activeSession.data.sourceNumber?a.wc(6,4,e.webPhoneSessionsService.activeSession.data.sourceNumber):""," ")}}function Xe(e,t){if(1&e&&(a.ic(0,"p",7),a.dd(1),a.hc()),2&e){const e=a.uc();a.Pb(1),a.fd(" ",e.webPhoneSessionsService.activeSession.data.timer.time," ")}}function Ge(e,t){if(1&e){const e=a.kc();a.ic(0,"button",18),a.qc("click",(function(){return a.Qc(e),a.uc().onTransferClick()})),a.ic(1,"mat-icon"),a.dd(2,"swap_horiz"),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Bc("disabled",!(null!=e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.onCall))}}const Ye=function(e){return{"mute-on":e}};let Je=(()=>{class e{constructor(e,t,n,i,c,a){this.webPhoneWindowService=e,this.webPhoneSessionsService=t,this._contactSearchService=n,this._snackBar=i,this._utils=c,this._agentContactService=a}onTransferClick(){var e;if(this.webPhoneSessionsService.activeSession&&(null===(e=this.webPhoneSessionsService.activeSession.data)||void 0===e?void 0:e.callStartTime)){const e=10;if(this._utils.getEpochTimeDifference(this.webPhoneSessionsService.activeSession.data.callStartTime)<e)return void this._snackBar.open(`Cannot transfer call until ${e} seconds have passed`,"X",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}this.webPhoneWindowService.changeSelectedWindow("transfer-type")}onPhoneNumberClick(){var e,t;if(this.webPhoneSessionsService.activeSession&&(null===(e=this.webPhoneSessionsService.activeSession.data)||void 0===e?void 0:e.phoneNumber)){const e=null===(t=this.webPhoneSessionsService.activeSession.data)||void 0===t?void 0:t.phoneNumber;this._contactSearchService.searchByPhoneNumber(1,1,e).subscribe({next:e=>{var t,n;if(e&&e.results.length){const i=e.results[0]?e.results[0].id:null;if((null===(t=this._agentContactService.contactSubject.value)||void 0===t?void 0:t.id)&&(null===(n=this._agentContactService.contactSubject.value)||void 0===n?void 0:n.id)===i)return;this._agentContactService.getContact(i)}}})}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(M.a),a.bc(C.a),a.bc(ze.a),a.bc(k.a),a.bc(D.a),a.bc(f.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["current-call"]],decls:28,vars:10,consts:[["id","dyn-current-call-container"],["class","connected-with-box",4,"ngIf"],[1,"dyn-call-avatar"],["src","/assets/img/agent-dash/call-avatar.svg","width","100px"],["class","dyn-call-details",4,"ngIf"],["class","dyn-text-center",4,"ngIf"],[1,"dyn-call-controls"],[1,"dyn-text-center"],["mat-fab","","class","dyn-transfer dyn-no-shadow",3,"disabled","click",4,"ngIf"],[1,"dyn-text-sm","dyn-text-muted","dyn-m-t-5"],[1,"dyn-flex","dyn-space-between","dyn-p-l-20","dyn-p-r-20"],["mat-fab","",1,"dyn-hold","dyn-no-shadow",3,"disabled","click"],["mat-fab","","color","",1,"dyn-mute",3,"ngClass","click"],["mat-fab","",1,"dyn-hang-up","dyn-no-shadow",3,"click"],[1,"connected-with-box"],[1,"dyn-icon-x-sm"],[1,"dyn-call-details"],[1,"dyn-m-t-10",3,"click"],["mat-fab","",1,"dyn-transfer","dyn-no-shadow",3,"disabled","click"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.bd(1,He,7,1,"div",1),a.ic(2,"div",2),a.dc(3,"img",3),a.hc(),a.bd(4,Le,7,6,"div",4),a.bd(5,Xe,2,1,"p",5),a.ic(6,"div",6),a.ic(7,"div",7),a.bd(8,Ge,3,1,"button",8),a.ic(9,"div",9),a.dd(10,"Transfer"),a.hc(),a.hc(),a.ic(11,"div",10),a.ic(12,"div",7),a.ic(13,"button",11),a.qc("click",(function(){return t.webPhoneSessionsService.hold(t.webPhoneSessionsService.activeSession)})),a.ic(14,"mat-icon"),a.dd(15,"pause"),a.hc(),a.hc(),a.ic(16,"div",9),a.dd(17,"Hold"),a.hc(),a.hc(),a.ic(18,"div",7),a.ic(19,"button",12),a.qc("click",(function(){return t.webPhoneSessionsService.toggleMute(t.webPhoneSessionsService.activeSession)})),a.ic(20,"mat-icon"),a.dd(21),a.hc(),a.hc(),a.ic(22,"div",9),a.dd(23),a.hc(),a.hc(),a.hc(),a.ic(24,"div",7),a.ic(25,"button",13),a.qc("click",(function(){return t.webPhoneSessionsService.hangUp(t.webPhoneSessionsService.activeSession)})),a.ic(26,"mat-icon"),a.dd(27,"call_end"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.activeSession&&(null==t.webPhoneSessionsService.activeSession.data?null:t.webPhoneSessionsService.activeSession.data.transferredByAgent)),a.Pb(3),a.Bc("ngIf",t.webPhoneSessionsService.activeSession),a.Pb(1),a.Bc("ngIf",null==t.webPhoneSessionsService.activeSession?null:t.webPhoneSessionsService.activeSession.data.timer),a.Pb(3),a.Bc("ngIf",t.webPhoneSessionsService.activeSession),a.Pb(5),a.Bc("disabled",!(null!=t.webPhoneSessionsService.activeSession&&t.webPhoneSessionsService.activeSession.data.onCall)),a.Pb(6),a.Bc("ngClass",a.Gc(8,Ye,null==t.webPhoneSessionsService.activeSession?null:t.webPhoneSessionsService.activeSession._audioMuted)),a.Pb(2),a.ed(null!=t.webPhoneSessionsService.activeSession&&t.webPhoneSessionsService.activeSession._audioMuted?"mic_off":"mic_on"),a.Pb(2),a.fd(" ",null!=t.webPhoneSessionsService.activeSession&&t.webPhoneSessionsService.activeSession._audioMuted?"Unmute":"Mute"," "))},directives:[J.p,le.b,ge.a,J.n],pipes:[ke],styles:["#dyn-current-call-container[_ngcontent-%COMP%]{padding:20px}#dyn-current-call-container[_ngcontent-%COMP%]   .connected-with-box[_ngcontent-%COMP%]{position:absolute;left:6px;top:10px;text-align:center;font-size:.7rem;max-width:100px;width:100%;padding:4px;box-sizing:border-box;color:#595959}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-avatar[_ngcontent-%COMP%]{margin-top:10px;text-align:center}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-avatar[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{border-radius:100px;box-shadow:0 0 0 rgba(160,219,255,.3);animation:pulseAnimation 2s infinite}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-details[_ngcontent-%COMP%]{margin-top:10px;text-align:center}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:#2979ff;margin-bottom:0;cursor:pointer}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:hover{text-decoration:underline}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem;color:#9ca7af}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]{padding:20px 0}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:100px;height:56px;min-width:56px}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-transfer[_ngcontent-%COMP%]:not([disabled]){background:#2979ff;color:#fff}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-hold[_ngcontent-%COMP%]:not([disabled]){background:#878787;color:#fff}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-mute[_ngcontent-%COMP%]:not([disabled]){background:#f1f1f1;color:#444;box-shadow:none}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-mute.mute-on[_ngcontent-%COMP%]{background:#ffebeb;color:#d50000;transform:scale(.97);animation:muteGlow 2.5s ease-in-out infinite}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-mute.mute-on[_ngcontent-%COMP%]:hover{background:#ffdada}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-mute.enabled[_ngcontent-%COMP%]{color:#13c200}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%]{height:70px;min-width:70px;background:#f24c4c;color:#fff}#dyn-current-call-container[_ngcontent-%COMP%]   .dyn-call-controls[_ngcontent-%COMP%]   .dyn-hang-up[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;height:38px;width:38px}@keyframes muteGlow{0%{box-shadow:0 0 0 rgba(213,0,0,0)}50%{box-shadow:0 0 6px 1px rgba(213,0,0,.25)}to{box-shadow:0 0 0 rgba(213,0,0,0)}}@keyframes pulseAnimation{0%{box-shadow:0 0 0 0 rgba(160,219,255,.3)}70%{box-shadow:0 0 0 20px rgba(204,169,44,0)}to{box-shadow:0 0 0 0 rgba(204,169,44,0)}}"]}),e})();function Ze(e,t){if(1&e&&(a.ic(0,"p",22),a.dd(1),a.vc(2,"phoneNumberFormatter"),a.hc()),2&e){const e=a.uc();a.Pb(1),a.fd(" ",a.wc(2,1,e.webPhoneSessionsService.incomingSession.data.phoneNumber)," ")}}function Ke(e,t){if(1&e&&(a.ic(0,"span",25),a.dd(1),a.vc(2,"slice"),a.hc()),2&e){const e=a.uc(4);a.Bc("matTooltip",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name),a.Pb(1),a.fd(" ",a.yc(2,2,e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name,0,40)+".."," ")}}function et(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.hc()),2&e){const e=a.uc(4);a.Pb(1),a.fd(" ",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name," ")}}function tt(e,t){if(1&e&&(a.gc(0),a.bd(1,Ke,3,6,"span",24),a.bd(2,et,2,1,"span",16),a.fc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngIf",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name.length>=40),a.Pb(1),a.Bc("ngIf",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name.length<40)}}function nt(e,t){if(1&e&&(a.gc(0),a.bd(1,tt,3,2,"ng-container",16),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].name)}}function it(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",23),a.dd(2," Queue: "),a.bd(3,nt,2,1,"ng-container",16),a.hc(),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Yc("background",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId]?e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].color:"#dddddd")("color",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId]?"#ffffff"===e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId].color?"#000":"#fff":"#000"),a.Pb(2),a.Bc("ngIf",e.agentQueueService.queueMap[e.webPhoneSessionsService.incomingSession.data.queueId])}}function ct(e,t){if(1&e&&(a.gc(0),a.dd(1),a.vc(2,"phoneNumberFormatter"),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.fd(" ",a.wc(2,1,e.webPhoneSessionsService.incomingSession.data.inboundRouteDID)," ")}}function at(e,t){if(1&e&&(a.ic(0,"div",29),a.dd(1),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.fd(" (",e.webPhoneSessionsService.incomingSession.data.inboundRouteName,") ")}}function ot(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",26),a.ic(2,"div",27),a.dd(3," Dialed Number: "),a.bd(4,ct,3,3,"ng-container",16),a.hc(),a.bd(5,at,2,1,"div",28),a.hc(),a.hc()),2&e){const e=a.uc();a.Pb(4),a.Bc("ngIf",e.webPhoneSessionsService.incomingSession&&e.webPhoneSessionsService.incomingSession.data.inboundRouteDID),a.Pb(1),a.Bc("ngIf",e.webPhoneSessionsService.incomingSession&&e.webPhoneSessionsService.incomingSession.data&&e.webPhoneSessionsService.incomingSession.data.inboundRouteName)}}let st=(()=>{class e{constructor(e,t){this.webPhoneSessionsService=e,this.agentQueueService=t}}return e.\u0275fac=function(t){return new(t||e)(a.bc(C.a),a.bc(u.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["incoming-call"]],decls:30,vars:3,consts:[["id","dyn-incoming-call"],[1,"dyn-call-avatar","dyn-text-center"],["width","100px","viewBox","0 0 123 123","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink"],["id","path-1","cx","58.5","cy","58.5","r","58.5"],["id","Page-2","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","user-shape-copy","transform","translate(3.000000, 3.000000)"],["id","mask-2","fill","white"],[0,"xlink","href","#path-1"],["id","Mask","stroke","#FFFFFF","stroke-width","5","fill","#A0DBFF",0,"xlink","href","#path-1"],["id","user-shape","mask","url(#mask-2)","fill","#FFFFFF","fill-rule","nonzero"],["transform","translate(14.000000, 29.000000)","id","Shape"],["d","M45,44 C57.2375,44 67.25,34.1 67.25,22 C67.25,9.9 57.2375,0 45,0 C32.7625,0 22.75,9.9 22.75,22 C22.75,34.1 32.7625,44 45,44 Z M45,55 C29.98125,55 0.5,62.15 0.5,77 L0.5,88 L89.5,88 L89.5,77 C89.5,62.15 60.01875,55 45,55 Z"],[1,"dyn-call-details","dyn-text-center"],[1,"dyn-m-b-0"],["style","font-size: 1rem; margin-top:5px;",4,"ngIf"],[1,"dyn-text-center",2,"padding","0 20px","box-sizing","border-box"],[4,"ngIf"],[1,"dyn-call-controls","dyn-p-20"],[1,"dyn-flex","dyn-space-between","dyn-p-l-20","dyn-p-r-20"],[1,"dyn-text-center"],["mat-fab","","color","warn","matTooltip","Decline",1,"dyn-phone-hangup","dyn-no-shadow",3,"click"],["mat-fab","","matTooltip","Answer",1,"dyn-phone-dial","dyn-no-shadow",3,"click"],[2,"font-size","1rem","margin-top","5px"],[1,"dyn-text-sm","dyn-m-b-10",2,"display","inline-block","padding","7px 10px","border-radius","8px","width","100%","box-sizing","border-box"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],[1,"dyn-text-left",2,"background","#eff3f6","display","inline-block","padding","7px 5px","border-radius","8px","width","100%","box-sizing","border-box"],[1,"dyn-text-center","dyn-m-r-5",2,"font-size",".7rem"],["style","font-size: .7rem;margin-top:0;","class","dyn-text-center",4,"ngIf"],[1,"dyn-text-center",2,"font-size",".7rem","margin-top","0"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.tc(),a.ic(2,"svg",2),a.ic(3,"defs"),a.dc(4,"circle",3),a.hc(),a.ic(5,"g",4),a.ic(6,"g",5),a.ic(7,"mask",6),a.dc(8,"use",7),a.hc(),a.dc(9,"use",8),a.ic(10,"g",9),a.ic(11,"g",10),a.dc(12,"path",11),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.sc(),a.ic(13,"div",12),a.ic(14,"h3",13),a.dd(15,"Incoming Call"),a.hc(),a.bd(16,Ze,3,3,"p",14),a.hc(),a.ic(17,"div",15),a.bd(18,it,4,5,"ng-container",16),a.bd(19,ot,6,2,"div",16),a.hc(),a.ic(20,"div",17),a.ic(21,"div",18),a.ic(22,"div",19),a.ic(23,"button",20),a.qc("click",(function(){return t.webPhoneSessionsService.reject()})),a.ic(24,"mat-icon"),a.dd(25,"call_end"),a.hc(),a.hc(),a.hc(),a.ic(26,"div",19),a.ic(27,"button",21),a.qc("click",(function(){return t.webPhoneSessionsService.answer()})),a.ic(28,"mat-icon"),a.dd(29,"phone"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(16),a.Bc("ngIf",t.webPhoneSessionsService.incomingSession&&t.webPhoneSessionsService.incomingSession.data.phoneNumber),a.Pb(2),a.Bc("ngIf",t.webPhoneSessionsService.incomingSession&&t.webPhoneSessionsService.incomingSession.data&&t.agentQueueService.queueMap&&t.webPhoneSessionsService.incomingSession.data.queueId),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.incomingSession&&t.webPhoneSessionsService.incomingSession.data&&t.webPhoneSessionsService.incomingSession.data.inboundRoute))},directives:[J.p,le.b,ue.a,ge.a],pipes:[ke,J.x],styles:["#dyn-incoming-call[_ngcontent-%COMP%]{min-height:400px}.dyn-call-avatar[_ngcontent-%COMP%]{padding-top:20px;text-align:center}.dyn-call-avatar[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{border-radius:100px;box-shadow:0 0 0 rgba(160,219,255,.3);animation:pulseAnimation 2s infinite}@keyframes pulseAnimation{0%{box-shadow:0 0 0 0 rgba(160,219,255,.3)}70%{box-shadow:0 0 0 20px rgba(204,169,44,0)}to{box-shadow:0 0 0 0 rgba(204,169,44,0)}}"]}),e})();function rt(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"button",4),a.qc("click",(function(){return a.Qc(e),a.uc(2).webPhoneWindowService.changeSelectedWindow("manual-destination")})),a.dd(2,"Keypad Entry"),a.hc(),a.ic(3,"div",5),a.dd(4,"or"),a.hc(),a.hc()}}function dt(e,t){if(1&e&&(a.gc(0),a.bd(1,rt,5,0,"div",3),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.allowManualTransfers)}}let lt=(()=>{class e{constructor(e,t,n,i,c,a,o,s){this.permissionService=e,this.webPhoneWindowService=t,this.webPhoneSessionsService=n,this._agentStatusService=i,this._agentContactService=c,this._agentCampaignService=a,this._agentQueueService=o,this._utils=s,this.allowManualTransfers=!0}ngOnInit(){this.webPhoneWindowSubscription=this.webPhoneWindowService.selectedWindowSubject.subscribe(e=>{if("transfer-type"===e)if(this.webPhoneSessionsService.activeSession&&this.webPhoneSessionsService.activeSession.data.campaignCall){const e=this._agentCampaignService.campaignMap[this.webPhoneSessionsService.activeSession.data.campaignId];this.allowManualTransfers=!(e&&e.restrict_transfers)}else if(this.webPhoneSessionsService.activeSession&&this.webPhoneSessionsService.activeSession.data.queueCall){const e=this._agentQueueService.queueMap[this.webPhoneSessionsService.activeSession.data.queueId];this.allowManualTransfers=!(e&&e.restrict_transfers)}else this.allowManualTransfers=!0})}ngOnDestroy(){this.webPhoneWindowSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(A.a),a.bc(M.a),a.bc(C.a),a.bc(p.a),a.bc(f.a),a.bc(l.a),a.bc(u.a),a.bc(D.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["transfer-type"]],decls:8,vars:1,consts:[[1,"dyn-p-20","select-destination-type-container"],[1,"dyn-text-center"],[1,"dyn-text-center","dyn-m-t-20","dyn-m-b-20"],[4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"dyn-m-t-5","dyn-m-b-5"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.dd(2,"Select a Destination Type"),a.hc(),a.ic(3,"div",2),a.bd(4,dt,2,1,"ng-container",3),a.ic(5,"div"),a.ic(6,"button",4),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("internal-destination")})),a.dd(7,"Predefined Destination"),a.hc(),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(4),a.Bc("ngIf",t.permissionService.hasPermission("web_phone_dial_pad")))},directives:[J.p,le.b],encapsulation:2}),e})();var ut=n("XNiG"),gt=n("Kj3r"),ht=n("/uUt");function bt(e,t){1&e&&(a.ic(0,"div",16),a.dc(1,"mat-progress-spinner",17),a.hc())}function pt(e,t){1&e&&(a.ic(0,"div",18),a.dd(1," No Destinations Found "),a.hc())}function vt(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"li",25),a.ic(2,"label",26),a.ic(3,"input",27),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).selectedDestination=t})),a.hc(),a.dd(4),a.hc(),a.hc(),a.dc(5,"hr",8),a.fc()}if(2&e){const e=t.$implicit,n=a.uc(2);a.Pb(3),a.Bc("value",e.extension)("ngModel",n.selectedDestination),a.Pb(1),a.gd(" ",e.destination," ext: ",e.extension," ")}}function mt(e,t){1&e&&a.dc(0,"mat-progress-spinner",17)}function ft(e,t){if(1&e){const e=a.kc();a.ic(0,"div",19),a.ic(1,"div",20),a.ic(2,"ul",21),a.bd(3,vt,6,4,"ng-container",22),a.hc(),a.ic(4,"div",23),a.ic(5,"button",14),a.qc("click",(function(){return a.Qc(e),a.uc().loadMoreDestinations()})),a.bd(6,mt,1,0,"mat-progress-spinner",24),a.dd(7," Load More "),a.ic(8,"mat-icon"),a.dd(9,"expand_more"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(3),a.Bc("ngForOf",e.destinations),a.Pb(2),a.Bc("disabled",!e.nextUrl),a.Pb(1),a.Bc("ngIf",e.loadingMoreDestinations)}}function St(e,t){1&e&&(a.gc(0),a.dd(1," Transfer "),a.ic(2,"mat-icon"),a.dd(3,"chevron_right"),a.hc(),a.fc())}function _t(e,t){1&e&&(a.gc(0),a.dc(1,"mat-progress-spinner",17),a.dd(2," Initiating Transfer"),a.fc())}let yt=(()=>{class e{constructor(e,t,n,i){this.destinationService=e,this.webPhoneTransferService=t,this.webPhoneWindowService=n,this.webPhoneSessionsService=i,this.loading=!1,this.loadingMoreDestinations=!1,this.destinationSearchInputSubject=new ut.a,this.destinations=[],this.selectedDestination=null,this.transferring=!1}ngOnInit(){this.webPhoneSessionsService.activeSession&&!0===this.webPhoneSessionsService.activeSession.data.campaignCall?this.campaign=this.webPhoneSessionsService.activeSession.data.campaign:this.webPhoneSessionsService.activeSession&&!0===this.webPhoneSessionsService.activeSession.data.queueCall&&(this.queue=this.webPhoneSessionsService.activeSession.data.queue),this.webPhoneWindowSubscription=this.webPhoneWindowService.selectedWindowSubject.subscribe(e=>{"internal-destination"===e?this.destinations.length||this._getDestinations():this.selectedDestination=null})}ngOnDestroy(){this.webPhoneWindowSubscription.unsubscribe()}inputValueChanged(e){this.destinationSearchInputSubject.next(e)}startTransfer(){this.selectedDestination&&(this.webPhoneTransferService.initiateTransfer(),this.webPhoneTransferService.transferInitiated=!0,this.transferring=!0,setTimeout(()=>{this.transferring=!1,this.webPhoneWindowService.changeSelectedWindow("transfer-controls")},5e3),Array.from(String(this.selectedDestination),Number).forEach(e=>{this.webPhoneSessionsService.sendDTMF(e)}))}loadMoreDestinations(){this.loadingMoreDestinations=!0,this.destinationService.getByUrl(""+this.nextUrl).subscribe({next:e=>{e.results.forEach(e=>{e.extension&&this.destinations.push(e)}),this.nextUrl=e.next,this.loadingMoreDestinations=!1}})}_getDestinations(){this.destinationService.list("max",1,!0).subscribe({next:e=>{this.nextUrl=e.next,e.results.forEach(e=>{e.extension&&this.destinations.push(e)})}}),this.destinationSearchInputSubject.pipe(Object(gt.a)(2e3),Object(ht.a)()).subscribe(()=>this._searchDestinations())}_searchDestinations(){this.loadingMoreDestinations=!0,this.destinationService.search(1,this.destinationSearchInput).subscribe({next:e=>{this.loadingMoreDestinations=!1,this.nextUrl=e.next,this.destinations=[],e.results.forEach(e=>{e.extension&&this.destinations.push(e)})}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(y.a),a.bc(F),a.bc(M.a),a.bc(C.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["internal-destination"]],decls:23,vars:8,consts:[[1,"internal-destination-container"],[1,"dyn-p-20","dyn-p-b-0"],[1,"dyn-m-t-0"],[1,"dyn-flex","dyn-align-items"],[1,"dyn-m-b-20"],[1,"dyn-search-bar"],[1,"left",2,"top","13px"],["type","search","placeholder","Search",3,"ngModel","keydown","ngModelChange"],[1,"dyn-m-0"],["class","dyn-text-center",4,"ngIf"],["class","dyn-p-20 dyn-text-center dyn-text-sm",4,"ngIf"],["class","dyn-p-20 dyn-p-t-10 dyn-p-r-0",4,"ngIf"],[1,"dyn-flex","dyn-space-between","dyn-p-20"],["mat-button","","color","",3,"disabled","click"],["mat-button","","color","primary",3,"disabled","click"],[4,"ngIf"],[1,"dyn-text-center"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-p-20","dyn-text-center","dyn-text-sm"],[1,"dyn-p-20","dyn-p-t-10","dyn-p-r-0"],[2,"max-height","350px","overflow","auto"],[2,"padding","0","list-style","none"],[4,"ngFor","ngForOf"],[1,"dyn-text-center","dyn-m-10"],["diameter","20","mode","indeterminate","class","dyn-inline-block dyn-vertical-middle",4,"ngIf"],[2,"padding","5px 0"],[1,"dyn-text-xs-sm"],["type","radio","name","destination",2,"vertical-align","top",3,"value","ngModel","ngModelChange"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"h4",2),a.dd(3,"Select a destination:"),a.hc(),a.ic(4,"div",3),a.ic(5,"div",4),a.ic(6,"div",5),a.ic(7,"div",6),a.ic(8,"mat-icon"),a.dd(9,"search"),a.hc(),a.hc(),a.ic(10,"input",7),a.qc("keydown",(function(e){return e.stopPropagation()}))("ngModelChange",(function(e){return t.destinationSearchInput=e}))("ngModelChange",(function(e){return t.inputValueChanged(e)})),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(11,"hr",8),a.bd(12,bt,2,0,"div",9),a.bd(13,pt,2,0,"div",10),a.bd(14,ft,10,3,"div",11),a.dc(15,"hr",8),a.ic(16,"div",12),a.ic(17,"button",13),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("transfer-type")})),a.ic(18,"mat-icon"),a.dd(19,"arrow_back"),a.hc(),a.hc(),a.ic(20,"button",14),a.qc("click",(function(){return t.startTransfer()})),a.bd(21,St,4,0,"ng-container",15),a.bd(22,_t,3,0,"ng-container",15),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(10),a.Bc("ngModel",t.destinationSearchInput),a.Pb(2),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.destinations.length&&!t.loading),a.Pb(1),a.Bc("ngIf",t.destinations.length&&!t.loading),a.Pb(3),a.Bc("disabled",t.campaign&&t.campaign.restrict_transfers||t.queue&&t.queue.restrict_transfers),a.Pb(3),a.Bc("disabled",t.transferring||!t.selectedDestination),a.Pb(1),a.Bc("ngIf",!t.transferring),a.Pb(1),a.Bc("ngIf",t.transferring))},directives:[ge.a,te.d,te.p,te.s,J.p,le.b,fe.a,J.o,te.v],encapsulation:2}),e})();function Ct(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"button",14),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).digitClicked(n)})),a.ic(2,"p"),a.dd(3),a.hc(),a.ic(4,"p"),a.dd(5),a.vc(6,"uppercase"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(3),a.ed(e.number),a.Pb(2),a.ed(a.wc(6,2,e.letters))}}const Pt=function(e){return{"dyn-m-t-10":e}};function wt(e,t){if(1&e&&(a.ic(0,"div",12),a.bd(1,Ct,7,4,"div",13),a.hc()),2&e){const e=t.$implicit;a.Bc("ngClass",a.Gc(2,Pt,0!==t.index)),a.Pb(1),a.Bc("ngForOf",e)}}function Mt(e,t){1&e&&(a.gc(0),a.dd(1," Transfer "),a.ic(2,"mat-icon"),a.dd(3,"chevron_right"),a.hc(),a.fc())}function xt(e,t){1&e&&(a.gc(0),a.dc(1,"mat-progress-spinner",15),a.dd(2," Initiating Transfer"),a.fc())}let Bt=(()=>{class e{constructor(e,t,n,i,c){this.snackBar=e,this.utils=t,this.webPhoneTransferService=n,this.webPhoneWindowService=i,this.webPhoneSessionsService=c,this.destinationInput="",this.transferring=!1,this.dialPadDigits=[[{number:"1",letters:""},{number:"2",letters:"abc"},{number:"3",letters:"def"}],[{number:"4",letters:"ghi"},{number:"5",letters:"jkl"},{number:"6",letters:"mno"}],[{number:"7",letters:"pqrs"},{number:"8",letters:"tuv"},{number:"9",letters:"wxyz"}],[{number:"*",letters:""},{number:"0",letters:""},{number:"#",letters:""}]]}digitClicked(e){this.destinationInput+=e.number}onStartTransfer(){this.destinationInput=this.utils.sanitizePhoneNumber(this.destinationInput),!this.destinationInput||this.destinationInput.length<3||this.destinationInput.length>12?this.snackBar.open("Please enter a valid number","X",{duration:2500,verticalPosition:"top",panelClass:["error"]}):(this.transferring=!0,this.webPhoneTransferService.transferInitiated=!0,setTimeout(()=>{this.webPhoneWindowService.changeSelectedWindow("transfer-controls"),this.transferring=!1,this.destinationInput=""},5e3),this.webPhoneTransferService.initiateTransfer(),Array.from(String(this.destinationInput),Number).forEach(e=>{this.webPhoneSessionsService.sendDTMF(e)}))}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(D.a),a.bc(F),a.bc(M.a),a.bc(C.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["manual-destination"]],decls:22,vars:5,consts:[[1,"dyn-p-20","transfer-manual-destination-container"],[1,"dyn-m-t-0"],[2,"width","200px","margin","auto"],["appearance","outline",1,"dyn-full-width"],["matInput","","type","text","name","phoneNumber",3,"ngModel","ngModelChange","keyup.enter"],["class","dyn-flex dyn-space-between",3,"ngClass",4,"ngFor","ngForOf"],[1,"dyn-m-t-10"],["mat-button","",1,"dyn-full-width","backspace-btn",3,"click"],[1,"dyn-flex","dyn-space-between"],["mat-button","","color","",3,"click"],["mat-button","","color","primary",3,"disabled","click"],[4,"ngIf"],[1,"dyn-flex","dyn-space-between",3,"ngClass"],[4,"ngFor","ngForOf"],["mat-fab","","color","",1,"dyn-digit",3,"click"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"h4",1),a.dd(2,"Enter a destination:"),a.hc(),a.ic(3,"div",2),a.ic(4,"mat-form-field",3),a.ic(5,"mat-label"),a.dd(6,"Destination Number"),a.hc(),a.ic(7,"input",4),a.qc("ngModelChange",(function(e){return t.destinationInput=e}))("keyup.enter",(function(){return t.onStartTransfer()})),a.hc(),a.hc(),a.bd(8,wt,2,4,"div",5),a.ic(9,"div",6),a.ic(10,"button",7),a.qc("click",(function(){return t.destinationInput=t.destinationInput.slice(0,-1)})),a.ic(11,"mat-icon"),a.dd(12,"keyboard_return"),a.hc(),a.dd(13," Backspace "),a.hc(),a.hc(),a.hc(),a.dc(14,"hr"),a.ic(15,"div",8),a.ic(16,"button",9),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("transfer-type")})),a.ic(17,"mat-icon"),a.dd(18,"arrow_back"),a.hc(),a.hc(),a.ic(19,"button",10),a.qc("click",(function(){return t.onStartTransfer()})),a.bd(20,Mt,4,0,"ng-container",11),a.bd(21,xt,3,0,"ng-container",11),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(7),a.Bc("ngModel",t.destinationInput),a.Pb(1),a.Bc("ngForOf",t.dialPadDigits),a.Pb(11),a.Bc("disabled",t.transferring),a.Pb(1),a.Bc("ngIf",!t.transferring),a.Pb(1),a.Bc("ngIf",t.transferring))},directives:[K.b,K.f,me.b,te.d,te.p,te.s,J.o,le.b,ge.a,J.p,J.n,fe.a],pipes:[J.z],styles:["button.active[_ngcontent-%COMP%]{background:#f1f1f1}.dyn-digit[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #edf0f5}.dyn-digit[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin:-7px 0 0}.dyn-digit[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{color:#9eafca;font-size:.7rem}.dyn-phone-backspace[_ngcontent-%COMP%], .dyn-phone-settings[_ngcontent-%COMP%]{box-shadow:none;background:#edf0f2}.dyn-phone-backspace[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .dyn-phone-settings[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#6b6b6b}"]}),e})();function kt(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",3),a.ic(2,"button",6),a.qc("click",(function(){return a.Qc(e),a.uc().hangUpTransferCall()})),a.dd(3,"Hang Up Transfer Call"),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc();a.Pb(2),a.Bc("disabled",e.hangingUpTransferCall)}}function Ft(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",3),a.ic(2,"button",7),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.onButtonClicked("*3"),t.webPhoneTransferService.threeWayCallInitiated=!0})),a.dd(3,"3 Way"),a.hc(),a.hc(),a.ic(4,"div",3),a.ic(5,"button",7),a.qc("click",(function(){return a.Qc(e),a.uc().onButtonClicked("*4")})),a.dd(6,"Swap"),a.hc(),a.hc(),a.ic(7,"div",3),a.ic(8,"button",8),a.qc("click",(function(){return a.Qc(e),a.uc().onButtonClicked("*1")})),a.ic(9,"mat-icon"),a.dd(10,"close"),a.hc(),a.dd(11," Abort Transfer "),a.hc(),a.hc(),a.fc()}}let It=(()=>{class e{constructor(e,t,n,i,c){this._snackBar=e,this._livePhoneCallService=t,this._webPhoneWindowService=n,this.webPhoneSessionsService=i,this.webPhoneTransferService=c,this.hangingUpTransferCall=!1,this.webPhoneWindowSubscription=this._webPhoneWindowService.selectedWindowSubject.subscribe(e=>{"transfer-type"===e&&(this.webPhoneTransferService.threeWayCallInitiated=!1)})}ngOnDestroy(){this.webPhoneWindowSubscription.unsubscribe()}hangUpTransferCall(){this.webPhoneSessionsService.activeSession?this._livePhoneCallService.hangUpTransfer(this.webPhoneSessionsService.activeSession.data.callUuid).subscribe({next:()=>{this._webPhoneWindowService.changeSelectedWindow("current-call"),this.webPhoneTransferService.transferInitiated=!1,this.webPhoneTransferService.threeWayCallInitiated=!1},error:()=>{this._snackBar.open("We\u2019re sorry but there was an unexpected error while trying to hang up the transfer call. Support team has been notified.","X",{duration:7e3,verticalPosition:"top",panelClass:"error"})}}):this._snackBar.open("Error: No Session Found","X",{duration:5e3,verticalPosition:"top",panelClass:"error"})}onButtonClicked(e){const t=this.webPhoneSessionsService.activeSession;if(!t||0!==t._status&&1!==t._status&&2!==t._status&&5!==t._status&&8!==t._status){if("*2"===e&&this.webPhoneTransferService.threeWayCallInitiated)return this.webPhoneSessionsService.hangUp(this.webPhoneSessionsService.activeSession),void this._webPhoneWindowService.changeSelectedWindow("dial-pad");this.webPhoneSessionsService.sendDTMF(e),"*1"===e?(this._snackBar.open("Transfer Aborted","X",{duration:2500,verticalPosition:"top",panelClass:"success"}),this._webPhoneWindowService.changeSelectedWindow("dial-pad"),this.webPhoneTransferService.transferInitiated=!1,this.webPhoneTransferService.threeWayCallInitiated=!1):"*2"===e&&(this.webPhoneSessionsService.hangUp(this.webPhoneSessionsService.activeSession),this._snackBar.open("Transfer Completed","X",{duration:2500,verticalPosition:"top",panelClass:"success"}),this._webPhoneWindowService.changeSelectedWindow("dial-pad")),this.webPhoneTransferService.callPendingTransfer.next(null)}else this._snackBar.open("Call is still in progress","",{duration:3e3,verticalPosition:"top",panelClass:"error"})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(B.a),a.bc(M.a),a.bc(C.a),a.bc(F))},e.\u0275cmp=a.Vb({type:e,selectors:[["transfer-controls"]],decls:9,vars:2,consts:[[1,"dyn-p-20","transfer-controls-container"],[1,"dyn-text-center","transfer-control-label"],[1,"dyn-full-width"],[1,"dyn-m-t-10"],["mat-raised-button","","color","primary",1,"dyn-full-width",3,"click"],[4,"ngIf"],["mat-raised-button","","color","primary",1,"dyn-full-width",3,"disabled","click"],["mat-raised-button","","color","primary",1,"dyn-full-width","dyn-m-t-10",3,"click"],["mat-stroked-button","","color","",1,"dyn-full-width","dyn-m-t-10",3,"click"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.dd(2,"Transfer Controls"),a.hc(),a.ic(3,"div",2),a.ic(4,"div",3),a.ic(5,"button",4),a.qc("click",(function(){return t.onButtonClicked("*2")})),a.dd(6,"Complete Transfer"),a.hc(),a.hc(),a.bd(7,kt,4,1,"ng-container",5),a.bd(8,Ft,12,0,"ng-container",5),a.hc(),a.hc()),2&e&&(a.Pb(7),a.Bc("ngIf",t.webPhoneTransferService.threeWayCallInitiated),a.Pb(1),a.Bc("ngIf",!t.webPhoneTransferService.threeWayCallInitiated))},directives:[le.b,J.p,ge.a],encapsulation:2}),e})(),Dt=(()=>{class e{constructor(e){this.webPhoneWindowService=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(a.bc(M.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["transfers"]],decls:4,vars:4,consts:[[3,"hidden"]],template:function(e,t){1&e&&(a.dc(0,"transfer-type",0),a.dc(1,"internal-destination",0),a.dc(2,"manual-destination",0),a.dc(3,"transfer-controls",0)),2&e&&(a.Bc("hidden","transfer-type"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","internal-destination"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","manual-destination"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","transfer-controls"!==t.webPhoneWindowService.selectedWindow))},directives:[lt,yt,Bt,It],encapsulation:2}),e})();function Tt(e,t){if(1&e){const e=a.kc();a.ic(0,"div",12),a.ic(1,"div",13),a.ic(2,"div",14),a.dd(3),a.ic(4,"mat-icon",15),a.dd(5,"help"),a.hc(),a.hc(),a.ic(6,"div",16),a.ic(7,"button",17),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneOverlayService.setReady()})),a.dd(8),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(3),a.fd(" ",e.webPhoneOverlayService.overlayTitle," "),a.Pb(5),a.fd(" ",e.webPhoneOverlayService.buttonText," ")}}function jt(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",18),a.ic(2,"div",19),a.dc(3,"img",20),a.hc(),a.ic(4,"span",21),a.dd(5," Hot Lead"),a.dc(6,"br"),a.dd(7," Bucket "),a.hc(),a.hc(),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Tb("dialing-panel","current-call"===e.webPhoneWindowService.selectedWindow),a.Bc("matTooltip","Bucket: "+(null==e.agentHotLeadService.isHotLead.value?null:e.agentHotLeadService.isHotLead.value._hot_lead_bucket_name))}}function Ot(e,t){if(1&e){const e=a.kc();a.ic(0,"div",22),a.ic(1,"button",23),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneWindowService.changeSelectedWindow("transfer-controls")})),a.dd(2,"Transfer Controls"),a.hc(),a.hc()}}function Nt(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",24),a.qc("click",(function(){return a.Qc(e),a.uc().webPhoneWindowService.changeSelectedWindow("current-call")})),a.ic(2,"mat-icon",25),a.dd(3,"keyboard_backspace"),a.hc(),a.hc(),a.fc()}}function qt(e,t){if(1&e&&(a.ic(0,"span",26),a.dd(1),a.hc()),2&e){const e=a.uc();a.Pb(1),a.ed(e.webPhoneSessionsService.onHold.length)}}const $t=function(e){return{"dyn-opacity-30":e}};let Et=(()=>{class e{constructor(e,t,n,i,c,a,o){this.webPhoneTransferService=e,this.webPhoneSessionsService=t,this.webPhoneWindowService=n,this.agentCampaignService=i,this.agentStatusService=c,this.agentHotLeadService=a,this.webPhoneOverlayService=o}}return e.\u0275fac=function(t){return new(t||e)(a.bc(F),a.bc(C.a),a.bc(M.a),a.bc(l.a),a.bc(p.a),a.bc(de.a),a.bc(V.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["phone"]],decls:25,vars:23,consts:[["id","dyn-web-phone",1,"dyn-m-b-20","dyn-p-t-20","dyn-relative"],["class","phone-alert-overlay",4,"ngIf"],[4,"ngIf"],["class","dyn-text-right dyn-m-t-10 dyn-p-b-10 dyn-p-r-20",4,"ngIf"],[1,"dyn-flex","dyn-space-between","dyn-p-r-20","dyn-p-l-20"],[1,"dyn-text-sm"],["mat-icon-button","","color","","matTooltip","Dialpad","disableRipple","",1,"dyn-no-shadow",3,"disabled","click"],["color","accent",1,"dyn-vertical-middle",3,"ngClass"],["mat-icon-button","","color","","matTooltip","Active Calls","disableRipple","",1,"dyn-no-shadow","dyn-relative",3,"disabled","click"],["class","dyn-circle-icon",4,"ngIf"],["mat-icon-button","","color","","matTooltip","Recent Calls","disableRipple","",1,"dyn-no-shadow",3,"disabled","click"],[3,"hidden"],[1,"phone-alert-overlay"],[1,"content"],[1,"title"],["matTooltip","Your web phone can disconnect due to network or browser situations.",1,"dyn-button-help-icon","dyn-text-white"],[1,"button-container"],["mat-raised-button","","color","primary",3,"click"],[1,"hot-lead-notification",3,"matTooltip"],[1,"hot-lead-notification-svg"],["alt","Fire Icon","src","/assets/img/fire-icon.svg"],[1,"hot-lead-notification-text",2,"font-size","9px","text-align","center","display","inline-block","line-height","10px"],[1,"dyn-text-right","dyn-m-t-10","dyn-p-b-10","dyn-p-r-20"],[1,"transfer-controls-btn",3,"click"],["mat-icon-button","","matTooltip","Current Call",1,"current-call-btn",3,"click"],["color","primary"],[1,"dyn-circle-icon"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.bd(1,Tt,9,2,"div",1),a.bd(2,jt,8,3,"ng-container",2),a.bd(3,Ot,3,0,"div",3),a.ic(4,"div",4),a.ic(5,"div",5),a.bd(6,Nt,4,0,"ng-container",2),a.hc(),a.ic(7,"div"),a.ic(8,"button",6),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("dial-pad")})),a.ic(9,"mat-icon",7),a.dd(10,"dialpad"),a.hc(),a.hc(),a.ic(11,"button",8),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("active-calls")})),a.bd(12,qt,2,1,"span",9),a.ic(13,"mat-icon",7),a.dd(14,"list"),a.hc(),a.hc(),a.ic(15,"button",10),a.qc("click",(function(){return t.webPhoneWindowService.changeSelectedWindow("recent-calls")})),a.ic(16,"mat-icon",7),a.dd(17,"update"),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(18,"dial-pad",11),a.dc(19,"active-calls",11),a.dc(20,"recent-calls",11),a.dc(21,"current-call",11),a.dc(22,"incoming-call",11),a.dc(23,"web-phone-settings",11),a.dc(24,"transfers"),a.hc()),2&e&&(a.Pb(1),a.Bc("ngIf",t.webPhoneOverlayService.showOverlay),a.Pb(1),a.Bc("ngIf",null==t.agentHotLeadService.isHotLead?null:t.agentHotLeadService.isHotLead.value),a.Pb(1),a.Bc("ngIf",t.webPhoneTransferService.transferInitiated&&t.webPhoneSessionsService.activeSession&&"transfer-controls"!==t.webPhoneWindowService.selectedWindow&&"transfer-type"!==t.webPhoneWindowService.selectedWindow&&"internal-destination"!==t.webPhoneWindowService.selectedWindow&&"manual-destination"!==t.webPhoneWindowService.selectedWindow),a.Pb(3),a.Bc("ngIf",t.webPhoneSessionsService.activeSession&&"current-call"!==t.webPhoneWindowService.selectedWindow&&"incoming-call"!==t.webPhoneWindowService.selectedWindow),a.Pb(2),a.Bc("disabled","dial-pad"===t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("ngClass",a.Gc(17,$t,"dial-pad"!==t.webPhoneWindowService.selectedWindow)),a.Pb(2),a.Bc("disabled","active-calls"===t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.onHold.length),a.Pb(1),a.Bc("ngClass",a.Gc(19,$t,"active-calls"!==t.webPhoneWindowService.selectedWindow)),a.Pb(2),a.Bc("disabled","recent-calls"===t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("ngClass",a.Gc(21,$t,"recent-calls"!==t.webPhoneWindowService.selectedWindow)),a.Pb(2),a.Bc("hidden","dial-pad"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","active-calls"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","recent-calls"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","current-call"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","incoming-call"!==t.webPhoneWindowService.selectedWindow),a.Pb(1),a.Bc("hidden","phone-settings"!==t.webPhoneWindowService.selectedWindow))},directives:[J.p,le.b,ue.a,ge.a,J.n,Be,qe,We,Je,st,ve,Dt],styles:['#dyn-web-phone[_ngcontent-%COMP%], #speed-dial-options[_ngcontent-%COMP%]{width:250px}#dyn-web-phone[_ngcontent-%COMP%]{background:#fff}#dyn-web-phone[_ngcontent-%COMP%]   #dyn-phone-tab-group[_ngcontent-%COMP%]{height:calc(100% - 10px)}#dyn-web-phone[_ngcontent-%COMP%]   .current-call-btn[_ngcontent-%COMP%]{position:relative}#dyn-web-phone[_ngcontent-%COMP%]   .current-call-btn[_ngcontent-%COMP%]:after{content:"1";background:red;color:#fff;border-radius:100px;width:15px;height:15px;display:inline-block;text-align:center;line-height:15px;position:absolute;right:0;top:0;font-size:.8rem}#speed-dial-options[_ngcontent-%COMP%]{background:#fff;box-shadow:-2px 2px 11px 0 rgba(0,0,0,.1)}.phone-nav-button[disabled][_ngcontent-%COMP%]{background:#f1f1f1}.transfer-controls-btn[_ngcontent-%COMP%]{position:relative;cursor:pointer;border-radius:100px;background:#2d67ff;border:1px solid #2d67ff;color:#fff;padding:2px 10px;font-size:.8rem}.transfer-controls-btn[_ngcontent-%COMP%]:hover{background:#2458ff}.transfer-controls-btn[_ngcontent-%COMP%]:focus{outline:none}.transfer-controls-btn[_ngcontent-%COMP%]:after{content:"1";background:red;color:#fff;border-radius:100px;width:15px;height:15px;display:inline-block;text-align:center;line-height:15px;position:absolute;right:-5px;top:-7px;font-size:.8rem}.dyn-circle-icon[_ngcontent-%COMP%]{background:red;color:#fff;border-radius:100px;width:15px;height:15px;display:inline-block;text-align:center;line-height:15px;position:absolute;right:0;top:0;font-size:.8rem}.hot-lead-notification[_ngcontent-%COMP%]{left:15px;top:13px;position:absolute;text-align:center;cursor:pointer}.hot-lead-notification-text[_ngcontent-%COMP%]{font-size:9px;text-align:center;display:inline-block;line-height:10px;margin-top:5px}.hot-lead-notification.dialing-panel[_ngcontent-%COMP%]{left:auto;top:70px;right:25px}.hot-lead-notification-svg[_ngcontent-%COMP%]{border-radius:100px;animation:pulse 2s infinite;background:#ffdada;box-sizing:border-box;width:40px;height:40px;overflow:hidden;line-height:54px}.phone-alert-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:9999;display:flex;justify-content:center;align-items:center}.phone-alert-overlay[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{text-align:center}.phone-alert-overlay[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#fff;margin-bottom:20px;font-size:1rem}@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,0,0,.7)}70%{box-shadow:0 0 20px 20px rgba(255,0,0,0)}to{box-shadow:0 0 0 0 rgba(255,0,0,0)}}']}),e})(),At=(()=>{class e{constructor(e){this.http=e}create(e){return this.http.post("/api/agentcalldisposition/",e)}}return e.\u0275fac=function(t){return new(t||e)(a.nc(W.b))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Qt(e,t){if(1&e){const e=a.kc();a.ic(0,"button",8),a.qc("click",(function(){return a.Qc(e),a.uc(2).onClose()})),a.ic(1,"mat-icon"),a.dd(2,"close"),a.hc(),a.hc()}}const Rt=function(e){return{"dyn-m-r-5":e}};function Ut(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",9),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).onDispositionClick(n)})),a.dd(2),a.hc(),a.fc()}if(2&e){const e=t.$implicit,n=t.last,i=a.uc(2);a.Pb(1),a.Yc("background",e&&e.button_color?e.button_color:"#2979ff")("color",e&&e.text_color?e.text_color:"#fff"),a.Bc("disabled",i.loading)("ngClass",a.Gc(7,Rt,!n)),a.Pb(1),a.ed(e.name)}}function Vt(e,t){if(1&e&&(a.ic(0,"div",1),a.ic(1,"div",2),a.ic(2,"h4",3),a.dd(3),a.vc(4,"phoneNumberFormatter"),a.ic(5,"mat-icon",4),a.dd(6,"info_outline"),a.hc(),a.hc(),a.bd(7,Qt,3,0,"button",5),a.hc(),a.ic(8,"div",6),a.bd(9,Ut,3,9,"ng-container",7),a.hc(),a.hc()),2&e){const e=a.uc();a.Bc("@slideInOut",void 0),a.Pb(3),a.fd(" Select a Disposition ",e.agentPostCallService.selectedCall.value.sessionData?"for "+a.wc(4,4,e.agentPostCallService.selectedCall.value.sessionData.phoneNumber):""," "),a.Pb(4),a.Bc("ngIf",e.agentPostCallService.selectedCall.value&&!e.agentPostCallService.selectedCall.value.forcePostCall),a.Pb(2),a.Bc("ngForOf",e.agentCallDispositionService.callDispositions)}}let Wt=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l){this.agentCallDispositionService=e,this.agentPostCallService=t,this._webPhoneSessionsService=n,this._agentReportingStatService=i,this._agentContactService=c,this._agentStatusService=a,this._snackBar=o,this._utils=s,this._agentCallDispositionAPIService=r,this._agentHotLeadService=d,this._agentDailyStatService=l,this.loading=!1}ngOnInit(){this.contactSubscription=this._agentContactService.contactSubject.subscribe({next:e=>{e&&(this.contactClone=JSON.parse(JSON.stringify(e)))}})}ngOnDestroy(){this.contactSubscription.unsubscribe()}onClose(){var e;this.agentPostCallService.selectedCall.value&&((null===(e=this._webPhoneSessionsService)||void 0===e?void 0:e.activeSession)||this._agentStatusService.updateAgentStatus({agent_status:this.agentPostCallService.selectedCall.value.sessionData.readyStatusId})),this._removeCall()}onDispositionClick(e){if(this.loading=!0,e.hang_up_call){this._hangUp();const e=this.agentPostCallService.selectedCall.value.sessionData.readyStatusId?JSON.parse(JSON.stringify(this.agentPostCallService.selectedCall.value.sessionData.readyStatusId)):null;setTimeout(()=>{e&&this._agentStatusService.updateAgentStatus({agent_status:e})},1e3)}this._createHistoricalCallDisposition(e),this._contactHasBeenModified()&&this._saveContact()}_hangUp(){this._webPhoneSessionsService.activeSession&&this._webPhoneSessionsService.hangUp(this._webPhoneSessionsService.activeSession)}_saveContact(){const e=this._agentReportingStatService.getReportingStats();this._agentContactService.saveContact(e,!0)}_contactHasBeenModified(){return JSON.stringify(this._agentContactService.contactSubject.value)!==JSON.stringify(this.contactClone)}_createHistoricalCallDisposition(e){const t=this.agentPostCallService.selectedCall.value,n={phone_number:t.sessionData.phoneNumber&&"anonymous"!==t.sessionData.phoneNumber&&"Restricted"!==t.sessionData.phoneNumber?t.sessionData.phoneNumber:null,disposition:e.id,call_uuid:t.sessionData.callUuid?t.sessionData.callUuid:void 0,inbound_route:t.sessionData.inboundRoute?t.sessionData.inboundRoute:void 0,contact:t.sessionData.contactId?t.sessionData.contactId:void 0,campaign:t.sessionData.campaignId?t.sessionData.campaignId:void 0,queue:t.sessionData.queueId?t.sessionData.queueId:void 0,live_filter:t.sessionData.liveFilter?t.sessionData.liveFilter:void 0,bucket:t.sessionData.bucketId?t.sessionData.bucketId:void 0};!t.sessionData.contactId&&this._agentContactService.contactSubject.value&&this._agentContactService.contactSubject.value._phone_numbers.find(e=>this._normalizePhoneNumber(e.phone_number)===this._normalizePhoneNumber(n.phone_number))&&(n.contact=this._agentContactService.contactSubject.value.id),this._agentCallDispositionAPIService.create(n).subscribe({next:()=>{this._removeCall(),n.contact&&this._agentHotLeadService.removeHotLead(n.contact),this._agentDailyStatService.updateDailyStatField("last_call_disposition_id",e.id),this._snackBar.open("Call Dispositioned Successfully","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]}),this.loading=!1},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Submitting Disposition"),"X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}),this.loading=!1}})}_normalizePhoneNumber(e){let t=e.replace(/[^\d+]/g,"");return t.startsWith("+")?t:t.startsWith("1")?"+"+t:"+1"+t}_removeCall(){if(this.agentPostCallService.postCallWrapUpCalls.length&&this.agentPostCallService.selectedCall.value){const e=this.agentPostCallService.postCallWrapUpCalls.findIndex(e=>e.sessionData.callUuid===this.agentPostCallService.selectedCall.value.sessionData.callUuid);-1!==e&&this.agentPostCallService.postCallWrapUpCalls.splice(e,1)}this.agentPostCallService.selectedCall.next(null)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(b.a),a.bc(v.a),a.bc(C.a),a.bc(w),a.bc(f.a),a.bc(p.a),a.bc(k.a),a.bc(D.a),a.bc(At),a.bc(de.a),a.bc(L))},e.\u0275cmp=a.Vb({type:e,selectors:[["call-disposition-quick-selection"]],decls:1,vars:1,consts:[["class","dyn-card dyn-p-20 dyn-m-b-20 dyn-relative disposition-quick-select",4,"ngIf"],[1,"dyn-card","dyn-p-20","dyn-m-b-20","dyn-relative","disposition-quick-select"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-m-0"],["matTooltip","Selecting a disposition will end & disposition your call,\n                      save the contact, and set your status back to ready",1,"dyn-icon-sm","dyn-vertical-middle","dyn-opacity-30"],["mat-icon-button","","style","position: absolute; top: 5px; right: 5px;",3,"click",4,"ngIf"],[1,"dyn-m-t-10","dyn-m-b-0"],[4,"ngFor","ngForOf"],["mat-icon-button","",2,"position","absolute","top","5px","right","5px",3,"click"],["mat-raised-button","","color","primary",1,"dyn-m-t-5",3,"disabled","ngClass","click"]],template:function(e,t){1&e&&a.bd(0,Vt,10,6,"div",0),2&e&&a.Bc("ngIf",t.agentPostCallService.selectedCall.value)},directives:[J.p,ge.a,ue.a,J.o,le.b,J.n],pipes:[ke],encapsulation:2,data:{animation:[Object(o.o)("slideInOut",[Object(o.n)(":enter",[Object(o.m)({height:0,opacity:0,overflow:"hidden"}),Object(o.e)("300ms ease-out",Object(o.m)({height:"*",opacity:1,overflow:"hidden"}))]),Object(o.n)(":leave",[Object(o.m)({height:"*",opacity:1,overflow:"hidden"}),Object(o.e)("300ms ease-in",Object(o.m)({height:0,opacity:0,overflow:"hidden"}))])])]}}),e})();var zt=n("beuU"),Ht=n("2Hlz"),Lt=n("EPCh");function Xt(e,t){if(1&e&&(a.ic(0,"option",5),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.label)}}function Gt(e,t){if(1&e&&(a.gc(0),a.bd(1,Xt,2,2,"option",13),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf","Phone Number"===e.data_type)}}let Yt=(()=>{class e{constructor(e,t,n,i,c,a,o,s){var r;this._dialog=e,this._snackBar=t,this._phoneNumberService=n,this._fb=i,this._utils=c,this._agentContactService=a,this.agentContactFieldService=o,this.dialogRef=s,this.loading=!1,this.phoneNumberForm=this._fb.group({contact:null===(r=this._agentContactService.contactSubject.value)||void 0===r?void 0:r.id,contact_field:null,phone_number:["",te.z.required]})}createPhoneNumber(){this.phoneNumberForm.invalid||(this.phoneNumberForm.get("contact").value?(this.loading=!0,this._phoneNumberService.create(this.phoneNumberForm.value).subscribe({next:e=>{this.dialogRef.close(e)},error:e=>{this.loading=!1,e.error.phone_number?this._snackBar.open(e.error.phone_number,"X",{duration:2500,verticalPosition:"top",panelClass:["error"]}):(this._snackBar.open(this._utils.handleErrorResponse(e,"Error creating phone number"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]}),this.dialogRef.close())}})):this._snackBar.open("Please save this contact before adding a phone number","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]}))}}return e.\u0275fac=function(t){return new(t||e)(a.bc(Y.b),a.bc(k.a),a.bc(Lt.a),a.bc(te.f),a.bc(D.a),a.bc(f.a),a.bc(h.a),a.bc(Y.g))},e.\u0275cmp=a.Vb({type:e,selectors:[["ng-component"]],decls:22,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"dyn-m-t-10"],["for","contact_field"],["id","contact_field","formControlName","contact_field",1,"dyn-full-width"],[3,"ngValue"],[4,"ngFor","ngForOf"],["for","phone_number"],["id","phone_number","type","text","formControlName","phone_number",1,"dyn-full-width"],[1,"dyn-text-muted","dyn-italic","dyn-m-5","dyn-text-sm"],[1,"dyn-m-t-10","dyn-flex","dyn-space-between"],["mat-stroked-button","","color","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"ngValue",4,"ngIf"]],template:function(e,t){1&e&&(a.ic(0,"h1",0),a.dd(1,"Create Phone Number"),a.hc(),a.ic(2,"form",1),a.ic(3,"div",2),a.ic(4,"label",3),a.dd(5,"Phone Number Field:"),a.hc(),a.dc(6,"br"),a.ic(7,"select",4),a.dc(8,"option",5),a.bd(9,Gt,2,1,"ng-container",6),a.hc(),a.hc(),a.ic(10,"div",2),a.ic(11,"label",7),a.dd(12,"Phone Number:"),a.hc(),a.dc(13,"br"),a.dc(14,"input",8),a.ic(15,"p",9),a.dd(16,"Ex. +155512345555"),a.hc(),a.hc(),a.ic(17,"div",10),a.ic(18,"button",11),a.dd(19,"Cancel"),a.hc(),a.ic(20,"button",12),a.qc("click",(function(){return t.createPhoneNumber()})),a.dd(21,"Save"),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(2),a.Bc("formGroup",t.phoneNumberForm),a.Pb(6),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactFieldService.contactFieldSubject.value),a.Pb(11),a.Bc("disabled",t.phoneNumberForm.invalid||t.loading))},directives:[Y.h,te.B,te.q,te.i,te.y,te.p,te.h,te.t,te.A,J.o,te.d,le.b,Y.d,J.p],encapsulation:2}),e})();function Jt(e,t){if(1&e&&(a.ic(0,"option",5),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.label)}}function Zt(e,t){if(1&e&&(a.gc(0),a.bd(1,Jt,2,2,"option",13),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf","Email Address"===e.data_type)}}let Kt=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d){var l;this.dialogRef=e,this.route=t,this.router=n,this.dialog=i,this.utils=c,this.snackBar=a,this.emailAddressService=o,this.agentContactService=s,this.agentContactFieldService=r,this.fb=d,this.emailAddressForm=this.fb.group({contact:null===(l=this.agentContactService.contactSubject.value)||void 0===l?void 0:l.id,contact_field:null,email:["",te.z.required]})}createEmailAddress(){this.emailAddressForm.invalid||(this.emailAddressForm.get("contact").value?this.emailAddressService.create(this.emailAddressForm.value).subscribe({next:e=>{this.dialogRef.close(e)},error:e=>{e.error.email?this.snackBar.open(e.error.email,"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]}):(this.snackBar.open(this.utils.handleErrorResponse(e,"Error creating email address"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]}),this.dialogRef.close())}}):this.snackBar.open("Please save this contact before adding an email address","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]}))}}return e.\u0275fac=function(t){return new(t||e)(a.bc(Y.g),a.bc(c.a),a.bc(c.g),a.bc(Y.b),a.bc(D.a),a.bc(k.a),a.bc(Ht.a),a.bc(f.a),a.bc(h.a),a.bc(te.f))},e.\u0275cmp=a.Vb({type:e,selectors:[["ng-component"]],decls:22,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"dyn-m-t-10"],["for","contact_field"],["id","contact_field","formControlName","contact_field",1,"dyn-full-width"],[3,"ngValue"],[4,"ngFor","ngForOf"],["for","email"],["id","email","type","text","formControlName","email",1,"dyn-full-width"],[1,"dyn-text-muted","dyn-italic","dyn-m-5","dyn-text-sm"],[1,"dyn-m-t-10","dyn-flex","dyn-space-between"],["mat-stroked-button","","color","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"ngValue",4,"ngIf"]],template:function(e,t){1&e&&(a.ic(0,"h1",0),a.dd(1,"Create Email Address"),a.hc(),a.ic(2,"form",1),a.ic(3,"div",2),a.ic(4,"label",3),a.dd(5,"Email Address Field:"),a.hc(),a.dc(6,"br"),a.ic(7,"select",4),a.dc(8,"option",5),a.bd(9,Zt,2,1,"ng-container",6),a.hc(),a.hc(),a.ic(10,"div",2),a.ic(11,"label",7),a.dd(12,"Email:"),a.hc(),a.dc(13,"br"),a.dc(14,"input",8),a.ic(15,"p",9),a.dd(16,"Ex. example@email.com"),a.hc(),a.hc(),a.ic(17,"div",10),a.ic(18,"button",11),a.dd(19,"Cancel"),a.hc(),a.ic(20,"button",12),a.qc("click",(function(){return t.createEmailAddress()})),a.dd(21,"Save"),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(2),a.Bc("formGroup",t.emailAddressForm),a.Pb(6),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactFieldService.contactFieldSubject.value),a.Pb(11),a.Bc("disabled",t.emailAddressForm.invalid))},directives:[Y.h,te.B,te.q,te.i,te.y,te.p,te.h,te.t,te.A,J.o,te.d,le.b,Y.d,J.p],encapsulation:2}),e})();var en=n("Q0oM"),tn=n("/qv3"),nn=n("F8RE"),cn=n("STbY"),an=n("kmUR"),on=n("z17N"),sn=n("/1cH"),rn=n("1jcm");function dn(e,t){1&e&&a.dc(0,"hr",5)}function ln(e,t){if(1&e&&(a.gc(0),a.ic(1,"h1",8),a.dd(2),a.hc(),a.dc(3,"hr",9),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Yc("color",null==e?null:e.section_label_color),a.Pb(1),a.fd(" ",e.section," ")}}function un(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc(4);a.Pb(1),a.fd(" ",null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].label," ")}}function gn(e,t){if(1&e&&(a.gc(0),a.dd(1),a.vc(2,"slice"),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc(4);a.Pb(1),a.fd(" ",a.yc(2,1,null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].label,0,25)+".."," ")}}function hn(e,t){1&e&&(a.ic(0,"span"),a.dd(1,"*"),a.hc())}function bn(e,t){1&e&&(a.gc(0),a.dc(1,"input",12),a.fc())}function pn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",13),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])("readOnly",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)}}function vn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",14),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])("readOnly",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)}}function mn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",15),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.hc(),a.dc(2,"owl-date-time",16,17),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc(4);a.Pb(1),a.Bc("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",n.agentContactService.contactSubject.value[null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].name])("readOnly",(null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].read_only)||t.read_only)("disabled",(null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].read_only)||t.read_only),a.Pb(1),a.Bc("disabled",t.read_only)}}function fn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",15),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.hc(),a.dc(2,"owl-date-time",18,19),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc(4);a.Pb(1),a.Bc("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",n.agentContactService.contactSubject.value[null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].name])("readOnly",(null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].read_only)||t.read_only)("disabled",(null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].read_only)||t.read_only),a.Pb(1),a.Bc("disabled",t.read_only)("pickerType","calendar")}}function Sn(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.internal_value),a.Pb(1),a.ed(e.external_value)}}function _n(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",20),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.dc(2,"option",21),a.bd(3,Sn,2,2,"option",22),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].choices)}}function yn(e,t){if(1&e&&(a.ic(0,"span",27),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit,t=a.uc(4);a.Pb(1),a.gd(" (+",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name].length-1," ",2===(null==t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]?null:t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name].length)?"other":"others",") ")}}function Cn(e,t){if(1&e&&(a.ic(0,"mat-option",28),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.internal_value),a.Pb(1),a.fd(" ",e.external_value," ")}}function Pn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-form-field",23),a.ic(2,"mat-select",24),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.ic(3,"mat-select-trigger"),a.dd(4),a.bd(5,yn,2,2,"span",25),a.hc(),a.bd(6,Cn,2,2,"mat-option",26),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(2),a.Bc("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]),a.Pb(2),a.fd(" ",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]?t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name][0]:""," "),a.Pb(1),a.Bc("ngIf",(null==t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]?null:t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name].length)>1),a.Pb(1),a.Bc("ngForOf",null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].choices)}}function wn(e,t){if(1&e&&(a.ic(0,"mat-option",33),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.abbr),a.Pb(1),a.gd(" ",e.state," - ",e.abbr," ")}}function Mn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-form-field",23),a.ic(2,"input",29),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc(3).$implicit,n=a.uc(4);return n.agentContactFieldService.filterStates(n.agentContactService.contactSubject.value[null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].name])})),a.hc(),a.ic(3,"mat-autocomplete",30,31),a.bd(5,wn,2,3,"mat-option",32),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.Mc(4),t=a.uc(3).$implicit,n=a.uc(4);a.Pb(2),a.Bc("disabled",(null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].read_only)||t.read_only)("ngModel",n.agentContactService.contactSubject.value[null==n.agentContactFieldService.contactFieldMap[t.field_id]?null:n.agentContactFieldService.contactFieldMap[t.field_id].name])("matAutocomplete",e),a.Pb(3),a.Bc("ngForOf",n.agentContactFieldService.filteredStates)}}function xn(e,t){if(1&e&&(a.ic(0,"option",28),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e),a.Pb(1),a.ed(e)}}function Bn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",34),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.dc(2,"option",21),a.bd(3,xn,2,2,"option",26),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.timeZoneList)}}function kn(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function Fn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",34),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.dc(2,"option",21),a.bd(3,kn,3,4,"option",22),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactDispositionService.contactDispositions)}}function In(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function Dn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",34),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.dc(2,"option",21),a.bd(3,In,3,4,"option",22),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions)}}function Tn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-slide-toggle",35),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit,i=a.uc(4);return i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[n.field_id]?null:i.agentContactFieldService.contactFieldMap[n.field_id].name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("disabled",(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].read_only)||e.read_only)("ngModel",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name])}}function jn(e,t){if(1&e&&(a.gc(0),a.bd(1,pn,2,3,"ng-container",0),a.bd(2,vn,2,3,"ng-container",0),a.bd(3,mn,4,6,"ng-container",0),a.bd(4,fn,4,7,"ng-container",0),a.bd(5,_n,4,4,"ng-container",0),a.bd(6,Pn,7,5,"ng-container",0),a.bd(7,Mn,6,4,"ng-container",0),a.bd(8,Bn,4,4,"ng-container",0),a.bd(9,Fn,4,4,"ng-container",0),a.bd(10,Dn,4,4,"ng-container",0),a.bd(11,Tn,2,2,"ng-container",0),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngIf",("Text"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)||"Formula"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type))&&"state"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)&&"time_zone"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)&&"disposition_id"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)&&"call_disposition_id"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf",("Integer"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)||"Decimal"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type))&&"call_disposition_id"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)&&"disposition_id"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","Date Time"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)),a.Pb(1),a.Bc("ngIf","Date"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)),a.Pb(1),a.Bc("ngIf","Picklist"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)),a.Pb(1),a.Bc("ngIf","Picklist Multiselect"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)),a.Pb(1),a.Bc("ngIf","state"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","time_zone"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","disposition_id"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","call_disposition_id"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","Checkbox"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type))}}function On(e,t){if(1&e&&(a.ic(0,"div"),a.dc(1,"input",36),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("value",t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]?t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]:"N/A")}}function Nn(e,t){if(1&e&&(a.ic(0,"div"),a.dc(1,"input",36),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("value",t.agentUserService.usersMap[t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]]?t.agentUserService.usersMap[t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name]].full_name:"N/A")}}function qn(e,t){if(1&e&&(a.ic(0,"div"),a.dc(1,"input",36),a.vc(2,"date"),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("value",a.xc(2,1,t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name],"MM/d/y"))}}function $n(e,t){if(1&e&&(a.ic(0,"div"),a.dc(1,"input",36),a.vc(2,"date"),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(4);a.Pb(1),a.Bc("value",a.xc(2,1,t.agentContactService.contactSubject.value[null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name],"MM/d/y, h:mm a"))}}function En(e,t){if(1&e&&(a.gc(0),a.bd(1,On,2,1,"div",0),a.bd(2,Nn,2,1,"div",0),a.bd(3,qn,3,4,"div",0),a.bd(4,$n,3,4,"div",0),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngIf","Date Time"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)&&"Date"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)&&"modified_by"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)&&"created_by"!==(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","modified_by"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)||"created_by"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].name)),a.Pb(1),a.Bc("ngIf","Date"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type)),a.Pb(1),a.Bc("ngIf","Date Time"===(null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].data_type))}}function An(e,t){if(1&e&&(a.gc(0),a.bd(1,jn,12,11,"ng-container",0),a.bd(2,En,5,4,"ng-container",0),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc(4);a.Pb(1),a.Bc("ngIf",!(null!=t.agentContactFieldService.contactFieldMap[e.field_id]&&t.agentContactFieldService.contactFieldMap[e.field_id].system_read_only)),a.Pb(1),a.Bc("ngIf",null==t.agentContactFieldService.contactFieldMap[e.field_id]?null:t.agentContactFieldService.contactFieldMap[e.field_id].system_read_only)}}const Qn=function(e){return{"dyn-error-input":e}};function Rn(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",10),a.ic(2,"label",11),a.bd(3,un,2,1,"ng-container",0),a.bd(4,gn,3,5,"ng-container",0),a.bd(5,hn,2,0,"span",0),a.hc(),a.dc(6,"br"),a.bd(7,bn,2,0,"ng-container",0),a.bd(8,An,3,2,"ng-container",0),a.hc(),a.fc()),2&e){const e=t.$implicit,n=t.last,i=a.uc(4);a.Pb(1),a.Yc("color",null==e?null:e.label_color_color)("background-color",null==e?null:e.background_color)("width",e.width?e.width:170,"px")("max-width",e.width?e.width+20:190,"px"),a.Tb("dyn-m-r-5",!n),a.Bc("ngClass",a.Gc(19,Qn,i.agentContactService.requiredFieldError&&(null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].required)&&!("Picklist"===(null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].data_type)&&""===i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].name])&&(i.agentContactService.contactSubject.value?!i.agentContactService.contactSubject.value[null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].name]:null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].value))),a.Pb(1),a.Bc("matTooltip",null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].label)("matTooltipDisabled",(null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].label.length)<=25),a.Qb("style","font-size:"+(e.label_font_size||12).toString().replace("px","")+"px; color:"+(e.label_color||""),a.Sc),a.Pb(1),a.Bc("ngIf",(null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].label.length)<=25||e.width),a.Pb(1),a.Bc("ngIf",(null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].label.length)>25&&!e.width),a.Pb(1),a.Bc("ngIf",null==i.agentContactFieldService.contactFieldMap[e.field_id]?null:i.agentContactFieldService.contactFieldMap[e.field_id].required),a.Pb(2),a.Bc("ngIf",!i.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",i.agentContactService.contactSubject.value)}}function Un(e,t){if(1&e&&(a.ic(0,"div",6),a.bd(1,ln,4,3,"ng-container",0),a.ic(2,"div",7),a.bd(3,Rn,9,21,"ng-container",2),a.hc(),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(2);a.Yc("padding",e.section_background_color&&"white"!==e.section_background_color&&"rgba(255, 255, 255, 1)"!==e.section_background_color?10:"","px")("box-sizing",e.section_background_color&&"white"!==e.section_background_color&&"rgba(255, 255, 255, 1)"!==e.section_background_color?"border-box":"")("background-color",e.section_background_color?t.agentDarkModeService.darkModeEnabled&&"white"===e.section_background_color?"#272b32":e.section_background_color:t.agentDarkModeService.darkModeEnabled?"#272b32":"white"),a.Tb("using-custom-color",(null==e?null:e.section_background_color)&&"white"!==(null==e?null:e.section_background_color)||t.agentDarkModeService.darkModeEnabled&&"white"!==e.section_background_color),a.Pb(1),a.Bc("ngIf",e.show_section_name),a.Pb(2),a.Bc("ngForOf",e.fields)}}function Vn(e,t){if(1&e&&(a.gc(0),a.bd(1,dn,1,0,"hr",3),a.bd(2,Un,4,10,"div",4),a.fc()),2&e){const e=t.$implicit,n=t.first,i=t.last;a.Pb(1),a.Bc("ngIf",!n&&!i),a.Pb(1),a.Bc("ngIf","hidden_fields"!==e.section)}}function Wn(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",1),a.bd(2,Vn,3,2,"ng-container",2),a.hc(),a.fc()),2&e){const e=a.uc();a.Pb(2),a.Bc("ngForOf",e.agentDashboardSettingsService.data)}}let zn=(()=>{class e{constructor(e,t,n,i,c,a,o){this.agentDarkModeService=e,this.agentContactDispositionService=t,this.agentCallDispositionService=n,this.agentContactFieldService=i,this.agentUserService=c,this.agentContactService=a,this.agentDashboardSettingsService=o,this.timeZoneList=an.a}}return e.\u0275fac=function(t){return new(t||e)(a.bc(X.a),a.bc(N),a.bc(b.a),a.bc(h.a),a.bc(g.a),a.bc(f.a),a.bc(nn.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["custom-contact-form"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"contact-field-container"],[4,"ngFor","ngForOf"],["class","dyn-m-t-10 dyn-m-b-10",4,"ngIf"],["class","custom-contact-field-section-container",3,"using-custom-color","padding","box-sizing","background-color",4,"ngIf"],[1,"dyn-m-t-10","dyn-m-b-10"],[1,"custom-contact-field-section-container"],[1,"dyn-flex","fields-test",2,"flex-wrap","wrap"],[1,"dyn-m-b-0","dyn-m-t-20",2,"margin-top","10px","font-size","1.4rem"],[1,"dyn-m-t-0","dyn-m-b-5"],[1,"item","dyn-m-b-5",2,"padding","7px","box-sizing","border-box","flex-grow","1","border-radius","5px",3,"ngClass"],[3,"matTooltip","matTooltipDisabled"],["type","text","disabled","",1,"dyn-full-width"],["type","text",1,"dyn-full-width",3,"ngModel","readOnly","disabled","ngModelChange"],["type","number","min","0",1,"dyn-full-width",3,"ngModel","readOnly","disabled","ngModelChange"],["type","text",1,"dyn-full-width",3,"owlDateTime","owlDateTimeTrigger","ngModel","readOnly","disabled","ngModelChange"],["hour12Timer","true",3,"disabled"],["dt1",""],["hour12Timer","true",3,"disabled","pickerType"],["dt2",""],[1,"dyn-full-width",3,"disabled","ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["appearance","outline",1,"dyn-full-width","dyn-search-select"],["id","system_disposition","multiple","","disableRipple","",1,"dyn-full-width",3,"disabled","ngModel","ngModelChange"],["class","dyn-opacity-50",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"dyn-opacity-50"],[3,"value"],["type","text","matInput","",1,"dyn-full-width",2,"padding-top","5px!important","box-sizing","border-box",3,"disabled","ngModel","matAutocomplete","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],["style","height: 30px!important;line-height: 30px!important",3,"value",4,"ngFor","ngForOf"],[2,"height","30px!important","line-height","30px!important",3,"value"],[1,"dyn-full-width",3,"ngModel","disabled","ngModelChange"],[3,"disabled","ngModel","ngModelChange"],["disabled","",1,"dyn-full-width",3,"value"]],template:function(e,t){1&e&&a.bd(0,Wn,3,1,"ng-container",0),2&e&&a.Bc("ngIf",t.agentDashboardSettingsService.data)},directives:[J.p,J.o,J.n,ue.a,te.d,te.p,te.s,te.u,on.b,on.d,on.a,te.y,te.t,te.A,K.b,ee.a,ee.c,ne.o,me.b,sn.c,sn.a,rn.a],pipes:[J.x,J.y,J.f],styles:[".contact-field-container{overflow:auto;max-height:calc(100vh - 260px);padding-top:10px;box-sizing:border-box}"],encapsulation:2}),e})();function Hn(e,t){1&e&&(a.ic(0,"span"),a.dd(1,"*"),a.hc())}function Ln(e,t){1&e&&(a.gc(0),a.dc(1,"input",5),a.fc())}function Xn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",6),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.dc(2,"owl-date-time",7,8),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc();a.Pb(1),a.Bc("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",n.agentContactService.contactSubject.value[t.name])("readOnly",t.read_only)("disabled",t.read_only)("required",t.required),a.Pb(1),a.Bc("disabled",t.read_only)}}function Gn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",6),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.dc(2,"owl-date-time",9,10),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc();a.Pb(1),a.Bc("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",n.agentContactService.contactSubject.value[t.name])("readOnly",t.read_only)("disabled",t.read_only)("required",t.required),a.Pb(1),a.Bc("disabled",t.read_only)("pickerType","calendar")}}function Yn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("readOnly",e.read_only)("disabled",e.read_only)("required",e.required)}}function Jn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",12),a.ic(2,"mat-slide-toggle",13),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(2),a.Bc("disabled",e.read_only)("ngModel",t.agentContactService.contactSubject.value[e.name])("checked",!!e.value&&e.value)}}function Zn(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",14),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("readOnly",e.read_only)("disabled",e.read_only)("required",e.required)}}function Kn(e,t){if(1&e&&(a.ic(0,"mat-option",20),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.abbr),a.Pb(1),a.gd(" ",e.state," - ",e.abbr," ")}}function ei(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-form-field",15),a.ic(2,"input",16),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc(3).$implicit,n=a.uc();return n.agentContactFieldService.filterStates(n.agentContactService.contactSubject.value[t.name])})),a.hc(),a.ic(3,"mat-autocomplete",17,18),a.bd(5,Kn,2,3,"mat-option",19),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.Mc(4),t=a.uc(3).$implicit,n=a.uc();a.Pb(2),a.Bc("disabled",t.read_only)("ngModel",n.agentContactService.contactSubject.value[t.name])("matAutocomplete",e),a.Pb(3),a.Bc("ngForOf",n.agentContactFieldService.filteredStates)}}function ti(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",14),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("readOnly",e.read_only)("disabled",e.read_only)("required",e.required)}}function ni(e,t){if(1&e&&(a.ic(0,"option",22),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.internal_value),a.Pb(1),a.ed(e.external_value)}}function ii(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",21),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",22),a.bd(3,ni,2,2,"option",23),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",e.choices)}}function ci(e,t){if(1&e&&(a.ic(0,"span",27),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit,t=a.uc();a.Pb(1),a.gd(" (+",t.agentContactService.contactSubject.value[e.name].length-1," ",2===(null==t.agentContactService.contactSubject.value[e.name]?null:t.agentContactService.contactSubject.value[e.name].length)?"other":"others",") ")}}function ai(e,t){if(1&e&&(a.ic(0,"mat-option",28),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.internal_value),a.Pb(1),a.fd(" ",e.external_value," ")}}function oi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-form-field",15),a.ic(2,"mat-select",24),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.ic(3,"mat-select-trigger"),a.dd(4),a.bd(5,ci,2,2,"span",25),a.hc(),a.bd(6,ai,2,2,"mat-option",26),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(2),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name]),a.Pb(2),a.fd(" ",t.agentContactService.contactSubject.value[e.name]?t.agentContactService.contactSubject.value[e.name][0]:""," "),a.Pb(1),a.Bc("ngIf",(null==t.agentContactService.contactSubject.value[e.name]?null:t.agentContactService.contactSubject.value[e.name].length)>1),a.Pb(1),a.Bc("ngForOf",e.choices)}}function si(e,t){if(1&e&&(a.ic(0,"option"),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e)}}function ri(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",21),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",22),a.bd(3,si,2,1,"option",1),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.timeZoneList)}}function di(e,t){if(1&e&&(a.ic(0,"option",22),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function li(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",21),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",22),a.bd(3,di,3,4,"option",23),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactDispositionService.contactDispositions)}}function ui(e,t){if(1&e&&(a.ic(0,"option",22),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function gi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",21),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc().agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",22),a.bd(3,ui,3,4,"option",23),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions)}}function hi(e,t){if(1&e&&(a.gc(0),a.bd(1,Xn,4,7,"ng-container",2),a.bd(2,Gn,4,8,"ng-container",2),a.bd(3,Yn,2,4,"ng-container",2),a.bd(4,Jn,3,3,"ng-container",2),a.bd(5,Zn,2,4,"ng-container",2),a.bd(6,ei,6,4,"ng-container",2),a.bd(7,ti,2,4,"ng-container",2),a.bd(8,ii,4,4,"ng-container",2),a.bd(9,oi,7,4,"ng-container",2),a.bd(10,ri,4,4,"ng-container",2),a.bd(11,li,4,4,"ng-container",2),a.bd(12,gi,4,4,"ng-container",2),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type),a.Pb(1),a.Bc("ngIf","Date"===e.data_type),a.Pb(1),a.Bc("ngIf",("Integer"===e.data_type||"Decimal"===e.data_type)&&"call_disposition_id"!==e.name&&"disposition_id"!==e.name),a.Pb(1),a.Bc("ngIf","Checkbox"===e.data_type),a.Pb(1),a.Bc("ngIf","Text"===e.data_type&&"state"!==e.name&&"time_zone"!==e.name&&"disposition_id"!==e.name&&"call_disposition_id"!==e.name),a.Pb(1),a.Bc("ngIf","state"===e.name),a.Pb(1),a.Bc("ngIf","Formula"===e.data_type),a.Pb(1),a.Bc("ngIf","Picklist"===e.data_type),a.Pb(1),a.Bc("ngIf","Picklist Multiselect"===e.data_type),a.Pb(1),a.Bc("ngIf","Text"===e.data_type&&"time_zone"===e.name),a.Pb(1),a.Bc("ngIf","disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","call_disposition_id"===e.name)}}const bi=function(e){return{"dyn-error-input":e}};function pi(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",3),a.ic(2,"label",4),a.dd(3),a.vc(4,"slice"),a.bd(5,Hn,2,0,"span",2),a.hc(),a.dc(6,"br"),a.bd(7,Ln,2,0,"ng-container",2),a.bd(8,hi,13,12,"ng-container",2),a.hc(),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc();a.Pb(1),a.Bc("ngClass",a.Gc(11,bi,t.agentContactService.requiredFieldError&&e.required&&!("Picklist"===e.data_type&&""===t.agentContactService.contactSubject.value[e.name])&&(t.agentContactService.contactSubject.value?!t.agentContactService.contactSubject.value[e.name]:e.value))),a.Pb(1),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<22),a.Pb(1),a.fd(" ",e.label.length>22?a.yc(4,7,e.label,0,22)+"..":e.label," "),a.Pb(2),a.Bc("ngIf",e.required),a.Pb(2),a.Bc("ngIf",!t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value)}}function vi(e,t){if(1&e&&(a.gc(0),a.bd(1,pi,9,13,"ng-container",2),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",!e.is_meta&&e.show_on_dash&&"Phone Number"!==e.data_type&&"Email Address"!==e.data_type)}}let mi=(()=>{class e{constructor(e,t,n,i){this.agentContactFieldService=e,this.agentContactDispositionService=t,this.agentCallDispositionService=n,this.agentContactService=i,this.timeZoneList=an.a}}return e.\u0275fac=function(t){return new(t||e)(a.bc(h.a),a.bc(N),a.bc(b.a),a.bc(f.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["default-contact-form"]],decls:2,vars:1,consts:[[1,"dash-grid-container"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"dash-grid-element",3,"ngClass"],[2,"font-size",".7rem",3,"matTooltip","matTooltipDisabled"],["type","text","disabled",""],["type","text",3,"owlDateTime","owlDateTimeTrigger","ngModel","readOnly","disabled","required","ngModelChange"],["hour12Timer","true",3,"disabled"],["dt1",""],["hour12Timer","true",3,"disabled","pickerType"],["dt2",""],["type","number","min","0",3,"ngModel","readOnly","disabled","required","ngModelChange"],[2,"height","28px"],["color","primary",1,"example-margin",3,"disabled","ngModel","checked","ngModelChange"],["type","text",3,"ngModel","readOnly","disabled","required","ngModelChange"],["appearance","outline",1,"dyn-full-width","dyn-search-select"],["type","text","matInput","",1,"dyn-full-width",2,"padding-top","5px!important","box-sizing","border-box",3,"disabled","ngModel","matAutocomplete","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],["style","height: 30px!important;line-height: 30px!important",3,"value",4,"ngFor","ngForOf"],[2,"height","30px!important","line-height","30px!important",3,"value"],[3,"ngModel","disabled","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["id","system_disposition","multiple","","disableRipple","",1,"dyn-full-width",3,"ngModel","ngModelChange"],["class","dyn-opacity-50",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"dyn-opacity-50"],[3,"value"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.bd(1,vi,2,1,"ng-container",1),a.hc()),2&e&&(a.Pb(1),a.Bc("ngForOf",t.agentContactFieldService.contactFieldSubject.value))},directives:[J.o,J.p,J.n,ue.a,on.b,te.d,on.d,te.p,te.s,te.x,on.a,te.u,rn.a,K.b,me.b,sn.c,sn.a,ne.o,te.y,te.t,te.A,ee.a,ee.c],pipes:[J.x,J.y],encapsulation:2}),e})();function fi(e,t){1&e&&a.dc(0,"mat-progress-spinner",7)}const Si=function(e,t){return{"dyn-full-width":e,"dyn-m-r-3 dyn-m-l-3":t}},_i=function(e,t){return{background:e,color:t}};function yi(e,t){if(1&e){const e=a.kc();a.ic(0,"button",5),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc(4).agentConnectorService.onConnectorButtonClick(t)})),a.bd(1,fi,1,0,"mat-progress-spinner",6),a.dd(2),a.hc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc(4);a.Bc("ngClass",a.Hc(5,Si,t.userPreferenceService.userPreferenceSubject.value&&"connectors"!==t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"dashboard"!==t.agentNavService.activeTopSectionSubject.value||"contact"!==t.agentNavService.activeDashboardSectionSubject.value,t.userPreferenceService.userPreferenceSubject.value&&"connectors"===t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"contact"===t.agentNavService.activeDashboardSectionSubject.value))("disabled",t.agentConnectorService.connectorRunning===e||!t.agentContactService.contactSubject.value&&t.agentConnectorService.connectorButtonMap[e]&&!t.agentConnectorService.connectorButtonMap[e].transfer_type&&!t.agentConnectorService.connectorButtonMap[e].destination)("ngStyle",a.Hc(8,_i,t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_color:"#ddd",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].text_color:"#000")),a.Pb(1),a.Bc("ngIf",t.agentConnectorService.connectorRunning===e),a.Pb(1),a.fd(" ",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_text:""," ")}}const Ci=function(e,t){return{"dyn-m-t-10":e,"dyn-inline-block dyn-m-t-8":t}};function Pi(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",2),a.bd(2,yi,3,11,"button",4),a.hc(),a.fc()),2&e){const e=a.uc(),t=e.first,n=e.$implicit,i=a.uc(4);a.Pb(1),a.Bc("ngClass",a.Hc(2,Ci,!t,i.userPreferenceService.userPreferenceSubject.value&&"connectors"===i.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"dashboard"===i.agentNavService.activeTopSectionSubject.value&&"contact"===i.agentNavService.activeDashboardSectionSubject.value)),a.Pb(1),a.Bc("ngIf",i.agentConnectorService.connectorButtonMap[n])}}function wi(e,t){if(1&e&&(a.gc(0),a.bd(1,Pi,3,5,"ng-container",0),a.fc()),2&e){const e=t.$implicit,n=a.uc(4);a.Pb(1),a.Bc("ngIf",n.agentConnectorService.connectorButtonMap[e]&&n.agentConnectorService.connectorButtonMap[e].active)}}function Mi(e,t){if(1&e&&(a.gc(0),a.bd(1,wi,2,1,"ng-container",3),a.fc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngForOf",e.agentConnectorService.campaignConnectorButtons[e.agentStatusService.agentStatusSubject.value.campaign])}}function xi(e,t){1&e&&a.dc(0,"mat-progress-spinner",7)}function Bi(e,t){if(1&e){const e=a.kc();a.ic(0,"button",5),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc(4).agentConnectorService.onConnectorButtonClick(t)})),a.bd(1,xi,1,0,"mat-progress-spinner",6),a.dd(2),a.hc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc(4);a.Bc("ngClass",a.Hc(5,Si,t.userPreferenceService.userPreferenceSubject.value&&"connectors"!==t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"dashboard"!==t.agentNavService.activeTopSectionSubject.value||"contact"!==t.agentNavService.activeDashboardSectionSubject.value,t.userPreferenceService.userPreferenceSubject.value&&"connectors"===t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"contact"===t.agentNavService.activeDashboardSectionSubject.value))("disabled",t.agentConnectorService.connectorRunning===e||!t.agentContactService.contactSubject.value&&t.agentConnectorService.connectorButtonMap[e]&&!t.agentConnectorService.connectorButtonMap[e].transfer_type&&!t.agentConnectorService.connectorButtonMap[e].destination)("ngStyle",a.Hc(8,_i,t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_color:"#ddd",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].text_color:"#000")),a.Pb(1),a.Bc("ngIf",t.agentConnectorService.connectorRunning===e),a.Pb(1),a.fd(" ",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_text:""," ")}}function ki(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",2),a.bd(2,Bi,3,11,"button",4),a.hc(),a.fc()),2&e){const e=a.uc(),t=e.first,n=e.$implicit,i=a.uc(4);a.Pb(1),a.Bc("ngClass",a.Hc(2,Ci,!t,i.userPreferenceService.userPreferenceSubject.value&&"connectors"===i.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"dashboard"===i.agentNavService.activeTopSectionSubject.value&&"contact"===i.agentNavService.activeDashboardSectionSubject.value)),a.Pb(1),a.Bc("ngIf",i.agentConnectorService.connectorButtonMap[n])}}function Fi(e,t){if(1&e&&(a.gc(0),a.bd(1,ki,3,5,"ng-container",0),a.fc()),2&e){const e=t.$implicit,n=a.uc(4);a.Pb(1),a.Bc("ngIf",n.agentConnectorService.connectorButtonMap[e]&&n.agentConnectorService.connectorButtonMap[e].active)}}function Ii(e,t){if(1&e&&(a.gc(0),a.bd(1,Fi,2,1,"ng-container",3),a.fc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngForOf",e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId])}}function Di(e,t){1&e&&a.dc(0,"mat-progress-spinner",7)}function Ti(e,t){if(1&e){const e=a.kc();a.ic(0,"button",5),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc(4).agentConnectorService.onConnectorButtonClick(t)})),a.bd(1,Di,1,0,"mat-progress-spinner",6),a.dd(2),a.hc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc(4);a.Bc("ngClass",a.Hc(5,Si,t.userPreferenceService.userPreferenceSubject.value&&"connectors"!==t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"dashboard"!==t.agentNavService.activeTopSectionSubject.value||"contact"!==t.agentNavService.activeDashboardSectionSubject.value,t.userPreferenceService.userPreferenceSubject.value&&"connectors"===t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"dashboard"===t.agentNavService.activeTopSectionSubject.value&&"contact"===t.agentNavService.activeDashboardSectionSubject.value))("disabled",t.agentConnectorService.connectorRunning===e||!t.agentContactService.contactSubject.value&&t.agentConnectorService.connectorButtonMap[e]&&!t.agentConnectorService.connectorButtonMap[e].transfer_type&&!t.agentConnectorService.connectorButtonMap[e].destination)("ngStyle",a.Hc(8,_i,t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_color:"#ddd",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].text_color:"#000")),a.Pb(1),a.Bc("ngIf",t.agentConnectorService.connectorRunning===e),a.Pb(1),a.fd(" ",t.agentConnectorService.connectorButtonMap[e]?t.agentConnectorService.connectorButtonMap[e].button_text:""," ")}}function ji(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",8),a.bd(2,Ti,3,11,"button",4),a.hc(),a.fc()),2&e){const e=a.uc(),t=e.first,n=e.$implicit,i=a.uc(4);a.Pb(1),a.Bc("ngClass",a.Hc(3,Ci,!t,i.userPreferenceService.userPreferenceSubject.value&&"connectors"===i.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"dashboard"===i.agentNavService.activeTopSectionSubject.value&&"contact"===i.agentNavService.activeDashboardSectionSubject.value))("matTooltipDisabled",i.agentContactService.contactSubject.value||i.agentConnectorService.connectorButtonMap[n]&&i.agentConnectorService.connectorButtonMap[n].transfer_type&&i.agentConnectorService.connectorButtonMap[n].destination),a.Pb(1),a.Bc("ngIf",i.agentConnectorService.connectorButtonMap[n])}}function Oi(e,t){if(1&e&&(a.gc(0),a.bd(1,ji,3,6,"ng-container",0),a.fc()),2&e){const e=t.$implicit,n=a.uc(4);a.Pb(1),a.Bc("ngIf",n.agentConnectorService.connectorButtonMap[e]&&n.agentConnectorService.connectorButtonMap[e].active)}}function Ni(e,t){if(1&e&&(a.gc(0),a.bd(1,Oi,2,1,"ng-container",3),a.fc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngForOf",e.agentConnectorService.orderedBaseConnectorButtons)}}const qi=function(e){return{"dyn-card dyn-m-t-20 dyn-overflow-hidden":e}};function $i(e,t){if(1&e&&(a.ic(0,"div",2),a.bd(1,Mi,2,1,"ng-container",0),a.bd(2,Ii,2,1,"ng-container",0),a.bd(3,Ni,2,1,"ng-container",0),a.hc()),2&e){const e=a.uc(2);a.Yc("width",e.userPreferenceService.userPreferenceSubject.value&&"connectors"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"dashboard"===e.agentNavService.activeTopSectionSubject.value&&"contact"===e.agentNavService.activeDashboardSectionSubject.value?"auto":"250px"),a.Bc("ngClass",a.Gc(6,qi,e.userPreferenceService.userPreferenceSubject.value&&"connectors"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"dashboard"!==e.agentNavService.activeTopSectionSubject.value||"contact"!==e.agentNavService.activeDashboardSectionSubject.value)),a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.campaign&&!(e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.queueId&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId]&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId].length)),a.Pb(1),a.Bc("ngIf",e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.queueId&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId]&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId].length),a.Pb(1),a.Bc("ngIf",!(e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.campaign&&e.agentConnectorService.campaignConnectorButtons[e.agentStatusService.agentStatusSubject.value.campaign]||e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.queueId&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId]&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId].length))}}function Ei(e,t){if(1&e&&(a.ic(0,"div"),a.bd(1,$i,4,8,"div",1),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentConnectorService.orderedBaseConnectorButtons.length||e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.campaign&&e.agentConnectorService.campaignConnectorButtons[e.agentStatusService.agentStatusSubject.value.campaign]&&e.agentConnectorService.campaignConnectorButtons[e.agentStatusService.agentStatusSubject.value.campaign].length||e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.queueId&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId]&&e.agentConnectorService.queueConnectorButtons[e.webPhoneSessionsService.activeSession.data.queueId].length)}}let Ai=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r){this.agentStatusService=e,this.agentConnectorService=t,this.agentUserService=n,this.agentCampaignService=i,this.webPhoneSessionsService=c,this.agentQueueService=a,this.agentContactService=o,this.userPreferenceService=s,this.agentNavService=r,this.JSON=JSON}}return e.\u0275fac=function(t){return new(t||e)(a.bc(p.a),a.bc(j),a.bc(g.a),a.bc(l.a),a.bc(C.a),a.bc(u.a),a.bc(f.a),a.bc(q.a),a.bc(d.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-connectors"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"width","ngClass",4,"ngIf"],[3,"ngClass"],[4,"ngFor","ngForOf"],["mat-raised-button","","class","connector-button",3,"ngClass","disabled","ngStyle","click",4,"ngIf"],["mat-raised-button","",1,"connector-button",3,"ngClass","disabled","ngStyle","click"],["class","dyn-inline-block dyn-vertical-middle dyn-m-r-5","diameter","20","mode","indeterminate",4,"ngIf"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle","dyn-m-r-5"],["matTooltip","No contact selected",3,"ngClass","matTooltipDisabled"]],template:function(e,t){1&e&&a.bd(0,Ei,2,1,"div",0),2&e&&a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value&&t.agentConnectorService.connectorButtonMap.length&&t.agentUserService.user)},directives:[J.p,J.n,J.o,le.b,J.q,fe.a,ue.a],encapsulation:2}),e})();var Qi=n("tUwJ"),Ri=n("mvKb");function Ui(e,t){if(1&e&&(a.ic(0,"option",12),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.fd(" ",e.name," ")}}function Vi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.dc(2,"option",12),a.bd(3,Ui,2,2,"option",13),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only)),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactDispositionService.contactDispositions)}}function Wi(e,t){if(1&e&&(a.ic(0,"option",12),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.fd(" ",e.name," ")}}function zi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.dc(2,"option",12),a.bd(3,Wi,2,2,"option",13),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only)),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions)}}function Hi(e,t){if(1&e&&(a.ic(0,"option",12),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.app_user),a.Pb(1),a.fd(" ",e.full_name," ")}}function Li(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.dc(2,"option",12),a.bd(3,Hi,2,2,"option",13),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only)),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentUserService.users)}}function Xi(e,t){if(1&e&&(a.ic(0,"option",15),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.internal_value),a.Pb(1),a.fd(" ",e.external_value," ")}}function Gi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"select",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.dc(2,"option",12),a.bd(3,Xi,2,2,"option",14),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only)),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].choices)}}function Yi(e,t){if(1&e&&(a.ic(0,"span",19),a.dd(1),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(5);a.Pb(1),a.gd(" (+",(null==t.dynamicAgentScriptManagerService.contact[e.name]?null:t.dynamicAgentScriptManagerService.contact[e.name].length)-1," ",2===(null==t.dynamicAgentScriptManagerService.contact[e.name]?null:t.dynamicAgentScriptManagerService.contact[e.name].length)?"other":"others",") ")}}function Ji(e,t){if(1&e&&(a.ic(0,"mat-option",15),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.internal_value),a.Pb(1),a.fd(" ",e.external_value," ")}}function Zi(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-form-field",16),a.ic(2,"mat-select",17),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("closed",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.ic(3,"mat-select-trigger"),a.dd(4),a.bd(5,Yi,2,2,"span",18),a.hc(),a.bd(6,Ji,2,2,"mat-option",14),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(2),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only)),a.Pb(2),a.fd(" ",t.dynamicAgentScriptManagerService.contact[e.name]?t.dynamicAgentScriptManagerService.contact[e.name][0]:""," "),a.Pb(1),a.Bc("ngIf",(null==t.dynamicAgentScriptManagerService.contact[e.name]?null:t.dynamicAgentScriptManagerService.contact[e.name].length)>1),a.Pb(1),a.Bc("ngForOf",null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].choices)}}function Ki(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"mat-slide-toggle",11),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only))}}function ec(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",20),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("blur",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only))}}function tc(e,t){if(1&e&&(a.ic(0,"option"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.fd(" ",e.email," ")}}function nc(e,t){if(1&e&&(a.gc(0),a.bd(1,tc,2,1,"option",0),a.fc()),2&e){const e=t.$implicit,n=a.uc(2).$implicit,i=a.uc(5);a.Pb(1),a.Bc("ngIf",e.contact_field===(null==i.agentContactFieldService.contactFieldNameMap[n.name]?null:i.agentContactFieldService.contactFieldNameMap[n.name].id))}}function ic(e,t){if(1&e&&(a.gc(0),a.ic(1,"select"),a.bd(2,nc,2,1,"ng-container",1),a.hc(),a.fc()),2&e){const e=a.uc(6);a.Pb(2),a.Bc("ngForOf",e.dynamicAgentScriptManagerService.contact._email_addresses)}}function cc(e,t){if(1&e&&(a.ic(0,"option"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.fd(" ",e.phone_number," ")}}function ac(e,t){if(1&e&&(a.gc(0),a.bd(1,cc,2,1,"option",0),a.fc()),2&e){const e=t.$implicit,n=a.uc(2).$implicit,i=a.uc(5);a.Pb(1),a.Bc("ngIf",e.contact_field===(null==i.agentContactFieldService.contactFieldNameMap[n.name]?null:i.agentContactFieldService.contactFieldNameMap[n.name].id))}}function oc(e,t){if(1&e&&(a.gc(0),a.ic(1,"select"),a.bd(2,ac,2,1,"ng-container",1),a.hc(),a.fc()),2&e){const e=a.uc(6);a.Pb(2),a.Bc("ngForOf",e.dynamicAgentScriptManagerService.contact._phone_numbers)}}function sc(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",21),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("blur",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(5);a.Pb(1),a.Bc("ngModel",t.dynamicAgentScriptManagerService.contact[e.name])("disabled",e.readOnly||(null==t.agentContactFieldService.contactFieldNameMap[e.name]?null:t.agentContactFieldService.contactFieldNameMap[e.name].agent_read_only))}}function rc(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",22),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.hc(),a.dc(2,"owl-date-time",23,24),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc().$implicit,n=a.uc(5);a.Pb(1),a.Bc("ngModel",n.dynamicAgentScriptManagerService.contact[t.name])("disabled",t.readOnly||(null==n.agentContactFieldService.contactFieldNameMap[t.name]?null:n.agentContactFieldService.contactFieldNameMap[t.name].agent_read_only))("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(1),a.Bc("pickerType","calendar")}}function dc(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"input",22),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.contact[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(5).dynamicAgentScriptManagerService.onContactFieldChanged(t.name)})),a.hc(),a.dc(2,"owl-date-time",25,26),a.fc()}if(2&e){const e=a.Mc(3),t=a.uc().$implicit,n=a.uc(5);a.Pb(1),a.Bc("ngModel",n.dynamicAgentScriptManagerService.contact[t.name])("disabled",t.readOnly||(null==n.agentContactFieldService.contactFieldNameMap[t.name]?null:n.agentContactFieldService.contactFieldNameMap[t.name].agent_read_only))("owlDateTime",e)("owlDateTimeTrigger",e)}}function lc(e,t){if(1&e&&(a.gc(0),a.ic(1,"div"),a.ic(2,"label"),a.dd(3),a.hc(),a.dc(4,"br"),a.bd(5,Vi,4,4,"ng-container",0),a.bd(6,zi,4,4,"ng-container",0),a.bd(7,Li,4,4,"ng-container",0),a.bd(8,Gi,4,4,"ng-container",0),a.bd(9,Zi,7,5,"ng-container",0),a.bd(10,Ki,2,2,"ng-container",0),a.bd(11,ec,2,2,"ng-container",0),a.bd(12,ic,3,1,"ng-container",0),a.bd(13,oc,3,1,"ng-container",0),a.bd(14,sc,2,2,"ng-container",0),a.bd(15,rc,4,5,"ng-container",0),a.bd(16,dc,4,4,"ng-container",0),a.hc(),a.fc()),2&e){const e=t.$implicit,n=a.uc(5);a.Pb(3),a.fd(" ",null==n.agentContactFieldService||null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].label," "),a.Pb(2),a.Bc("ngIf","disposition_id"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","call_disposition_id"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","owned_by"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Picklist"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Picklist Multiselect"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Checkbox"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Text"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&"owned_by"!==(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Email Address"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Phone Number"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf",("Integer"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)||"Decimal"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type))&&"disposition_id"!==(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&"call_disposition_id"!==(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].name)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Date"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact),a.Pb(1),a.Bc("ngIf","Date Time"===(null==n.agentContactFieldService.contactFieldNameMap[e.name]?null:n.agentContactFieldService.contactFieldNameMap[e.name].data_type)&&n.dynamicAgentScriptManagerService.contact)}}function uc(e,t){1&e&&(a.ic(0,"div",27),a.dd(1," Saving Contact.. "),a.hc())}function gc(e,t){if(1&e&&(a.ic(0,"div",8),a.ic(1,"div",9),a.bd(2,lc,17,13,"ng-container",1),a.bd(3,uc,2,0,"div",10),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(2);a.Pb(2),a.Bc("ngForOf",e.contactFields),a.Pb(1),a.Bc("ngIf",t.dynamicAgentScriptManagerService.savingContact)}}function hc(e,t){if(1&e&&(a.ic(0,"div",5),a.dc(1,"div",6),a.vc(2,"sanitizeHtml"),a.bd(3,gc,4,2,"div",7),a.hc()),2&e){const e=a.uc(),t=e.$implicit;a.Tb("dyn-m-t-20",!e.first),a.Pb(1),a.Bc("innerHTML",a.wc(2,4,t.body),a.Rc),a.Pb(2),a.Bc("ngIf",t.contactFields.length)}}function bc(e,t){if(1&e&&(a.gc(0),a.ic(1,"div"),a.dc(2,"img",29),a.dd(3),a.hc(),a.fc()),2&e){const e=t.$implicit,n=a.uc(4);a.Pb(3),a.hd(" Condition Met: ",null==n.agentContactFieldService||null==n.agentContactFieldService.contactFieldNameMap[e.value_left]?null:n.agentContactFieldService.contactFieldNameMap[e.value_left].label," ","equals"===e.operator?" = ":e.operator," ",e.value_right," ")}}function pc(e,t){if(1&e&&(a.ic(0,"div",28),a.bd(1,bc,4,3,"ng-container",1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngForOf",e.conditions)}}function vc(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",30),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc(2).dynamicAgentScriptManagerService.onButtonClick(t.id)})),a.dd(2),a.hc(),a.fc()}if(2&e){const e=a.uc().$implicit,t=a.uc(2);a.Pb(1),a.Tb("active",t.dynamicAgentScriptManagerService.isButtonClicked(e.id)),a.Pb(1),a.fd(" ",e.body," ")}}const mc=function(e,t){return{"dyn-m-b-20":e,"dyn-inline-block dyn-m-r-10":t}};function fc(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",2),a.bd(2,hc,4,6,"div",3),a.bd(3,pc,2,1,"div",4),a.bd(4,vc,3,3,"ng-container",0),a.hc(),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngClass",a.Hc(4,mc,"button"!==e.type,"button"===e.type)),a.Pb(1),a.Bc("ngIf","agent_script"===e.type),a.Pb(1),a.Bc("ngIf","condition"===e.type),a.Pb(1),a.Bc("ngIf","button"===e.type)}}function Sc(e,t){if(1&e&&(a.gc(0),a.bd(1,fc,5,7,"ng-container",1),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.dynamicAgentScriptManagerService.timeline)}}let _c=(()=>{class e{constructor(e,t,n,i,c){this.dynamicAgentScriptManagerService=e,this.agentContactFieldService=t,this.agentCallDispositionService=n,this.agentUserService=i,this.agentContactDispositionService=c}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(a.bc(Qi.a),a.bc(h.a),a.bc(b.a),a.bc(g.a),a.bc(N))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-dynamic-agent-script"]],decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"ngClass"],["class","agent-script-block",3,"dyn-m-t-20",4,"ngIf"],["class","condition-block",4,"ngIf"],[1,"agent-script-block"],[1,"script-body",3,"innerHTML"],["class","dyn-m-t-20",4,"ngIf"],[1,"dyn-m-t-20"],[1,"contact-fields-container"],["class","dyn-text-sm dyn-m-l-20 dyn-text-muted",4,"ngIf"],[3,"ngModel","disabled","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["appearance","outline",1,"dyn-search-select"],["multiple","","disableRipple","",3,"ngModel","disabled","ngModelChange","closed"],["class","dyn-opacity-50",4,"ngIf"],[1,"dyn-opacity-50"],["type","text",3,"ngModel","disabled","ngModelChange","blur"],["type","number",3,"ngModel","disabled","ngModelChange","blur"],["type","text",3,"ngModel","disabled","owlDateTime","owlDateTimeTrigger","ngModelChange"],["hour12Timer","true",3,"pickerType"],["dt1",""],["hour12Timer","true"],["dt2",""],[1,"dyn-text-sm","dyn-m-l-20","dyn-text-muted"],[1,"condition-block"],["src","assets/img/dynamic-agent-scripts/green-checkmark-icon.svg","alt","Checkmark","height","14px",1,"dyn-vertical-middle","dyn-m-r-10"],[1,"dynamic-script-btn",3,"click"]],template:function(e,t){1&e&&a.bd(0,Sc,2,1,"ng-container",0),2&e&&a.Bc("ngIf",t.dynamicAgentScriptManagerService.flattenedData)},directives:[J.p,J.o,J.n,te.y,te.p,te.s,te.t,te.A,K.b,ee.a,ee.c,ne.o,rn.a,te.d,te.u,on.b,on.d,on.a],pipes:[Ri.a],styles:['.button-group-inline[_ngcontent-%COMP%]{display:flex;gap:5px}.button-children[_ngcontent-%COMP%]{margin-top:10px}.agent-script-block[_ngcontent-%COMP%], .button-block[_ngcontent-%COMP%], .condition-block[_ngcontent-%COMP%]{padding:20px;box-sizing:border-box;border-radius:7px}.agent-script-block[_ngcontent-%COMP%]{background:#fff;border:1px solid #d4d4d4}button[_ngcontent-%COMP%]{background-color:#fff;border:none;border-radius:5px;box-sizing:border-box;cursor:pointer;transition:.5s;position:relative;padding:10px 15px 10px 35px}button[_ngcontent-%COMP%]:hover:before{background-color:#2979ff}button[_ngcontent-%COMP%]:before{content:"";display:inline-block;position:absolute;left:10px;top:50%;transform:translateY(-50%);width:12px;height:12px;border:2px solid #b6b3b3;border-radius:50%;background-color:#fff;transition:background-color .3s,border-color .3s}.button[_ngcontent-%COMP%]:before:hover{background-color:#2979ff}button.active[_ngcontent-%COMP%]{background-color:#f1f1f1}button.active[_ngcontent-%COMP%]:before{background-color:#2979ff}.condition-block[_ngcontent-%COMP%]{background-color:#d0f1d7;color:#266b35;font-size:.8rem}.contact-fields-container[_ngcontent-%COMP%]{display:grid;width:100%;grid-gap:5px 10px;grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}.contact-fields-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%], .contact-fields-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .contact-fields-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%!important}']}),e})();function yc(e,t){1&e&&(a.ic(0,"div",21),a.ic(1,"div",22),a.dc(2,"mat-progress-spinner",23),a.dd(3," Loading... "),a.hc(),a.hc())}function Cc(e,t){if(1&e&&(a.ic(0,"option",25),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(2);a.Bc("ngValue",e),a.Pb(1),a.gd(" ",e.contact_field&&n.agentContactFieldService.contactFieldMap[e.contact_field]&&n.agentContactFieldService.contactFieldMap[e.contact_field].label?n.agentContactFieldService.contactFieldMap[e.contact_field].label+" - ":""," ",e.phone_number," ")}}function Pc(e,t){if(1&e&&(a.gc(0),a.bd(1,Cc,2,3,"option",24),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.agentContactService.contactSubject.value._phone_numbers)}}function wc(e,t){1&e&&a.dc(0,"img",30)}function Mc(e,t){1&e&&a.dc(0,"img",31)}function xc(e,t){1&e&&a.dc(0,"img",30)}function Bc(e,t){1&e&&a.dc(0,"img",31)}function kc(e,t){1&e&&a.dc(0,"img",30)}function Fc(e,t){1&e&&a.dc(0,"img",31)}function Ic(e,t){1&e&&a.dc(0,"img",30)}function Dc(e,t){1&e&&a.dc(0,"img",31)}function Tc(e,t){if(1&e&&(a.ic(0,"div",26),a.ic(1,"div"),a.ic(2,"span",27),a.dd(3,"DNC:"),a.hc(),a.bd(4,wc,1,0,"img",28),a.bd(5,Mc,1,0,"img",29),a.hc(),a.ic(6,"div"),a.ic(7,"span",27),a.dd(8,"FDNC:"),a.hc(),a.bd(9,xc,1,0,"img",28),a.bd(10,Bc,1,0,"img",29),a.hc(),a.ic(11,"div"),a.ic(12,"span",27),a.dd(13,"Do Not SMS:"),a.hc(),a.bd(14,kc,1,0,"img",28),a.bd(15,Fc,1,0,"img",29),a.hc(),a.ic(16,"div"),a.ic(17,"span",27),a.dd(18,"Mobile:"),a.hc(),a.bd(19,Ic,1,0,"img",28),a.bd(20,Dc,1,0,"img",29),a.hc(),a.hc()),2&e){const e=a.uc();a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.do_not_contact),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.do_not_contact),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.is_fdnc),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.is_fdnc),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.do_not_sms),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.do_not_sms),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.is_mobile),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.is_mobile)}}function jc(e,t){if(1&e&&(a.ic(0,"option",25),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(2);a.Bc("ngValue",e),a.Pb(1),a.gd(" ",e.contact_field&&n.agentContactFieldService.contactFieldMap[e.contact_field]&&n.agentContactFieldService.contactFieldMap[e.contact_field].label?n.agentContactFieldService.contactFieldMap[e.contact_field].label+" - ":""," ",e.email," ")}}function Oc(e,t){if(1&e&&(a.gc(0),a.bd(1,jc,2,3,"option",24),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.agentContactService.contactSubject.value._email_addresses)}}function Nc(e,t){1&e&&a.dc(0,"img",30)}function qc(e,t){1&e&&a.dc(0,"img",31)}function $c(e,t){if(1&e&&(a.ic(0,"div",32),a.ic(1,"span",27),a.dd(2,"DNC:"),a.hc(),a.bd(3,Nc,1,0,"img",28),a.bd(4,qc,1,0,"img",29),a.hc()),2&e){const e=a.uc();a.Pb(3),a.Bc("ngIf",e.agentContactService.selectedEmailAddress.do_not_contact),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedEmailAddress.do_not_contact)}}function Ec(e,t){if(1&e){const e=a.kc();a.ic(0,"button",38),a.qc("click",(function(){return a.Qc(e),a.uc(2).agentContactFieldService.showContactFieldOrderDialog()})),a.ic(1,"mat-icon"),a.dd(2,"tune"),a.hc(),a.dd(3," Organize Contact Fields "),a.hc()}}function Ac(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"button",33),a.qc("click",(function(){return a.Qc(e),a.uc().agentStoredContactService.storeContact()})),a.ic(2,"mat-icon"),a.dd(3,"tab_unselected"),a.hc(),a.hc(),a.ic(4,"button",34),a.ic(5,"mat-icon"),a.dd(6,"more_vert"),a.hc(),a.hc(),a.ic(7,"mat-menu",null,35),a.ic(9,"div",36),a.ic(10,"button",12),a.qc("click",(function(){return a.Qc(e),a.uc().agentContactService.showCreateContactDialog()})),a.ic(11,"mat-icon"),a.dd(12,"add"),a.hc(),a.dd(13," Create Contact "),a.hc(),a.hc(),a.bd(14,Ec,4,0,"button",37),a.hc(),a.hc()}if(2&e){const e=a.Mc(8),t=a.uc();a.Pb(1),a.Bc("disabled",!t.agentContactService.contactSubject.value),a.Pb(3),a.Bc("mat-menu-trigger-for",e),a.Pb(5),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_write_create")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_write_create")||t.agentContactService.loading.value),a.Pb(4),a.Bc("ngIf",!t.agentDashboardSettingsService.showCustomDashboardSettings)}}function Qc(e,t){1&e&&a.dc(0,"custom-contact-form")}function Rc(e,t){1&e&&a.dc(0,"default-contact-form")}function Uc(e,t){if(1&e){const e=a.kc();a.ic(0,"button",44),a.qc("click",(function(){return a.Qc(e),a.uc(3).updateLowerSection("contactMeta")})),a.dd(1,"Contact Details"),a.hc()}if(2&e){const e=a.uc(3);a.Tb("active","noteInput"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"agentScript"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"connectors"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section)}}function Vc(e,t){if(1&e){const e=a.kc();a.ic(0,"div",42),a.bd(1,Uc,2,2,"button",43),a.ic(2,"button",44),a.qc("click",(function(){return a.Qc(e),a.uc(2).updateLowerSection("noteInput")})),a.dd(3,"Notes"),a.hc(),a.ic(4,"button",44),a.qc("click",(function(){return a.Qc(e),a.uc(2).updateLowerSection("agentScript")})),a.dd(5,"Agent Script"),a.hc(),a.ic(6,"button",45),a.qc("click",(function(){return a.Qc(e),a.uc(2).updateLowerSection("connectors")})),a.dd(7,"Connectors"),a.hc(),a.hc()}if(2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",!e.agentDashboardSettingsService.showCustomDashboardSettings),a.Pb(1),a.Tb("active","noteInput"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section),a.Pb(2),a.Tb("active","agentScript"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section),a.Pb(2),a.Tb("active","connectors"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section)}}function Wc(e,t){1&e&&(a.ic(0,"div",46),a.dc(1,"app-connectors"),a.hc())}function zc(e,t){1&e&&(a.ic(0,"span",52),a.dd(1," *Contact is not saved "),a.hc())}function Hc(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"textarea",47),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).agentNoteService.noteInput=t})),a.hc(),a.ic(2,"div",48),a.ic(3,"div",49),a.dd(4),a.hc(),a.ic(5,"div"),a.ic(6,"button",50),a.qc("click",(function(){a.Qc(e);const t=a.uc(2);return t.agentNoteService.createNote(null==t.agentContactService.contactSubject.value?null:t.agentContactService.contactSubject.value.id)})),a.dd(7,"Save"),a.hc(),a.ic(8,"div"),a.bd(9,zc,2,0,"span",51),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngModel",e.agentNoteService.noteInput),a.Pb(2),a.Tb("dyn-error",e.agentNoteService.noteInput.length>1024),a.Pb(1),a.fd(" ",e.agentNoteService.noteInput.length,"/1024 "),a.Pb(2),a.Bc("disabled",e.agentNoteService.savingNote||e.agentContactService.contactSubject.value&&!e.agentContactService.contactSubject.value.id||e.agentNoteService.noteInput.length>1024),a.Pb(3),a.Bc("ngIf",e.agentContactService.contactSubject.value&&!e.agentContactService.contactSubject.value.id)}}function Lc(e,t){1&e&&(a.ic(0,"div",55),a.dd(1," No Script Selected "),a.hc())}function Xc(e,t){1&e&&(a.gc(0),a.dc(1,"app-dynamic-agent-script"),a.fc())}function Gc(e,t){if(1&e&&(a.dc(0,"div",56),a.vc(1,"sanitizeHtml")),2&e){const e=a.uc(3);a.Bc("innerHTML",a.wc(1,1,e.agentAgentScriptService.formattedScript),a.Rc)}}function Yc(e,t){if(1&e&&(a.ic(0,"div"),a.bd(1,Lc,2,0,"div",53),a.bd(2,Xc,2,0,"ng-container",6),a.bd(3,Gc,2,3,"div",54),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",!e.agentAgentScriptService.agentScriptSubject.value),a.Pb(1),a.Bc("ngIf","dynamic"===e.agentAgentScriptService.agentScriptType),a.Pb(1),a.Bc("ngIf",e.agentAgentScriptService.formattedScript&&"simple"===e.agentAgentScriptService.agentScriptType)}}function Jc(e,t){if(1&e&&(a.ic(0,"div",64),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",t.agentContactService.contactSubject.value[e.name]?t.agentContactService.contactSubject.value[e.name]:"N/A"," ")}}function Zc(e,t){if(1&e&&(a.ic(0,"div",64),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",t.agentUserService.usersMap[t.agentContactService.contactSubject.value[e.name]]?t.agentUserService.usersMap[t.agentContactService.contactSubject.value[e.name]].full_name:"N/A"," ")}}function Kc(e,t){if(1&e&&(a.ic(0,"div",64),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",a.xc(2,1,t.agentContactService.contactSubject.value[e.name],"MM/d/y")," ")}}function ea(e,t){if(1&e&&(a.ic(0,"div",64),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",a.xc(2,1,t.agentContactService.contactSubject.value[e.name],"MM/d/y, h:mm a")," ")}}function ta(e,t){if(1&e&&(a.ic(0,"div",13),a.bd(1,Jc,2,1,"div",63),a.bd(2,Zc,2,1,"div",63),a.bd(3,Kc,3,4,"div",63),a.bd(4,ea,3,4,"div",63),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","Date Time"!==e.data_type&&"Date"!==e.data_type&&"modified_by"!==e.name&&"created_by"!==e.name),a.Pb(1),a.Bc("ngIf","modified_by"===e.name||"created_by"===e.name),a.Pb(1),a.Bc("ngIf","Date"===e.data_type),a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type)}}function na(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"input",65),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.Bc("disabled",e.read_only)("readOnly",e.read_only)("ngModel",t.agentContactService.contactSubject.value[e.name])("required",e.required)}}function ia(e,t){if(1&e&&(a.ic(0,"option",25),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngValue",e.app_user),a.Pb(1),a.ed(e.full_name)}}function ca(e,t){if(1&e&&(a.gc(0),a.bd(1,ia,2,2,"option",68),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.is_agent)}}function aa(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",66),a.ic(2,"select",67),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.dc(3,"option",25),a.bd(4,ca,2,1,"ng-container",58),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_write_update_owner")),a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only||!t.permissionService.hasPermission("contacts_write_update_owner")),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentUserService.users)}}function oa(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"input",69),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.dc(2,"owl-date-time",70,71),a.hc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc(3);a.Pb(1),a.Bc("disabled",t.read_only)("readOnly",t.read_only)("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",n.agentContactService.contactSubject.value[t.name])("required",t.required),a.Pb(1),a.Bc("disabled",t.read_only)}}function sa(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"input",72),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc(3).$implicit;return t.value=t.value.toISOString()})),a.hc(),a.dc(2,"owl-date-time",73,74),a.hc()}if(2&e){const e=a.Mc(3),t=a.uc(3).$implicit,n=a.uc(3);a.Pb(1),a.Bc("disabled",t.read_only)("readOnly",t.read_only)("ngModel",n.agentContactService.contactSubject.value[t.name])("owlDateTime",e)("owlDateTimeTrigger",e)("required",t.required),a.Pb(1),a.Bc("disabled",t.read_only)("pickerType","calendar")}}function ra(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"input",75),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.Bc("disabled",e.read_only)("readOnly",e.read_only)("ngModel",t.agentContactService.contactSubject.value[e.name])("required",e.required)}}function da(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",76),a.ic(2,"mat-slide-toggle",77),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(2),a.Bc("disabled",e.read_only)("ngModel",t.agentContactService.contactSubject.value[e.name])("checked",e.value)}}function la(e,t){if(1&e&&(a.ic(0,"option",25),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function ua(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"select",67),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",25),a.bd(3,la,3,4,"option",24),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentContactDispositionService.contactDispositions)}}function ga(e,t){if(1&e&&(a.ic(0,"option",25),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(a.wc(2,2,e.name))}}function ha(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"select",67),a.qc("ngModelChange",(function(t){a.Qc(e);const n=a.uc(3).$implicit;return a.uc(3).agentContactService.contactSubject.value[n.name]=t})),a.dc(2,"option",25),a.bd(3,ga,3,4,"option",24),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.Bc("ngModel",t.agentContactService.contactSubject.value[e.name])("disabled",e.read_only),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions)}}function ba(e,t){if(1&e&&(a.ic(0,"div",13),a.bd(1,na,2,4,"div",6),a.bd(2,aa,5,5,"div",6),a.bd(3,oa,4,7,"div",6),a.bd(4,sa,4,8,"div",6),a.bd(5,ra,2,4,"div",6),a.bd(6,da,3,3,"div",6),a.bd(7,ua,4,4,"div",6),a.bd(8,ha,4,4,"div",6),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","Text"===e.data_type&&"owned_by"!==e.name),a.Pb(1),a.Bc("ngIf","owned_by"===e.name),a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type),a.Pb(1),a.Bc("ngIf","Date"===e.data_type),a.Pb(1),a.Bc("ngIf",("Integer"===e.data_type||"Decimal"===e.data_type)&&"disposition_id"!==e.name&&"call_disposition_id"!==e.name),a.Pb(1),a.Bc("ngIf","Checkbox"===e.data_type),a.Pb(1),a.Bc("ngIf","disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","call_disposition_id"===e.name)}}const pa=function(e){return{"dyn-error-input":e}};function va(e,t){if(1&e&&(a.ic(0,"div",60),a.ic(1,"label",61),a.dd(2),a.hc(),a.bd(3,ta,5,4,"div",62),a.bd(4,ba,9,8,"div",62),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Bc("ngClass",a.Gc(5,pa,t.agentContactService.requiredFieldError&&e.required&&!t.agentContactService.contactSubject.value[e.name])),a.Pb(2),a.gd(" ",e.label,"",e.required?"*":"",": "),a.Pb(1),a.Bc("ngIf",e.system_read_only),a.Pb(1),a.Bc("ngIf",!e.system_read_only)}}function ma(e,t){if(1&e&&(a.gc(0),a.bd(1,va,5,7,"div",59),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.is_meta&&e.show_on_dash)}}function fa(e,t){if(1&e&&(a.ic(0,"div",57),a.bd(1,ma,2,1,"ng-container",58),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngForOf",e.agentContactFieldService.contactFieldSubject.value)}}function Sa(e,t){if(1&e&&(a.gc(0),a.dc(1,"hr"),a.bd(2,Vc,8,7,"div",39),a.bd(3,Wc,2,0,"div",40),a.bd(4,Hc,10,6,"div",6),a.bd(5,Yc,4,3,"div",6),a.bd(6,fa,2,1,"div",41),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Tb("dyn-m-t-0",e.agentDashboardSettingsService.showCustomDashboardSettings),a.Pb(1),a.Bc("ngIf",e.userPreferenceService.userPreferenceSubject.value),a.Pb(1),a.Bc("ngIf",e.userPreferenceService.userPreferenceSubject.value&&"connectors"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section),a.Pb(1),a.Bc("ngIf",e.userPreferenceService.userPreferenceSubject.value&&"noteInput"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section),a.Pb(1),a.Bc("ngIf",e.userPreferenceService.userPreferenceSubject.value&&"agentScript"===e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section),a.Pb(1),a.Bc("ngIf",!e.agentDashboardSettingsService.showCustomDashboardSettings&&e.userPreferenceService.userPreferenceSubject.value&&"noteInput"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"connectors"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section&&"agentScript"!==e.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section)}}let _a=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p,v,m,f,S,_,y,C,P,w,M){this._http=e,this._snackBar=t,this._dialog=n,this._utils=i,this._emailAddressService=c,this._phoneNumberService=a,this._webPhoneSessionsService=o,this._agentAccountSettingService=s,this._personalizationService=r,this._authService=d,this._userService=l,this._agentQueueService=u,this._agentStatusService=g,this._webPhoneService=h,this.agentNoteService=b,this.agentDashboardSettingsService=p,this.userPreferenceService=v,this.permissionService=m,this.agentStoredContactService=f,this.agentContactFieldService=S,this.agentCallDispositionService=_,this.agentContactDispositionService=y,this.agentContactService=C,this.agentUserService=P,this.agentNavService=w,this.agentAgentScriptService=M,this.queueIds=[],this.callQueueId=null,this.campaignId=null}ngOnInit(){this._personalizationService.get().subscribe({next:e=>{e.results&&e.results.length&&(this.agentAgentScriptService.accountHasPersonalizationScripts=!0)}}),this.accountSettingSubscription=this._agentAccountSettingService.accountSettingsSubject.subscribe({next:e=>{this.accountSettings=e}}),this._userService.getUserDashboardSettings(this._authService.getUserId()).subscribe({next:e=>{var t,n;this.agentDashboardSettingsService.dashboardSettings=e,e&&(e.default_dashboard_settings&&e.default_dashboard_settings.agent_dash_contact_form_sections?(this.agentDashboardSettingsService.data=e.default_dashboard_settings.agent_dash_contact_form_sections,this.agentDashboardSettingsService.customSidebarFields=null!==(n=null===(t=e.default_dashboard_settings)||void 0===t?void 0:t.agent_dash_sidebar_fields)&&void 0!==n?n:null):this.agentDashboardSettingsService.showCustomDashboardSettings=!1,this.queueAgentSubscription=this._agentQueueService.queueAgentsUpdatedSubject.subscribe({next:()=>{this._checkWhichCustomDashToShow()}}),this.agentStatusSubscription=this._agentStatusService.agentStatusSubject.subscribe({next:e=>{e&&(this.campaignId=e.campaign,this._checkWhichCustomDashToShow())}}),this.phoneEventSubscription=this._webPhoneService.phoneEvents.subscribe(e=>{e&&("confirmed"===e.type?this._handleConfirmedCallEvent():"ended"===e.type&&this._handleCallEndedEvent())}))}})}ngOnDestroy(){this.agentStatusSubscription&&this.agentStatusSubscription.unsubscribe(),this.accountSettingSubscription&&this.accountSettingSubscription.unsubscribe(),this.queueAgentSubscription&&this.queueAgentSubscription.unsubscribe(),this.phoneEventSubscription&&this.phoneEventSubscription.unsubscribe()}_handleCallEndedEvent(){this.callQueueId=null,this._checkWhichCustomDashToShow()}_handleConfirmedCallEvent(){var e;if(this._webPhoneSessionsService.activeSession){const t=null===(e=this._webPhoneSessionsService.activeSession.data)||void 0===e?void 0:e.queueId;this.callQueueId=t||null,this.callQueueId&&(this.queueIds=this._agentQueueService.queueAgents&&this._agentQueueService.queueAgents.length?this._agentQueueService.queueAgents.map(e=>e.queue):[],this._checkWhichCustomDashToShow())}}_checkWhichCustomDashToShow(){var e,t,n;this.callQueueId&&this.queueIds.includes(this.callQueueId)&&this.agentDashboardSettingsService.dashboardSettings&&this.agentDashboardSettingsService.dashboardSettings.queue_dashboard_settings[this.callQueueId]?(this.agentDashboardSettingsService.data=this.agentDashboardSettingsService.dashboardSettings.queue_dashboard_settings[this.callQueueId].agent_dash_contact_form_sections,this.agentDashboardSettingsService.customSidebarFields=null!==(e=this.agentDashboardSettingsService.dashboardSettings.queue_dashboard_settings[this.callQueueId].agent_dash_sidebar_fields)&&void 0!==e?e:null,this.agentDashboardSettingsService.showCustomDashboardSettings=!0):this.campaignId&&this.agentDashboardSettingsService.dashboardSettings&&this.agentDashboardSettingsService.dashboardSettings.campaign_dashboard_settings[this.campaignId]?(this.agentDashboardSettingsService.data=this.agentDashboardSettingsService.dashboardSettings.campaign_dashboard_settings[this.campaignId].agent_dash_contact_form_sections,this.agentDashboardSettingsService.customSidebarFields=null!==(t=this.agentDashboardSettingsService.dashboardSettings.campaign_dashboard_settings[this.campaignId].agent_dash_sidebar_fields)&&void 0!==t?t:null,this.agentDashboardSettingsService.showCustomDashboardSettings=!0):this.agentDashboardSettingsService.dashboardSettings&&this.agentDashboardSettingsService.dashboardSettings.default_dashboard_settings?(this.agentDashboardSettingsService.data=this.agentDashboardSettingsService.dashboardSettings.default_dashboard_settings.agent_dash_contact_form_sections,this.agentDashboardSettingsService.customSidebarFields=null!==(n=this.agentDashboardSettingsService.dashboardSettings.default_dashboard_settings.agent_dash_sidebar_fields)&&void 0!==n?n:null,this.agentDashboardSettingsService.showCustomDashboardSettings=!0):this.agentDashboardSettingsService.showCustomDashboardSettings=!1}copyToClipboard(e){this._utils.copyToClipboard(e),this._snackBar.open("Copied Successfully","",{duration:3e3,verticalPosition:"top",panelClass:"success"})}clickToCall(){this.permissionService.hasPermission("click_to_call")&&this._webPhoneSessionsService.call(this.agentContactService.selectedPhoneNumber.phone_number)}updateLowerSection(e){const t=this.userPreferenceService.userPreferenceSubject.value;t.agent_dash_lower_section=e,this.userPreferenceService.userPreferenceSubject.next(t),this.userPreferenceService.update({agent_dash_lower_section:e})}showCreatePhoneNumberDialog(){this.agentContactService.contactSubject.value?this._dialog.open(Yt,{width:"400px"}).afterClosed().subscribe({next:e=>{e&&this.agentContactService.contactSubject.value&&(this.agentContactService.contactSubject.value[this.agentContactFieldService.contactFieldMap[e.contact_field].name]=e.phone_number,this.agentContactService.contactSubject.value._phone_numbers&&this.agentContactService.contactSubject.value._phone_numbers.push(e),this.agentContactService.selectedPhoneNumber=e,this._snackBar.open("Phone Number Created","X",{duration:2500,verticalPosition:"top",panelClass:["success"]}))}}):this._snackBar.open("No Contact Selected","X",{duration:2500,verticalPosition:"top",panelClass:["error"]})}showCreateEmailDialog(){this.agentContactService.contactSubject.value?this._dialog.open(Kt,{width:"400px"}).afterClosed().subscribe({next:e=>{e&&(this.agentContactFieldService.contactFieldMap[e.contact_field]&&(this.agentContactService.contactSubject.value[this.agentContactFieldService.contactFieldMap[e.contact_field].name]=e.email),this.agentContactService.contactSubject.value._email_addresses.push(e),this.agentContactService.selectedEmailAddress=e,this._snackBar.open("Email Address Created","X",{duration:2500,verticalPosition:"top",panelClass:["success"]}))}}):this._snackBar.open("No Contact Selected","X",{duration:2500,verticalPosition:"top",panelClass:["error"]})}showDeleteEmailConfirmation(){const e=this.agentContactService.selectedEmailAddress;e&&this._dialog.open(en.a,{width:"500px",data:{title:`Delete ${e.email}?`,buttonText:"Delete"}}).afterClosed().subscribe({next:t=>{t&&this._emailAddressService.delete(e.id).subscribe({next:()=>{const t=this.agentContactService.contactSubject.value._email_addresses.findIndex(t=>t.id===e.id);this.agentContactService.contactSubject.value._email_addresses.splice(t,1),this._snackBar.open("Email Address Deleted","X",{duration:2500,verticalPosition:"top",panelClass:"success"})},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Deleting Email Address"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}})}showDeletePhoneNumberConfirmation(){if(!this.agentContactService.contactSubject.value||!this.agentContactService.selectedPhoneNumber)return;const e=this.agentContactService.selectedPhoneNumber;e&&this._dialog.open(en.a,{width:"500px",data:{title:`Delete ${e.phone_number}?`,buttonText:"Delete"}}).afterClosed().subscribe({next:t=>{t&&this._phoneNumberService.delete(e.id).subscribe({next:()=>{if(this.agentContactService.contactSubject.value){if(this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value._phone_numbers.length){const e=this.agentContactService.contactSubject.value._phone_numbers.findIndex(e=>e.id===this.agentContactService.selectedPhoneNumber.id);-1!==e&&this.agentContactService.contactSubject.value._phone_numbers.splice(e,1)}this.agentContactService.selectedPhoneNumber=this.agentContactService.contactSubject.value._phone_numbers.length?this.agentContactService.contactSubject.value._phone_numbers[0]:null,this._snackBar.open("Phone Number Deleted","X",{duration:2500,verticalPosition:"top",panelClass:"success"})}},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Deleting Phone Number"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(W.b),a.bc(k.a),a.bc(Y.b),a.bc(D.a),a.bc(Ht.a),a.bc(Lt.a),a.bc(C.a),a.bc(P.a),a.bc(tn.a),a.bc(r.a),a.bc(I.a),a.bc(u.a),a.bc(p.a),a.bc(s.a),a.bc(R.a),a.bc(nn.a),a.bc(q.a),a.bc(A.a),a.bc(m.a),a.bc(h.a),a.bc(b.a),a.bc(N),a.bc(f.a),a.bc(g.a),a.bc(d.a),a.bc(zt.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-contact"]],decls:71,vars:32,consts:[[1,"dyn-relative"],["class","dyn-p-20 dyn-text-center loading-contact",4,"ngIf"],[1,"dyn-flex","dyn-space-between","dyn-align-items","dashboard-contact-field-container"],[1,"dyn-flex"],[1,"dyn-m-r-10"],[2,"font-size",".7rem","min-width","157px","width","auto","max-width","270px",3,"ngModel","ngModelChange"],[4,"ngIf"],["matTooltip","You must have the 'click_to_call' permission to call this number",1,"dyn-inline-block",3,"matTooltipDisabled"],["mat-icon-button","","color","primary",3,"disabled","click"],["mat-icon-button","","color","",3,"disabled","mat-menu-trigger-for"],["phoneNumberMenu","matMenu"],["matTooltip","You must have the 'contacts_phone_number_write' permission to create a phone number",1,"dyn-full-width",3,"matTooltipDisabled"],["mat-menu-item","",3,"disabled","click"],[1,"dyn-full-width"],["matTooltip","You must have the 'contacts_phone_number_delete' permission to delete a phone number",1,"dyn-full-width",3,"matTooltipDisabled"],["class","dyn-flex dyn-text-muted dyn-text-xs-sm dyn-m-t-5 phone-number-icons",4,"ngIf"],["emailAddressMenu","matMenu"],["matTooltip","You must have the 'contacts_email_address_write' permission to create an email address",1,"dyn-full-width",3,"matTooltipDisabled"],["matTooltip","You must have the 'contacts_email_address_delete' permission to delete an email address",1,"dyn-full-width",3,"matTooltipDisabled"],["class","dyn-text-xs-sm dyn-text-muted dyn-m-t-5 email-icons",4,"ngIf"],[1,"dyn-m-t-10"],[1,"dyn-p-20","dyn-text-center","loading-contact"],[2,"position","absolute","left","50%","top","50%","transform","translate(-50%,-50%)"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"dyn-flex","dyn-text-muted","dyn-text-xs-sm","dyn-m-t-5","phone-number-icons"],[1,"dyn-vertical-middle"],["src","/assets/img/check-icon.svg","class","dyn-vertical-middle",4,"ngIf"],["src","/assets/img/cancel-icon.svg","class","dyn-vertical-middle",4,"ngIf"],["src","/assets/img/check-icon.svg",1,"dyn-vertical-middle"],["src","/assets/img/cancel-icon.svg",1,"dyn-vertical-middle"],[1,"dyn-text-xs-sm","dyn-text-muted","dyn-m-t-5","email-icons"],["mat-icon-button","","color","","matTooltip","Minimize Contact",3,"disabled","click"],["mat-icon-button","","color","",3,"mat-menu-trigger-for"],["agentDashMenu","matMenu"],["matTooltip","You must have the 'contacts_write_create' permission to create contacts",3,"matTooltipDisabled"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["class","dyn-text-right dyn-m-b-20 lower-section-control-btns",4,"ngIf"],["class","dyn-p-20","style","border-radius: 8px;border: 1px solid #ddd;",4,"ngIf"],["class","contact-lower-meta-section","style","display: grid;grid-gap: 5px 15px;grid-template-columns: repeat(auto-fit, minmax(49%, 1fr));",4,"ngIf"],[1,"dyn-text-right","dyn-m-b-20","lower-section-control-btns"],["class","dyn-m-r-10",3,"active","click",4,"ngIf"],[1,"dyn-m-r-10",3,"click"],[3,"click"],[1,"dyn-p-20",2,"border-radius","8px","border","1px solid #ddd"],["rows","10","placeholder","Enter a note",1,"dyn-full-width",2,"font-size",".9rem",3,"ngModel","ngModelChange"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10"],[1,"dyn-text-sm"],["mat-raised-button","","color","primary",3,"disabled","click"],["class","dyn-text-muted dyn-text-sm",4,"ngIf"],[1,"dyn-text-muted","dyn-text-sm"],["class","dyn-text-muted dyn-text-center dyn-p-20 dyn-border",4,"ngIf"],["class","agent-script simple-agent-script dyn-p-20 dyn-border-box","style","white-space: pre-wrap; overflow: auto;max-height: 550px;border-radius: 8px;border: 1px solid #ddd;",3,"innerHTML",4,"ngIf"],[1,"dyn-text-muted","dyn-text-center","dyn-p-20","dyn-border"],[1,"agent-script","simple-agent-script","dyn-p-20","dyn-border-box",2,"white-space","pre-wrap","overflow","auto","max-height","550px","border-radius","8px","border","1px solid #ddd",3,"innerHTML"],[1,"contact-lower-meta-section",2,"display","grid","grid-gap","5px 15px","grid-template-columns","repeat(auto-fit, minmax(49%, 1fr))"],[4,"ngFor","ngForOf"],["class","dyn-text-sm dyn-flex dyn-space-between dyn-align-items","style","border-bottom: 1px dashed #f1f1f1;",3,"ngClass",4,"ngIf"],[1,"dyn-text-sm","dyn-flex","dyn-space-between","dyn-align-items",2,"border-bottom","1px dashed #f1f1f1",3,"ngClass"],[1,"dyn-text-muted","dyn-full-width"],["class","dyn-full-width",4,"ngIf"],["class","dyn-text-xs-sm dyn-text-right",4,"ngIf"],[1,"dyn-text-xs-sm","dyn-text-right"],["type","text",1,"dyn-full-width",3,"disabled","readOnly","ngModel","required","ngModelChange"],["matTooltip","You must have the 'contacts_write_update_owner' permission to update the owned by field",3,"matTooltipDisabled"],[1,"dyn-full-width",3,"ngModel","disabled","ngModelChange"],[3,"ngValue",4,"ngIf"],["type","text",1,"dyn-full-width",3,"disabled","readOnly","owlDateTime","owlDateTimeTrigger","ngModel","required","ngModelChange"],["hour12Timer","true",3,"disabled"],["dt1",""],["type","text",1,"dyn-full-width",3,"disabled","readOnly","ngModel","owlDateTime","owlDateTimeTrigger","required","ngModelChange"],["hour12Timer","true",3,"disabled","pickerType"],["dt2",""],["type","number","min","0",1,"dyn-full-width",3,"disabled","readOnly","ngModel","required","ngModelChange"],[2,"height","28px"],["color","primary",1,"example-margin",3,"disabled","ngModel","checked","ngModelChange"]],template:function(e,t){if(1&e&&(a.ic(0,"div",0),a.bd(1,yc,4,0,"div",1),a.ic(2,"div",2),a.ic(3,"div",3),a.ic(4,"div",4),a.ic(5,"label"),a.dd(6,"Phone Numbers"),a.hc(),a.dc(7,"br"),a.ic(8,"select",5),a.qc("ngModelChange",(function(e){return t.agentContactService.selectedPhoneNumber=e})),a.bd(9,Pc,2,1,"ng-container",6),a.hc(),a.ic(10,"div",7),a.ic(11,"button",8),a.qc("click",(function(){return t.clickToCall()})),a.ic(12,"mat-icon"),a.dd(13,"phone"),a.hc(),a.hc(),a.hc(),a.ic(14,"button",9),a.ic(15,"mat-icon"),a.dd(16,"expand_more"),a.hc(),a.hc(),a.ic(17,"mat-menu",null,10),a.ic(19,"div",11),a.ic(20,"button",12),a.qc("click",(function(){return t.showCreatePhoneNumberDialog()})),a.ic(21,"mat-icon"),a.dd(22,"add"),a.hc(),a.dd(23," Add "),a.hc(),a.hc(),a.ic(24,"div",13),a.ic(25,"button",12),a.qc("click",(function(){return t.copyToClipboard(t.agentContactService.selectedPhoneNumber.phone_number)})),a.ic(26,"mat-icon"),a.dd(27,"assignment"),a.hc(),a.dd(28," Copy to Clipboard "),a.hc(),a.hc(),a.ic(29,"div",14),a.ic(30,"button",12),a.qc("click",(function(){return t.showDeletePhoneNumberConfirmation()})),a.ic(31,"mat-icon"),a.dd(32,"delete"),a.hc(),a.dd(33," Delete "),a.hc(),a.hc(),a.hc(),a.bd(34,Tc,21,8,"div",15),a.hc(),a.ic(35,"div"),a.ic(36,"label"),a.dd(37,"Emails"),a.hc(),a.dc(38,"br"),a.ic(39,"select",5),a.qc("ngModelChange",(function(e){return t.agentContactService.selectedEmailAddress=e})),a.bd(40,Oc,2,1,"ng-container",6),a.hc(),a.ic(41,"button",8),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("email")})),a.ic(42,"mat-icon"),a.dd(43,"mail"),a.hc(),a.hc(),a.ic(44,"button",9),a.ic(45,"mat-icon"),a.dd(46,"expand_more"),a.hc(),a.hc(),a.ic(47,"mat-menu",null,16),a.ic(49,"div",17),a.ic(50,"button",12),a.qc("click",(function(){return t.showCreateEmailDialog()})),a.ic(51,"mat-icon"),a.dd(52,"add"),a.hc(),a.dd(53," Add "),a.hc(),a.hc(),a.ic(54,"div",13),a.ic(55,"button",12),a.qc("click",(function(){return t.copyToClipboard(t.agentContactService.selectedEmailAddress.email)})),a.ic(56,"mat-icon"),a.dd(57,"assignment"),a.hc(),a.dd(58," Copy to Clipboard "),a.hc(),a.hc(),a.ic(59,"div",18),a.ic(60,"button",12),a.qc("click",(function(){return t.showDeleteEmailConfirmation()})),a.ic(61,"mat-icon"),a.dd(62,"delete"),a.hc(),a.dd(63," Delete "),a.hc(),a.hc(),a.hc(),a.bd(64,$c,5,2,"div",19),a.hc(),a.hc(),a.bd(65,Ac,15,5,"div",6),a.hc(),a.dc(66,"hr",20),a.ic(67,"div"),a.bd(68,Qc,1,0,"custom-contact-form",6),a.bd(69,Rc,1,0,"default-contact-form",6),a.hc(),a.bd(70,Sa,7,7,"ng-container",6),a.hc()),2&e){const e=a.Mc(18),n=a.Mc(48);a.Pb(1),a.Bc("ngIf",!0===t.agentContactService.loading.value),a.Pb(7),a.Bc("ngModel",t.agentContactService.selectedPhoneNumber),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("click_to_call")),a.Pb(1),a.Bc("disabled",!t.agentContactService.selectedPhoneNumber||t.agentContactService.contactSubject.value&&t.agentContactService.contactSubject.value._phone_numbers&&!t.agentContactService.contactSubject.value._phone_numbers.length||!t.permissionService.hasPermission("click_to_call")),a.Pb(3),a.Bc("disabled",!t.agentContactService.contactSubject.value)("mat-menu-trigger-for",e),a.Pb(5),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_phone_number_write")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_phone_number_write")),a.Pb(5),a.Bc("disabled",!t.agentContactService.selectedPhoneNumber),a.Pb(4),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_phone_number_delete")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_phone_number_delete")||!t.agentContactService.selectedPhoneNumber),a.Pb(4),a.Bc("ngIf",t.agentContactService.selectedPhoneNumber&&t.agentContactService.contactSubject.value&&t.agentContactService.contactSubject.value.id),a.Pb(5),a.Bc("ngModel",t.agentContactService.selectedEmailAddress),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("disabled",!t.agentContactService.selectedEmailAddress),a.Pb(3),a.Bc("disabled",!t.agentContactService.contactSubject.value)("mat-menu-trigger-for",n),a.Pb(5),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_email_address_write")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_email_address_write")),a.Pb(5),a.Bc("disabled",!t.agentContactService.selectedEmailAddress),a.Pb(4),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_email_address_delete")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_email_address_delete")||!t.agentContactService.selectedEmailAddress),a.Pb(4),a.Bc("ngIf",t.agentContactService.selectedEmailAddress&&t.agentContactService.contactSubject.value&&t.agentContactService.contactSubject.value.id),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value&&null!==t.agentContactService.contactSubject.value),a.Pb(1),a.Tb("dyn-m-b-0",t.agentDashboardSettingsService.showCustomDashboardSettings)("dyn-m-b-10",!t.agentDashboardSettingsService.showCustomDashboardSettings),a.Pb(2),a.Bc("ngIf",t.agentDashboardSettingsService.showCustomDashboardSettings),a.Pb(1),a.Bc("ngIf",!t.agentDashboardSettingsService.showCustomDashboardSettings),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value)}},directives:[J.p,te.y,te.p,te.s,ue.a,le.b,ge.a,cn.e,cn.f,cn.c,fe.a,J.o,te.t,te.A,zn,mi,Ai,te.d,_c,J.n,te.x,on.b,on.d,on.a,te.u,rn.a],pipes:[Ri.a,J.f,J.y],styles:[".loading-contact{background:hsla(0,0%,100%,.7098039215686275);position:absolute;left:0;top:0;width:100%;height:100%;z-index:9;box-sizing:border-box}.dash-grid-element select{width:100%}#mobile-contact-actions{display:none}.connector-button{overflow:hidden}.connector-button[disabled]{background:#c5c5c5!important}.lower-section-control-btns button{background:none;border-radius:100px;border:1px solid rgba(41,121,255,.2196078431372549);padding:5px 15px;cursor:pointer;outline:none;font-size:.8rem;transition:.3s}.lower-section-control-btns button:hover{background:rgba(41,121,255,.10980392156862745);border:1px solid #2d67ff}.lower-section-control-btns button.active{background:#2d67ff;color:#fff}#contact-details #contact-details-bottom #recent-activity .recent-activity-list{border:1px solid #eaedf0;background:#fafafa}#contact-details #contact-details-bottom #recent-activity .recent-activity-list .recent-activity-block:not(:last-child){border-bottom:1px solid #eaedf0}#contact-details #contact-details-bottom #recent-activity .recent-activity-list .recent-activity-block .timestamp{position:absolute;right:0;top:0;font-size:.8rem}#contact-details #contact-details-bottom #recent-activity .recent-activity-list .recent-activity-block .activity-message{font-size:.9rem;color:#b7b7b7}#contact-details #contact-details-bottom #recent-activity .recent-activity-list .recent-activity-block .activity-message span{color:#000}#contact-details #contact-details-bottom #notes{font-size:.9rem}#contact-details #contact-details-bottom #notes .contact-note{background:#4fc9b7;color:#fff;padding:10px 20px;border-radius:20px 20px 20px 0;display:inline-block}#contact-details #contact-details-bottom #notes .contact-note p{margin:0}#contact-details #contact-details-bottom #notes .note-info{font-size:.8rem;opacity:.5;margin-top:5px}#contact-details #contact-details-bottom #calendar-events .calendar-event{background:#ddd}.dash-grid-container{display:grid;width:100%;grid-gap:5px 10px;grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}.dash-grid-container .dash-grid-element input{width:100%!important}.email-icons span,.phone-number-icons span{font-size:.65rem;color:#000}.email-icons img,.phone-number-icons img{height:12px;margin-left:2px}.email-icons div,.phone-number-icons div{margin-right:5px}@media (max-width:1250px){#contact-details #contact-details-bottom{flex-direction:column-reverse!important}#contact-details #contact-details-bottom #create-note{margin-top:20px}.mat-tab-label{padding:0!important;min-width:110px!important}}@media (max-width:1000px){.agent-dash-bottom{flex-direction:column}}#dashboard-nav-tabs button{background:#e1e5e8;color:#8baadc;font-size:1rem;margin:0 2px;padding:6px 20px;z-index:0;border-radius:6px 6px 0 0;opacity:.6}#dashboard-nav-tabs button span{font-size:.8rem}#dashboard-nav-tabs button:first-child{margin-left:0}#dashboard-nav-tabs button.active{background:#fff;color:#2979ff;z-index:9;opacity:1}@media (max-width:1265px){#dashboard-nav-tabs button{margin:0 1px;padding:3px 12px}#dashboard-nav-tabs button span{font-size:.7rem!important}}@media (max-width:1155px){#dashboard-nav-tabs button{margin:0 1px;padding:3px 7px}#dashboard-nav-tabs button span{font-size:.6rem!important}}"],encapsulation:2}),e})();var ya=n("Zj+O"),Ca=n("rryV"),Pa=n("Bbhl"),wa=n("HWDN"),Ma=n("Pgd8"),xa=n("hH3I"),Ba=n("A5z7");const ka=["fileInput"],Fa=["smsConversationContainer"];function Ia(e,t){1&e&&(a.ic(0,"div"),a.dc(1,"mat-progress-spinner",4),a.hc())}function Da(e,t){1&e&&(a.ic(0,"div",5),a.dd(1," No Contact Selected\n"),a.hc())}function Ta(e,t){1&e&&(a.ic(0,"div"),a.dc(1,"mat-progress-spinner",32),a.dd(2," Loading... "),a.hc())}function ja(e,t){1&e&&(a.ic(0,"div",34),a.dd(1,"No SMS messages to show"),a.hc())}function Oa(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.ed(e.body)}}function Na(e,t){if(1&e&&(a.ic(0,"div",40),a.dc(1,"div",41),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("innerHtml",e.body,a.Rc)}}const qa=function(e){return{"dyn-text-right":e}},$a=function(e){return{inbound:e}};function Ea(e,t){if(1&e&&(a.ic(0,"div",20),a.ic(1,"div",36),a.ic(2,"div",37),a.dd(3),a.hc(),a.ic(4,"div",38),a.bd(5,Oa,2,1,"div",1),a.bd(6,Na,2,1,"div",39),a.ic(7,"div",37),a.dd(8),a.vc(9,"date"),a.hc(),a.hc(),a.hc(),a.hc()),2&e){const e=t.$implicit;a.Bc("ngClass",a.Gc(10,qa,!e.inbound)),a.Pb(3),a.ed(e.source),a.Pb(1),a.Bc("ngClass",a.Gc(12,$a,e.inbound)),a.Pb(1),a.Bc("ngIf",!e.mms),a.Pb(1),a.Bc("ngIf",e.mms),a.Pb(2),a.gd(" ",e.inbound?"Received: ":"Sent: "," ",a.xc(9,7,e.created_on,"MM/d/y, h:mm a")," ")}}function Aa(e,t){if(1&e&&(a.ic(0,"div"),a.bd(1,Ea,10,14,"div",35),a.hc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngForOf",e.smsMessages)}}function Qa(e,t){if(1&e&&(a.gc(0),a.bd(1,ja,2,0,"div",33),a.bd(2,Aa,2,1,"div",1),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",!e.smsMessages.length),a.Pb(1),a.Bc("ngIf",e.smsMessages.length)}}function Ra(e,t){if(1&e){const e=a.kc();a.ic(0,"button",45),a.qc("click",(function(){return a.Qc(e),a.uc(3).endConversation()})),a.dd(1," End Conversation "),a.hc()}}function Ua(e,t){1&e&&(a.ic(0,"span",46),a.dd(1,"Conversation Ended"),a.hc())}function Va(e,t){if(1&e&&(a.ic(0,"div",42),a.bd(1,Ra,2,0,"button",43),a.bd(2,Ua,2,0,"span",44),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",e.conversation.active),a.Pb(1),a.Bc("ngIf",!e.conversation.active)}}function Wa(e,t){if(1&e&&(a.ic(0,"option",48),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(3);a.Bc("disabled",!e.is_mobile)("ngValue",e),a.Pb(1),a.hd(" ",e.contact_field&&n.agentContactFieldService.contactFieldMap[e.contact_field]&&n.agentContactFieldService.contactFieldMap[e.contact_field].label?n.agentContactFieldService.contactFieldMap[e.contact_field].label+" - ":""," ",e.phone_number," ",e.is_mobile?e.do_not_sms?"(Do Not SMS)":"":"(Not Mobile)"," ")}}function za(e,t){if(1&e&&(a.gc(0),a.bd(1,Wa,2,5,"option",47),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngForOf",e.agentContactService.contactSubject.value._phone_numbers)}}function Ha(e,t){1&e&&a.dc(0,"img",54)}function La(e,t){1&e&&a.dc(0,"img",55)}function Xa(e,t){1&e&&a.dc(0,"img",54)}function Ga(e,t){1&e&&a.dc(0,"img",55)}function Ya(e,t){1&e&&a.dc(0,"img",54)}function Ja(e,t){1&e&&a.dc(0,"img",55)}function Za(e,t){1&e&&a.dc(0,"img",54)}function Ka(e,t){1&e&&a.dc(0,"img",55)}function eo(e,t){if(1&e&&(a.ic(0,"div",49),a.ic(1,"div",50),a.ic(2,"span",51),a.dd(3,"DNC:"),a.hc(),a.bd(4,Ha,1,0,"img",52),a.bd(5,La,1,0,"img",53),a.hc(),a.ic(6,"div",50),a.ic(7,"span",51),a.dd(8,"FDNC:"),a.hc(),a.bd(9,Xa,1,0,"img",52),a.bd(10,Ga,1,0,"img",53),a.hc(),a.ic(11,"div",50),a.ic(12,"span",51),a.dd(13,"Do Not SMS:"),a.hc(),a.bd(14,Ya,1,0,"img",52),a.bd(15,Ja,1,0,"img",53),a.hc(),a.ic(16,"div"),a.ic(17,"span",51),a.dd(18,"Mobile:"),a.hc(),a.bd(19,Za,1,0,"img",52),a.bd(20,Ka,1,0,"img",53),a.hc(),a.hc()),2&e){const e=a.uc(2);a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.do_not_contact),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.do_not_contact),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.is_fdnc),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.is_fdnc),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.do_not_sms),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.do_not_sms),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber.is_mobile),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedPhoneNumber.is_mobile)}}function to(e,t){if(1&e&&(a.ic(0,"option",56),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.id),a.Pb(1),a.ed(e.name)}}function no(e,t){1&e&&(a.ic(0,"span",50),a.dd(1," *messages over 160 characters will be billed as multiple messages "),a.hc())}function io(e,t){if(1&e&&(a.gc(0),a.dd(1),a.vc(2,"slice"),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.fd(" ",e.name.length>22?a.yc(2,1,e.name,0,22)+"..":e.name," ")}}function co(e,t){if(1&e){const e=a.kc();a.ic(0,"mat-chip",57),a.qc("removed",(function(){a.Qc(e);const n=t.index;return a.uc(2).attachedFiles.splice(n,1)})),a.bd(1,io,3,5,"ng-container",1),a.ic(2,"mat-icon",58),a.dd(3,"cancel"),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e&&e.name)}}function ao(e,t){if(1&e){const e=a.kc();a.ic(0,"button",29),a.qc("click",(function(){a.Qc(e);const t=a.uc(2);return t.onSendSmsClick(!1),t.showCallButton=!0})),a.dd(1,"SMS + Call"),a.hc()}if(2&e){const e=a.uc(2);a.Bc("disabled",e.loading||!e.agentContactService.selectedPhoneNumber||e.agentContactService.selectedPhoneNumber&&e.agentContactService.selectedPhoneNumber.do_not_sms||e.agentContactService.contactSubject.value&&e.agentContactService.contactSubject.value._phone_numbers&&!e.agentContactService.contactSubject.value._phone_numbers.length)}}function oo(e,t){if(1&e){const e=a.kc();a.ic(0,"button",59),a.qc("click",(function(){a.Qc(e);const t=a.uc(2);return t.webPhoneSessionsService.call(t.agentContactService.selectedPhoneNumber.phone_number,t.agentContactService.contactSubject.value.id)})),a.ic(1,"mat-icon"),a.dd(2,"call"),a.hc(),a.dd(3),a.hc()}if(2&e){const e=a.uc(2);a.Bc("disabled",e.callingContact),a.Pb(3),a.fd(" ",e.callingContact?"Calling...":"Call"," ")}}function so(e,t){if(1&e){const e=a.kc();a.ic(0,"button",61),a.qc("click",(function(){return a.Qc(e),a.uc(3).onSendSmsClick(!0)})),a.dd(1," Send SMS & Next "),a.ic(2,"mat-icon"),a.dd(3,"chevron_right"),a.hc(),a.hc()}if(2&e){const e=a.uc(3);a.Bc("disabled",e.agentPostCallService.selectedCall.value&&e.agentPostCallService.selectedCall.value.forcePostCall||e.agentContactService.loading.value||!e.agentStatusService.agentStatusSubject.value||!e.agentStatusService.agentStatusSubject.value.campaign||!e.agentContactService.contactSubject.value)}}function ro(e,t){if(1&e&&(a.gc(0),a.bd(1,so,4,1,"button",60),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].sms_next_visible)}}function lo(e,t){1&e&&(a.ic(0,"p",62),a.dd(1," This number is not a mobile number "),a.hc())}function uo(e,t){1&e&&(a.ic(0,"p",62),a.dd(1," This number is set to Do Not SMS "),a.hc())}const go=function(e){return{"dyn-error":e}};function ho(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",6,7),a.bd(3,Ta,3,0,"div",1),a.bd(4,Qa,3,2,"ng-container",1),a.hc(),a.bd(5,Va,3,2,"div",8),a.dc(6,"hr"),a.ic(7,"div",9),a.ic(8,"div",10),a.ic(9,"div",11),a.ic(10,"label"),a.dd(11,"Send To:"),a.hc(),a.dc(12,"br"),a.ic(13,"select",12),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().agentContactService.selectedPhoneNumber=t})),a.bd(14,za,2,1,"ng-container",1),a.hc(),a.bd(15,eo,21,8,"div",13),a.hc(),a.ic(16,"div"),a.ic(17,"label"),a.dd(18,"SMS Templates"),a.hc(),a.dc(19,"br"),a.ic(20,"select",12),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().selectedSmsScript=t}))("ngModelChange",(function(){return a.Qc(e),a.uc().onScriptSelected()})),a.dc(21,"option",14),a.bd(22,to,2,2,"option",15),a.hc(),a.hc(),a.hc(),a.ic(23,"div",16),a.ic(24,"textarea",17),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().smsInput=t})),a.hc(),a.ic(25,"div",18),a.bd(26,no,2,0,"span",19),a.ic(27,"span",20),a.dd(28),a.hc(),a.dd(29,"/160 "),a.hc(),a.ic(30,"div",21),a.ic(31,"div"),a.ic(32,"input",22,23),a.qc("change",(function(t){return a.Qc(e),a.uc().handleFileSelect(t.target.files)})),a.hc(),a.ic(34,"div",24),a.ic(35,"button",25),a.qc("click",(function(){return a.Qc(e),a.Mc(33).click()})),a.ic(36,"mat-icon"),a.dd(37,"attach_file"),a.hc(),a.hc(),a.ic(38,"mat-chip-list"),a.bd(39,co,4,1,"mat-chip",26),a.hc(),a.hc(),a.hc(),a.ic(40,"div"),a.bd(41,ao,2,1,"button",27),a.bd(42,oo,4,2,"button",28),a.ic(43,"button",29),a.qc("click",(function(){return a.Qc(e),a.uc().onSendSmsClick(!1)})),a.dd(44,"Send"),a.hc(),a.bd(45,ro,2,1,"ng-container",1),a.hc(),a.hc(),a.ic(46,"div",30),a.bd(47,lo,2,0,"p",31),a.bd(48,uo,2,0,"p",31),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc();a.Pb(3),a.Bc("ngIf",e.loading),a.Pb(1),a.Bc("ngIf",!e.loading),a.Pb(1),a.Bc("ngIf",e.conversation),a.Pb(8),a.Bc("ngModel",e.agentContactService.selectedPhoneNumber),a.Pb(1),a.Bc("ngIf",e.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber),a.Pb(5),a.Bc("ngModel",e.selectedSmsScript),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",e.smsScripts),a.Pb(2),a.Bc("ngModel",e.smsInput),a.Pb(2),a.Bc("ngIf",e.smsInput.length>160),a.Pb(1),a.Bc("ngClass",a.Gc(20,go,e.smsInput.length>160)),a.Pb(1),a.ed(e.smsInput.length),a.Pb(11),a.Bc("ngForOf",e.attachedFiles),a.Pb(2),a.Bc("ngIf",!e.showCallButton&&e.showSmsCallComboButton),a.Pb(1),a.Bc("ngIf",e.showCallButton),a.Pb(1),a.Bc("disabled",e.sendingSms||!e.agentContactService.selectedPhoneNumber||e.agentContactService.selectedPhoneNumber&&e.agentContactService.selectedPhoneNumber.do_not_sms||e.agentContactService.contactSubject.value&&e.agentContactService.contactSubject.value._phone_numbers&&!e.agentContactService.contactSubject.value._phone_numbers.length),a.Pb(2),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]),a.Pb(2),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber&&!e.agentContactService.selectedPhoneNumber.is_mobile),a.Pb(1),a.Bc("ngIf",e.agentContactService.selectedPhoneNumber&&e.agentContactService.selectedPhoneNumber.do_not_sms&&e.agentContactService.selectedPhoneNumber.is_mobile)}}let bo=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p,v,m,f,S){this.agentContactService=e,this.agentContactFieldService=t,this.agentPostCallService=n,this.agentCampaignService=i,this.webPhoneSessionsService=c,this.datePipe=a,this.snackBar=o,this.fileSystemFileService=s,this.conversationFileService=r,this.agentNavService=d,this.contactSmsService=l,this.smsTemplateService=u,this.authService=g,this.agentUserService=h,this.agentStatusService=b,this.callerIdService=p,this.agentAccountSettingsService=v,this.contactConversationService=m,this.agentAccountSettingService=f,this.utils=S,this.sendingSms=!1,this.smsMessages=[],this.smsScripts=[],this.selectedSmsScript=null,this.smsInput="",this.loading=!1,this.callingContact=!1,this.showCallButton=!1,this.showSmsCallComboButton=!1,this.attachedFiles=[],this.smsAudio=new Audio}ngOnInit(){$.listen(e=>{if("incoming_sms"===e.method&&this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id===e.contact_id)if("sms"===this.agentNavService.activeDashboardSectionSubject.value){let t={id:e.sms_id,caller_id:e.caller_id,account_id:e.account_id,app_user:e.app_user,contact:e.contact_id,mms:e.mms,source:e.source,destination:e.destination,body:e.body,inbound:"incoming_sms"===e.method,inbound_route:e.inbound_route,campaign:e.campaign?e.campaign:null,created_on:(new Date).toISOString()};e.mms?this._getIncomingMMSMessage(t):this.smsMessages.push(t),this.conversation&&(this.conversation.active||this._getConversation(),this._setConversationUnreadFalse(),setTimeout(()=>{this._scrollSmsContainerToBottom()},100))}else this.agentNavService.showAgentDashboardSmsAlert=!0}),this.agentNavSubscription=this.agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{"sms"===e&&(this.agentNavService.showAgentDashboardSmsAlert=!1,this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id&&(this._getSmsMessages(),this._getSmsScripts()))}}),this.agentContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{this.cachedSmsCallerId=null,this.showCallButton=!1,this.agentNavService.showAgentDashboardSmsAlert&&(this.agentNavService.showAgentDashboardSmsAlert=!1),e&&e.id&&"sms"===this.agentNavService.activeDashboardSectionSubject.value&&(this._getSmsMessages(),this._getSmsScripts(),this.selectedSmsScript?this._renderSmsScript():this.smsInput="")}}),this.agentAccountSettingService.accountSettingsSubject.subscribe({next:e=>{this.accountSettings=e,this._checkIfSmsCallComboButtonVisible()}}),this.agentStatusService.agentStatusSubject.subscribe({next:e=>{e&&this._checkIfSmsCallComboButtonVisible()}})}ngOnDestroy(){this.agentNavSubscription.unsubscribe(),this.agentContactSubscription.unsubscribe()}endConversation(){this.contactConversationService.update(this.agentContactService.contactSubject.value.id,{active:!1}).subscribe({next:e=>{this.conversation=e,this.snackBar.open("Conversation Updated","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})}})}handleFileSelect(e){e[0]&&this.attachedFiles.push(e[0])}onScriptSelected(){this._renderSmsScript()}onSendSmsClick(e){if(this.agentContactService.selectedPhoneNumber)if(this.agentContactService.selectedPhoneNumber.is_mobile)if(this.smsInput||this.attachedFiles.length)if(this.sendingSms=!0,this.attachedFiles.length){let t=[];this.attachedFiles.forEach(n=>{const i=new FormData;i.append("file",n),this.fileSystemFileService.upload(i).subscribe({next:n=>{t.push(n.id),t.length===this.attachedFiles.length&&this._formatSmsMessage(e,t)},error:e=>{this.loading=!1,this.snackBar.open(this.utils.handleErrorResponse(e,"Error Uploading File"),"X",{duration:3e3,verticalPosition:"top",panelClass:"error"})}})})}else this._formatSmsMessage(e);else this.snackBar.open("Enter a message body","X",{duration:2500,verticalPosition:"top",panelClass:["error"]});else this.snackBar.open("Phone number is not a mobile number","X",{duration:2500,verticalPosition:"top",panelClass:["error"]})}_addMessageToFeed(e,t){["image/png","image/jpeg","image/jpg","image/svg"].includes(e.mime_type)?this.smsMessages[t].body+=`<div><a href="${e.file_url}" target="_blank"><img src="${e.file_url}"></a></div>`:"text/vcard"===e.mime_type&&(this.smsMessages[t].body+=`\n\t\t\t\t<div><a href="${e.file_url}" target="_blank" class="dyn-text-white">\n\t\t\t\t<img src="/assets/img/vcard-icon.svg" height="20px"> Download</a>\n\t\t\t\t</div>`),setTimeout(()=>{this._scrollSmsContainerToBottom()},300)}_formatSmsMessage(e,t){if(!this.agentContactService.selectedPhoneNumber)return void this.snackBar.open("Please select a phone number","X",{duration:2500,verticalPosition:"top",panelClass:"error"});const n=!!t;this.cachedSmsCallerId?this._sendSms(e,t):this._getCallerId(n).subscribe({next:n=>{n.results.length?(this.cachedSmsCallerId=n.results[0].phone_number,this._sendSms(e,t)):(this.loading=!1,this.sendingSms=!1,this.snackBar.open("No SMS enabled caller IDs found that are under the daily max messages limit","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}))}})}_getIncomingMMSMessage(e){this.conversationFileService.getBySmsId(e.id).subscribe({next:t=>{t.results.forEach(t=>{t.fsfile_id&&this.fileSystemFileService.get(t.fsfile_id).subscribe({next:t=>{this.smsMessages.push(e);const n=this.smsMessages.findIndex(t=>t.id===e.id);this._addMessageToFeed(t,n)},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Getting File"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})})},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Receiving SMS"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}_resetFileInput(){this.fileInput&&(this.fileInput.nativeElement.value=null)}_checkIfSmsCallComboButtonVisible(){this.showSmsCallComboButton=this.agentCampaignService.campaignMap.length&&this.agentStatusService.agentStatusSubject.value&&this.agentStatusService.agentStatusSubject.value.campaign&&this.agentCampaignService.campaignMap[this.agentStatusService.agentStatusSubject.value.campaign]?this.agentCampaignService.campaignMap[this.agentStatusService.agentStatusSubject.value.campaign].sms_call_combo_visible:!!this.accountSettings&&this.accountSettings.sms_call_combo_visible}_getSmsMessages(){this.loading=!0,this.smsMessages=[],this.contactSmsService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.loading=!1,this.smsMessages=e.results,e.results.forEach(e=>{e.mms&&this.conversationFileService.getBySmsId(e.id).subscribe({next:t=>{t.results.forEach(t=>{t.fsfile_id&&this.fileSystemFileService.get(t.fsfile_id).subscribe({next:t=>{const n=this.smsMessages.findIndex(t=>t.id===e.id);-1!==n&&this._addMessageToFeed(t,n)}})})}})}),this.smsMessages.length&&(this._getConversation(),setTimeout(()=>{this._scrollSmsContainerToBottom()},100))}})}_getCallerId(e){return this.callerIdService.getByDestination(this.agentContactService.selectedPhoneNumber.phone_number,this.agentContactService.contactSubject.value.id,this.agentStatusService.agentStatusSubject.value?this.agentStatusService.agentStatusSubject.value.campaign:null,!e,e)}_getConversation(){this.contactConversationService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.conversation=e,this.conversation.unread&&this._setConversationUnreadFalse()}})}_getSmsScripts(){this.smsTemplateService.list("max").subscribe({next:e=>{this.smsScripts=e.results}})}_renderSmsScript(){if(!this.selectedSmsScript)return;let e=this.smsScripts.find(e=>e.id==this.selectedSmsScript).body;const t=e.match(/[^{]+(?=\})/g),n=e.match(/[^<]+(?=\>)/g);let i=[],c=[];const a=JSON.parse(JSON.stringify(this.agentContactService.contactSubject.value));a&&this.agentContactFieldService.contactFieldSubject.subscribe({next:e=>{e.forEach(e=>{if(t&&t.includes(e.name))if("Date"===e.data_type&&a[e.name]){const t=a[e.name].split("T");a[e.name]=t[0]}else if("Date Time"===e.data_type&&a[e.name]){a[e.name]=this.datePipe.transform(a[e.name],"yyyy-MM-dd, h:mm a");const t="long",n=(new Date).toLocaleDateString(void 0,{day:"2-digit",timeZoneName:t}).substring(4);a[e.name]+=" ("+n+")"}})}}),t&&(t.forEach(e=>{a[e]&&(i[e]=a[e])}),t.forEach(t=>{e=e.split("{"+t+"}").join(i[t]?i[t]:"__")})),n&&(n.forEach(e=>{this.agentUserService.user.custom_settings[e]?c[e]=this.agentUserService.user.custom_settings[e]:this.agentAccountSettingsService.accountSettings.custom_settings[e]&&(c[e]=this.agentAccountSettingsService.accountSettings.custom_settings[e])}),n.forEach(t=>{e=e.split("<"+t+">").join(c[t]?c[t]:"__")})),this.smsInput=e}_sendSms(e,t){if(!this.agentContactService.selectedPhoneNumber)return void this.snackBar.open("No Phone Number Selected","",{duration:3e3,verticalPosition:"top",panelClass:"error"});const n=this.smsInput,i=this.agentContactService.contactSubject.value.id,c=this.agentContactService.selectedPhoneNumber.phone_number,a=this.cachedSmsCallerId,o=this.agentStatusService.agentStatusSubject.value?this.agentStatusService.agentStatusSubject.value.campaign:null,s=this.authService.getUserId();this.contactSmsService.create({contact:i,destination:c,source:a,body:n,app_user:s,campaign:o,mms_fsfiles:t||void 0}).subscribe({next:t=>{this.smsInput="",this.attachedFiles=[],this._resetFileInput(),this.smsAudio.src="/assets/audio/sms/outgoing-sms.wav",this.smsAudio.play().catch(()=>{}),setTimeout(()=>{this.sendingSms=!1},4e3),e?this.agentContactService.getNextContact():(this.smsMessages.push(t),t.mms&&this.conversationFileService.getBySmsId(t.id).subscribe({next:e=>{e.results.forEach(e=>{e.fsfile_id&&this.fileSystemFileService.get(e.fsfile_id).subscribe({next:e=>{const n=this.smsMessages.findIndex(e=>e.id===t.id);-1!==n&&this._addMessageToFeed(e,n)}})})}})),setTimeout(()=>{this._scrollSmsContainerToBottom()},100),this.snackBar.open("SMS Sent","",{duration:3e3,verticalPosition:"top",panelClass:["success"]})},error:e=>{this.sendingSms=!1,this.loading=!1,this.snackBar.open(this.utils.handleErrorResponse(e,"Error Sending SMS"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}_setConversationUnreadFalse(){this.contactConversationService.update(this.agentContactService.contactSubject.value.id,{unread:!1}).subscribe()}_scrollSmsContainerToBottom(){try{this.smsConversationContainer.nativeElement.scrollTop=this.smsConversationContainer.nativeElement.scrollHeight}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(f.a),a.bc(h.a),a.bc(v.a),a.bc(l.a),a.bc(C.a),a.bc(J.f),a.bc(k.a),a.bc(wa.a),a.bc(Pa.a),a.bc(d.a),a.bc(Ma.a),a.bc(ya.a),a.bc(r.a),a.bc(g.a),a.bc(p.a),a.bc(Ca.a),a.bc(P.a),a.bc(xa.a),a.bc(P.a),a.bc(D.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-sms"]],viewQuery:function(e,t){var n;1&e&&(a.jd(ka,!0),a.jd(Fa,!0)),2&e&&(a.Lc(n=a.rc())&&(t.fileInput=n.first),a.Lc(n=a.rc())&&(t.smsConversationContainer=n.first))},features:[a.Ob([J.f])],decls:7,vars:3,consts:[[1,"dyn-flex","dyn-space-between","dyn-align-items"],[4,"ngIf"],[1,"dyn-m-t-0"],["class","dyn-bg-grey dyn-p-20 dyn-text-muted",4,"ngIf"],["diameter","30","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-bg-grey","dyn-p-20","dyn-text-muted"],[1,"conversation-window","dyn-bg-grey","dyn-p-20","dyn-m-t-10"],["smsConversationContainer",""],["class","dyn-text-center dyn-m-t-10",4,"ngIf"],[1,"dyn-m-t-20"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-m-r-20"],[3,"ngModel","ngModelChange"],["class","dyn-flex dyn-text-muted dyn-text-xs-sm dyn-m-t-5",4,"ngIf"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],[1,"dyn-m-t-10"],["placeholder","Message","rows","10",1,"dyn-full-width",3,"ngModel","ngModelChange"],[1,"dyn-text-right","dyn-text-sm"],["class","dyn-m-r-10",4,"ngIf"],[3,"ngClass"],[1,"dyn-flex","dyn-space-between","dyn-align-items","dyn-m-t-10"],["type","file","accept","image/x-png,image/gif,image/jpeg",2,"display","none",3,"change"],["fileInput",""],[1,"dyn-flex"],["mat-mini-fab","","color","","matTooltip","Attach Files",1,"dyn-no-shadow","dyn-m-r-10",3,"click"],["removable","",3,"removed",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","class","dyn-m-r-10",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent","class","dyn-m-r-10",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"dyn-m-r-10",3,"disabled","click"],[1,"dyn-text-right"],["class","dyn-error dyn-inline-block dyn-m-r-10",4,"ngIf"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],["class","dyn-text-muted",4,"ngIf"],[1,"dyn-text-muted"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"dyn-m-t-5"],[1,"dyn-text-muted","dyn-text-xs-sm"],[1,"sms-bubble",3,"ngClass"],["class","dyn-relative dyn-cursor-pointer",4,"ngIf"],[1,"dyn-relative","dyn-cursor-pointer"],[3,"innerHtml"],[1,"dyn-text-center","dyn-m-t-10"],["mat-stroked-button","","color","",3,"click",4,"ngIf"],["class","dyn-text-muted dyn-m-t-10 dyn-inline-block",4,"ngIf"],["mat-stroked-button","","color","",3,"click"],[1,"dyn-text-muted","dyn-m-t-10","dyn-inline-block"],[3,"disabled","ngValue",4,"ngFor","ngForOf"],[3,"disabled","ngValue"],[1,"dyn-flex","dyn-text-muted","dyn-text-xs-sm","dyn-m-t-5"],[1,"dyn-m-r-10"],[1,"dyn-vertical-middle"],["src","/assets/img/check-icon.svg","height","18px","class","dyn-vertical-middle dyn-m-l-5",4,"ngIf"],["src","/assets/img/cancel-icon.svg","height","18px","class","dyn-vertical-middle dyn-m-l-5",4,"ngIf"],["src","/assets/img/check-icon.svg","height","18px",1,"dyn-vertical-middle","dyn-m-l-5"],["src","/assets/img/cancel-icon.svg","height","18px",1,"dyn-vertical-middle","dyn-m-l-5"],[3,"value"],["removable","",3,"removed"],["matChipRemove",""],["mat-raised-button","","color","accent",1,"dyn-m-r-10",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"dyn-error","dyn-inline-block","dyn-m-r-10"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"h1"),a.dd(2,"SMS"),a.hc(),a.bd(3,Ia,2,0,"div",1),a.hc(),a.dc(4,"hr",2),a.bd(5,Da,2,0,"div",3),a.bd(6,ho,49,22,"ng-container",1)),2&e&&(a.Pb(3),a.Bc("ngIf",t.sendingSms),a.Pb(2),a.Bc("ngIf",!t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value))},directives:[J.p,fe.a,te.y,te.p,te.s,te.t,te.A,J.o,te.d,J.n,le.b,ue.a,ge.a,Ba.c,Ba.a,Ba.d],pipes:[J.f,J.x],styles:['.sms-bubble{position:relative;background:#2d67ff;color:#fff;padding:8px 20px;display:inline-block;border-radius:11px;font-size:.9rem;white-space:pre-line}.sms-bubble img{max-width:300px}.sms-bubble.inbound{background:#cad0d4;color:#000}.sms-bubble:not(.inbound):before{content:"";position:absolute;right:-15px;bottom:-2px;width:15px;height:15px;border-left:7px solid #2d67ff;border-bottom-left-radius:11px 5px}.sms-bubble.inbound:before{content:"";position:absolute;left:-15px;bottom:-2px;width:15px;height:15px;border-right:7px solid #cad0d4;border-bottom-right-radius:11px 5px}.conversation-window{height:300px;overflow:auto}'],encapsulation:2}),e})();var po=n("4bid"),vo=n("IPpw"),mo=n("XoUg");const fo=["emailConversationContainer"];function So(e,t){1&e&&(a.ic(0,"div",3),a.dd(1," No Contact Selected\n"),a.hc())}function _o(e,t){1&e&&(a.ic(0,"div",25),a.dd(1," No Emails to show "),a.hc())}function yo(e,t){1&e&&(a.gc(0),a.dc(1,"img",35),a.fc())}function Co(e,t){1&e&&(a.gc(0),a.dc(1,"img",36),a.fc())}function Po(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.ed(e.body)}}function wo(e,t){if(1&e&&(a.dc(0,"div",37),a.vc(1,"sanitizeHtml")),2&e){const e=a.uc().$implicit;a.Bc("innerHTML",a.wc(1,1,e.body),a.Rc)}}function Mo(e,t){1&e&&a.dc(0,"hr")}function xo(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",29),a.ic(2,"label",30),a.dd(3,"Sent To:"),a.hc(),a.dc(4,"br"),a.dd(5),a.dc(6,"hr",31),a.ic(7,"label",30),a.dd(8,"Sent From:"),a.hc(),a.dc(9,"br"),a.dd(10),a.dc(11,"hr",31),a.ic(12,"label",30),a.dd(13,"Subject:"),a.hc(),a.dc(14,"br"),a.dd(15),a.dc(16,"hr",31),a.ic(17,"label",32),a.dd(18,"Is HTML:"),a.hc(),a.bd(19,yo,2,0,"ng-container",2),a.bd(20,Co,2,0,"ng-container",2),a.dc(21,"hr",31),a.ic(22,"label",30),a.dd(23,"Body:"),a.hc(),a.dc(24,"br"),a.bd(25,Po,2,1,"div",2),a.bd(26,wo,2,3,"div",33),a.hc(),a.ic(27,"span",34),a.dd(28),a.vc(29,"date"),a.hc(),a.bd(30,Mo,1,0,"hr",2),a.hc()),2&e){const e=t.$implicit,n=t.last;a.Pb(5),a.fd(" ",e.destination," "),a.Pb(5),a.fd(" ",e.source," "),a.Pb(5),a.fd(" ",e.subject," "),a.Pb(4),a.Bc("ngIf",e.is_html),a.Pb(1),a.Bc("ngIf",!e.is_html),a.Pb(5),a.Bc("ngIf",!e.is_html),a.Pb(1),a.Bc("ngIf",e.is_html),a.Pb(2),a.fd(" Created On: ",a.xc(29,9,e.created_on,"MMM d, y, h:mm a")," "),a.Pb(2),a.Bc("ngIf",!n)}}function Bo(e,t){if(1&e&&(a.ic(0,"div",26,27),a.bd(2,xo,31,12,"div",28),a.hc()),2&e){const e=a.uc(2);a.Pb(2),a.Bc("ngForOf",e.emails)}}function ko(e,t){if(1&e&&(a.ic(0,"option",14),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(3);a.Bc("ngValue",e),a.Pb(1),a.gd(" ",e.contact_field&&n.agentContactFieldService.contactFieldMap[e.contact_field]&&n.agentContactFieldService.contactFieldMap[e.contact_field].label?n.agentContactFieldService.contactFieldMap[e.contact_field].label+" - ":""," ",e.email," ")}}function Fo(e,t){if(1&e&&(a.gc(0),a.bd(1,ko,2,3,"option",38),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngForOf",e.agentContactService.contactSubject.value._email_addresses)}}function Io(e,t){1&e&&a.dc(0,"img",35)}function Do(e,t){1&e&&a.dc(0,"img",36)}function To(e,t){if(1&e&&(a.ic(0,"div",39),a.dd(1," DNC: "),a.bd(2,Io,1,0,"img",40),a.bd(3,Do,1,0,"img",41),a.hc()),2&e){const e=a.uc(2);a.Pb(2),a.Bc("ngIf",e.agentContactService.selectedEmailAddress.do_not_contact),a.Pb(1),a.Bc("ngIf",!e.agentContactService.selectedEmailAddress.do_not_contact)}}function jo(e,t){if(1&e&&(a.ic(0,"option",42),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.id),a.Pb(1),a.ed(e.name)}}function Oo(e,t){if(1&e){const e=a.kc();a.ic(0,"textarea",43),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).emailBody=t})),a.hc()}if(2&e){const e=a.uc(2);a.Bc("ngModel",e.emailBody)}}function No(e,t){if(1&e){const e=a.kc();a.ic(0,"div",44),a.qc("blur",(function(t){return a.Qc(e),a.uc(2).emailBody=t.target.innerHTML})),a.vc(1,"sanitizeHtml"),a.hc()}if(2&e){const e=a.uc(2);a.Bc("innerHTML",a.wc(1,1,e.emailBody),a.Rc)}}function qo(e,t){if(1&e){const e=a.kc();a.gc(0),a.bd(1,_o,2,0,"div",4),a.bd(2,Bo,3,1,"div",5),a.ic(3,"div",6),a.ic(4,"div",7),a.ic(5,"label"),a.dd(6,"Send To:"),a.hc(),a.dc(7,"br"),a.ic(8,"div",8),a.ic(9,"select",9),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().agentContactService.selectedEmailAddress=t})),a.bd(10,Fo,2,1,"ng-container",2),a.hc(),a.ic(11,"button",10),a.qc("click",(function(){return a.Qc(e),a.uc().showCreateEmailDialog()})),a.ic(12,"mat-icon"),a.dd(13,"add"),a.hc(),a.hc(),a.hc(),a.bd(14,To,4,2,"div",11),a.hc(),a.ic(15,"div",12),a.ic(16,"label"),a.dd(17,"Email Templates"),a.hc(),a.dc(18,"br"),a.ic(19,"select",13),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().selectedTemplate=t}))("ngModelChange",(function(){return a.Qc(e),a.uc().selectTemplate()})),a.dc(20,"option",14),a.bd(21,jo,2,2,"option",15),a.hc(),a.hc(),a.hc(),a.dc(22,"hr"),a.ic(23,"div"),a.ic(24,"label"),a.dd(25,"From:"),a.hc(),a.dc(26,"br"),a.dc(27,"input",16),a.hc(),a.ic(28,"div",17),a.ic(29,"label"),a.dd(30,"Subject:"),a.hc(),a.dc(31,"br"),a.ic(32,"input",18),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().emailSubject=t})),a.hc(),a.hc(),a.ic(33,"div",17),a.ic(34,"label"),a.dd(35,"Body:"),a.hc(),a.dc(36,"br"),a.bd(37,Oo,1,1,"textarea",19),a.bd(38,No,2,3,"div",20),a.hc(),a.ic(39,"div",21),a.ic(40,"div",22),a.ic(41,"input",23),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().isHtml=t})),a.hc(),a.dd(42," Is HTML "),a.hc(),a.ic(43,"button",24),a.qc("click",(function(){return a.Qc(e),a.uc().onSendEmail()})),a.dd(44,"Send"),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",!e.emails.length),a.Pb(1),a.Bc("ngIf",e.emails.length),a.Pb(7),a.Bc("ngModel",e.agentContactService.selectedEmailAddress),a.Pb(1),a.Bc("ngIf",e.agentContactService.contactSubject.value),a.Pb(4),a.Bc("ngIf",e.agentContactService.selectedEmailAddress),a.Pb(5),a.Bc("ngModel",e.selectedTemplate),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",e.emailTemplates),a.Pb(6),a.Bc("value",e.userEmail),a.Pb(5),a.Bc("ngModel",e.emailSubject),a.Pb(5),a.Bc("ngIf",!e.isHtml),a.Pb(1),a.Bc("ngIf",e.isHtml),a.Pb(3),a.Bc("ngModel",e.isHtml),a.Pb(2),a.Bc("disabled",e.sendingEmail)}}let $o=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b){this.snackBar=e,this.dialog=t,this.utilsService=n,this.agentNavService=i,this.authService=c,this.userService=a,this.emailService=o,this.contactEmailService=s,this.agentStatusService=r,this.emailTemplateService=d,this.agentUserService=l,this.agentAccountSettingsService=u,this.agentContactService=g,this.agentContactFieldService=h,this.datePipe=b,this.emails=[],this.emailTemplates=[],this.emailSubject="",this.emailBody="",this.selectedTemplate=null,this.sendingEmail=!1,this.userEmail="",this.isHtml=!1}ngOnInit(){this.agentNavSubscription=this.agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{"email"===e&&this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id&&(this._getContactEmailMessages(),this._getUserEmail(),this._getEmailTemplates())}}),this.agentContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{e&&e.id&&"email"===this.agentNavService.activeDashboardSectionSubject.value&&(this._getContactEmailMessages(),this._renderTemplate(),this.emailTemplates.length||this._getEmailTemplates())}})}ngOnDestroy(){this.agentNavSubscription.unsubscribe(),this.agentContactSubscription.unsubscribe()}onSendEmail(){this.agentContactService.contactSubject.value||this.agentContactService.contactSubject.value.id?this.agentContactService.selectedEmailAddress?this.agentContactService.selectedEmailAddress.do_not_contact?this.snackBar.open("Email address is a do not contact email","",{duration:5e3,verticalPosition:"top",panelClass:["error"]}):this.userEmail?this.emailSubject?this.emailBody?(this.sendingEmail=!0,this.emailService.create({contact:this.agentContactService.contactSubject.value.id,destination:this.agentContactService.selectedEmailAddress.email,inbound:!1,source:this.userEmail,subject:this.emailSubject,body:this.emailBody,campaign:this.agentStatusService.agentStatusSubject.value?this.agentStatusService.agentStatusSubject.value.campaign:null,is_html:this.isHtml}).subscribe({next:e=>{this.emailSubject="",this.emailBody="",setTimeout(()=>{this.sendingEmail=!1},1e4),this.emails.push(e),this.snackBar.open("Email Sent","",{duration:3e3,verticalPosition:"top",panelClass:["success"]})},error:e=>{this.sendingEmail=!1,this.snackBar.open(this.utilsService.handleErrorResponse(e,"Error Sending Email"),"X",{duration:8e3,verticalPosition:"top",panelClass:"error"})}})):this.snackBar.open("Enter an email body","",{duration:5e3,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open("Enter an email subject","",{duration:5e3,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open("A From email is required","",{duration:5e3,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open("Please select a To: email","",{duration:5e3,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open("A Contact is required","",{duration:5e3,verticalPosition:"top",panelClass:"error"})}selectTemplate(){this._renderTemplate()}_renderTemplate(){if(!this.selectedTemplate)return;let e=this.emailTemplates.find(e=>e.id==this.selectedTemplate).subject,t=this.emailTemplates.find(e=>e.id==this.selectedTemplate).body,n=this.emailTemplates.find(e=>e.id==this.selectedTemplate).is_html;const i=e.match(/[^{]+(?=\})/g),c=e.match(/[^[]+(?=\])/g),a=t.match(/[^{]+(?=\})/g),o=t.match(/[^[]+(?=\])/g);let s=[],r=[],d=[],l=[];const u=JSON.parse(JSON.stringify(this.agentContactService.contactSubject.value));u&&this.agentContactFieldService.contactFieldSubject.subscribe({next:e=>{e.forEach(e=>{if(i&&i.includes(e.name)||a&&a.includes(e.name))if("Date"===e.data_type&&u[e.name]){const t=u[e.name].split("T");u[e.name]=t[0]}else if("Date Time"===e.data_type&&u[e.name]){u[e.name]=this.datePipe.transform(u[e.name],"yyyy-MM-dd, h:mm a");const t="long",n=(new Date).toLocaleDateString(void 0,{day:"2-digit",timeZoneName:t}).substring(4);u[e.name]+=" ("+n+")"}})}}),i&&(i.forEach(e=>{u[e]&&(s[e]=u[e])}),i.forEach(t=>{e=e.split("{"+t+"}").join(s[t]?s[t]:"__")})),c&&(c.forEach(e=>{this.agentUserService.user.custom_settings[e]?r[e]=this.agentUserService.user.custom_settings[e]:this.agentAccountSettingsService.accountSettings.custom_settings[e]&&(r[e]=this.agentAccountSettingsService.accountSettings.custom_settings[e])}),c.forEach(t=>{e=e.split("["+t+"]").join(r[t]?r[t]:"["+t+"]")})),a&&(a.forEach(e=>{u[e]&&(d[e]=u[e])}),a.forEach(e=>{t=t.split("{"+e+"}").join(d[e]?d[e]:"__")})),o&&(o.forEach(e=>{this.agentUserService.user.custom_settings[e]?l[e]=this.agentUserService.user.custom_settings[e]:this.agentAccountSettingsService.accountSettings.custom_settings[e]&&(l[e]=this.agentAccountSettingsService.accountSettings.custom_settings[e])}),o.forEach(e=>{t=t.split("["+e+"]").join(l[e]?l[e]:"["+e+"]")})),this.emailSubject=e,this.emailBody=t,this.isHtml=n}showCreateEmailDialog(){this.agentContactService.contactSubject.value?this.dialog.open(Kt,{width:"400px"}).afterClosed().subscribe({next:e=>{e&&(this.agentContactService.contactSubject.value._email_addresses.push(e),this.agentContactService.selectedEmailAddress=e,this.snackBar.open("Email Address Created","X",{duration:2500,verticalPosition:"top",panelClass:["success"]}))}}):this.snackBar.open("No Contact Selected","X",{duration:2500,verticalPosition:"top",panelClass:["error"]})}_getContactEmailMessages(){this.contactEmailService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.emails=e.results,setTimeout(()=>{this._scrollEmailContainerToBottom()},100)}})}_getEmailTemplates(){this.emailTemplateService.list("max").subscribe({next:e=>{this.emailTemplates=e.results}})}_getUserEmail(){this.userService.get(this.authService.getUserId()).subscribe({next:e=>{this.userEmail=e.email}})}_scrollEmailContainerToBottom(){try{this.emailConversationContainer.nativeElement.scrollTop=this.emailConversationContainer.nativeElement.scrollHeight}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(Y.b),a.bc(D.a),a.bc(d.a),a.bc(r.a),a.bc(I.a),a.bc(po.a),a.bc(mo.a),a.bc(p.a),a.bc(vo.a),a.bc(g.a),a.bc(P.a),a.bc(f.a),a.bc(h.a),a.bc(J.f))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-email"]],viewQuery:function(e,t){var n;1&e&&a.jd(fo,!0),2&e&&a.Lc(n=a.rc())&&(t.emailConversationContainer=n.first)},features:[a.Ob([J.f])],decls:5,vars:2,consts:[[1,"dyn-m-t-0"],["class","dyn-bg-grey dyn-p-20 dyn-text-muted",4,"ngIf"],[4,"ngIf"],[1,"dyn-bg-grey","dyn-p-20","dyn-text-muted"],["class","dyn-bg-grey dyn-text-muted dyn-p-20",4,"ngIf"],["class","dyn-bg-grey conversation-window","style","overflow: auto;max-height: 550px;border: 1px solid #d4d4d4",4,"ngIf"],[1,"dyn-m-t-20","dyn-flex"],[1,"dyn-full-width","dyn-m-r-20"],[1,"dyn-flex","dyn-align-items"],[1,"dyn-full-width","dyn-m-r-10",3,"ngModel","ngModelChange"],["mat-icon-button","","color","primary",3,"click"],["class","dyn-text-xs-sm dyn-text-muted dyn-m-t-5",4,"ngIf"],[1,"dyn-full-width"],[1,"dyn-full-width",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["disabled","",1,"dyn-full-width",3,"value"],[1,"dyn-m-t-10"],["placeholder","Subject",1,"dyn-full-width","email-subject",3,"ngModel","ngModelChange"],["class","dyn-full-width","placeholder","Body","rows","10",3,"ngModel","ngModelChange",4,"ngIf"],["contenteditable","true","style","border: 1px solid #d4d4d4;padding: 10px;box-sizing: border-box;",3,"innerHTML","blur",4,"ngIf"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10"],[1,"email-is-html"],["type","checkbox",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"dyn-bg-grey","dyn-text-muted","dyn-p-20"],[1,"dyn-bg-grey","conversation-window",2,"overflow","auto","max-height","550px","border","1px solid #d4d4d4"],["emailConversationContainer",""],[4,"ngFor","ngForOf"],[1,"email-message"],[1,"dyn-text-muted"],[1,"dyn-m-t-10","dyn-m-b-10"],[1,"dyn-text-muted","dyn-m-r-5","dyn-vertical-middle"],[3,"innerHTML",4,"ngIf"],[1,"dyn-text-muted","dyn-text-sm"],["src","/assets/img/check-icon.svg","height","18px",1,"dyn-vertical-middle"],["src","/assets/img/cancel-icon.svg","height","18px",1,"dyn-vertical-middle"],[3,"innerHTML"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"dyn-text-xs-sm","dyn-text-muted","dyn-m-t-5"],["src","/assets/img/check-icon.svg","height","18px","class","dyn-vertical-middle",4,"ngIf"],["src","/assets/img/cancel-icon.svg","height","18px","class","dyn-vertical-middle",4,"ngIf"],[3,"value"],["placeholder","Body","rows","10",1,"dyn-full-width",3,"ngModel","ngModelChange"],["contenteditable","true",2,"border","1px solid #d4d4d4","padding","10px","box-sizing","border-box",3,"innerHTML","blur"]],template:function(e,t){1&e&&(a.ic(0,"h1"),a.dd(1,"Email"),a.hc(),a.dc(2,"hr",0),a.bd(3,So,2,0,"div",1),a.bd(4,qo,45,14,"ng-container",2)),2&e&&(a.Pb(3),a.Bc("ngIf",!t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value))},directives:[J.p,te.y,te.p,te.s,le.b,ge.a,te.t,te.A,J.o,te.d,te.a],pipes:[J.f,Ri.a],styles:[".conversation-window[_ngcontent-%COMP%]{max-height:300px;overflow:auto;padding:10px}.email-message[_ngcontent-%COMP%]{background:#fff;padding:20px;box-sizing:border-box;margin:5px;border-radius:5px}"]}),e})();function Eo(e,t){1&e&&(a.ic(0,"div",4),a.dd(1," No Script to show\n"),a.hc())}function Ao(e,t){1&e&&(a.gc(0),a.dc(1,"app-dynamic-agent-script"),a.fc())}function Qo(e,t){if(1&e&&(a.dc(0,"div",5),a.vc(1,"sanitizeHtml")),2&e){const e=a.uc();a.Bc("innerHTML",a.wc(1,1,e.agentAgentScriptService.formattedScript),a.Rc)}}let Ro=(()=>{class e{constructor(e,t,n,i){this.agentAgentScriptService=e,this.agentContactFieldService=t,this.agentContactService=n,this._agentNavService=i}ngOnInit(){this.agentDashboardNavSubscription=this._agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{if("agent-script"===e){this.agentAgentScriptService.formatAgentScript();const e=this.agentContactService.contactSubject.value;e&&e.id&&this.agentAgentScriptService.accountHasPersonalizationScripts&&this.agentAgentScriptService.checkForPersonalizationScript(e.id)}}})}ngOnDestroy(){this.agentDashboardNavSubscription&&this.agentDashboardNavSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(zt.a),a.bc(h.a),a.bc(f.a),a.bc(d.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-agent-script"]],decls:7,vars:3,consts:[[1,"dyn-m-t-0"],["class","dyn-p-20 dyn-text-muted dyn-bg-grey",4,"ngIf"],[4,"ngIf"],["class","agent-script simple-agent-script","style","white-space: pre-wrap; overflow: auto;max-height: 550px;",3,"innerHTML",4,"ngIf"],[1,"dyn-p-20","dyn-text-muted","dyn-bg-grey"],[1,"agent-script","simple-agent-script",2,"white-space","pre-wrap","overflow","auto","max-height","550px",3,"innerHTML"]],template:function(e,t){1&e&&(a.gc(0),a.ic(1,"h1"),a.dd(2,"Agent Script"),a.hc(),a.dc(3,"hr",0),a.fc(),a.bd(4,Eo,2,0,"div",1),a.bd(5,Ao,2,0,"ng-container",2),a.bd(6,Qo,2,3,"div",3)),2&e&&(a.Pb(4),a.Bc("ngIf",!t.agentAgentScriptService.agentScriptSubject.value),a.Pb(1),a.Bc("ngIf","dynamic"===t.agentAgentScriptService.agentScriptType),a.Pb(1),a.Bc("ngIf",t.agentAgentScriptService.formattedScript&&"simple"===t.agentAgentScriptService.agentScriptType))},directives:[J.p,_c],pipes:[Ri.a],styles:[""]}),e})();var Uo=n("+0xr");const Vo=["notesTable"];function Wo(e,t){1&e&&(a.ic(0,"div",6),a.dc(1,"mat-progress-spinner",7),a.dd(2," Loading... "),a.hc())}function zo(e,t){1&e&&(a.ic(0,"div",10),a.dd(1," No Contact Selected "),a.hc())}function Ho(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Note "),a.hc())}function Lo(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.note," ")}}function Xo(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Created By "),a.hc())}function Go(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(4);a.Pb(1),a.fd(" ",e.app_user&&n.agentUserService.usersMap[e.app_user]?n.agentUserService.usersMap[e.app_user].full_name:""," ")}}function Yo(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Created On "),a.hc())}function Jo(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.created_on,"MMM d, y, h:mm a")," ")}}function Zo(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Controls "),a.hc())}function Ko(e,t){if(1&e){const e=a.kc();a.ic(0,"td",23),a.ic(1,"button",24),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(4).toggleNoteForm("Edit",n)})),a.dd(2,"Edit"),a.hc(),a.ic(3,"button",25),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(4).deleteNote(n)})),a.dd(4,"Delete"),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc(4);a.Pb(1),a.Bc("disabled",e.app_user!==n.authService.getUserId()),a.Pb(2),a.Bc("disabled",e.app_user!==n.authService.getUserId())}}function es(e,t){1&e&&a.dc(0,"tr",26)}function ts(e,t){1&e&&a.dc(0,"tr",27)}function ns(e,t){1&e&&(a.ic(0,"div",10),a.dd(1," No notes to show "),a.hc())}function is(e,t){if(1&e&&(a.ic(0,"div",11),a.ic(1,"table",12,13),a.gc(3,14),a.bd(4,Ho,2,0,"th",15),a.bd(5,Lo,2,1,"td",16),a.fc(),a.gc(6,17),a.bd(7,Xo,2,0,"th",15),a.bd(8,Go,2,1,"td",16),a.fc(),a.gc(9,18),a.bd(10,Yo,2,0,"th",15),a.bd(11,Jo,3,4,"td",16),a.fc(),a.gc(12,19),a.bd(13,Zo,2,0,"th",15),a.bd(14,Ko,5,2,"td",16),a.fc(),a.bd(15,es,1,0,"tr",20),a.bd(16,ts,1,0,"tr",21),a.hc(),a.bd(17,ns,2,0,"div",8),a.hc()),2&e){const e=a.uc(3);a.Pb(1),a.Bc("dataSource",e.notes),a.Pb(14),a.Bc("matHeaderRowDef",e.displayedColumns),a.Pb(1),a.Bc("matRowDefColumns",e.displayedColumns),a.Pb(1),a.Bc("ngIf",!e.notes.length)}}function cs(e,t){if(1&e&&(a.gc(0),a.bd(1,zo,2,0,"div",8),a.bd(2,is,18,4,"div",9),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",!e.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",e.agentContactService.contactSubject.value)}}function as(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",1),a.ic(2,"h1"),a.dd(3,"Notes"),a.hc(),a.ic(4,"div",2),a.ic(5,"button",3),a.qc("click",(function(){return a.Qc(e),a.uc().toggleNoteForm("Create")})),a.dd(6,"Create Note"),a.hc(),a.hc(),a.hc(),a.dc(7,"hr",4),a.bd(8,Wo,3,0,"div",5),a.bd(9,cs,3,2,"ng-container",0),a.hc()}if(2&e){const e=a.uc();a.Pb(5),a.Bc("disabled",!e.agentContactService.contactSubject.value||!e.agentContactService.contactSubject.value.id),a.Pb(3),a.Bc("ngIf",e.loading),a.Pb(1),a.Bc("ngIf",!e.loading)}}function os(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",28),a.ic(2,"h1"),a.dd(3),a.hc(),a.ic(4,"div",29),a.ic(5,"button",30),a.qc("click",(function(){return a.Qc(e),a.uc().showNoteForm=!1})),a.ic(6,"mat-icon"),a.dd(7,"arrow_back"),a.hc(),a.dd(8," Back to Notes "),a.hc(),a.hc(),a.hc(),a.ic(9,"div",31),a.ic(10,"textarea",32),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().agentNoteService.noteInput=t})),a.hc(),a.ic(11,"div",33),a.dd(12),a.hc(),a.dc(13,"hr"),a.ic(14,"div",34),a.ic(15,"button",35),a.qc("click",(function(){return a.Qc(e),a.uc().showNoteForm=!1})),a.dd(16,"Cancel"),a.hc(),a.ic(17,"button",36),a.qc("click",(function(){return a.Qc(e),a.uc().saveNoteForm()})),a.dd(18,"Save Note"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(3),a.fd(" ","Edit"===e.noteFormAction?"Edit Note":"Create Note"," "),a.Pb(7),a.Bc("ngModel",e.agentNoteService.noteInput),a.Pb(1),a.Tb("dyn-error",e.agentNoteService.noteInput.length>1024),a.Pb(1),a.fd(" ",e.agentNoteService.noteInput.length,"/1024 ")}}let ss=(()=>{class e{constructor(e,t,n,i,c,a,o){this.agentNoteService=e,this.agentContactService=t,this.agentUserService=n,this.authService=i,this._snackBar=c,this._agentNavService=a,this._contactNoteService=o,this.displayedColumns=["note","createdBy","date","controls"],this.notes=[],this.loading=!1}ngOnInit(){this.agentDashboardNavSubscription=this._agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{"notes"===e&&this.agentContactService.contactSubject.value&&(this._getContactNotes(),this._removeStoredNote())}}),this.agentDashboardContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{e&&-1===this.agentNoteService.storedNotes.findIndex(t=>t.contact===e.id)&&(this.agentNoteService.noteInput=""),e&&e.id&&"notes"===this._agentNavService.activeDashboardSectionSubject.value&&(this._getContactNotes(),this._removeStoredNote())}})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe(),this.agentDashboardContactSubscription.unsubscribe()}toggleNoteForm(e,t){if(this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id){if(e&&(this.noteFormAction=e,"Edit"===e)){if(t.app_user!==this.authService.getUserId())return void this._snackBar.open("You can only edit your own notes","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]});this.noteId=t.id,this.agentNoteService.noteInput=t.note}this.showNoteForm=!this.showNoteForm}else this._snackBar.open("No Contact Selected","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}saveNoteForm(){var e,t;(null===(e=this.agentNoteService.noteInput)||void 0===e?void 0:e.length)?("Create"===this.noteFormAction?this.agentNoteService.createNote(null===(t=this.agentContactService.contactSubject.value)||void 0===t?void 0:t.id):"Edit"===this.noteFormAction&&this.agentNoteService.updateNote(this.noteId),this.showNoteForm=!this.showNoteForm,this.loading=!0,setTimeout(()=>{this._getContactNotes()},1e3)):this._snackBar.open("Notes cannot be empty","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}deleteNote(e){e.app_user===this.authService.getUserId()?this._contactNoteService.delete(e.id).subscribe({next:()=>{const t=this.notes.findIndex(t=>t.id===e.id);this.notes.splice(t,1),this._snackBar.open("Note Deleted","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]}),this.agentContactService.contactSubject.value&&this.notesTable&&this.notesTable.renderRows()}}):this._snackBar.open("You can only delete your own notes","X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}_removeStoredNote(){if(this.agentNoteService.storedNotes.length){const e=this.agentNoteService.storedNotes.findIndex(e=>{var t;return e.contact===(null===(t=this.agentContactService.contactSubject.value)||void 0===t?void 0:t.id)});-1!==e&&(this.agentNoteService.showNoteAlert=!1,this.agentNoteService.storedNotes.splice(e,1))}}_getContactNotes(){this.loading=!0,this.agentContactService.contactSubject.value.id&&this._contactNoteService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.notes=e.results,this.loading=!1}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(R.a),a.bc(f.a),a.bc(g.a),a.bc(r.a),a.bc(k.a),a.bc(d.a),a.bc(T.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-notes"]],viewQuery:function(e,t){var n;1&e&&a.jd(Vo,!0),2&e&&a.Lc(n=a.rc())&&(t.notesTable=n.first)},decls:2,vars:2,consts:[[4,"ngIf"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-p-t-15"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"dyn-m-t-10","dyn-m-b-10"],["class","dyn-p-20",4,"ngIf"],[1,"dyn-p-20"],["mode","indeterminate","diameter","20",1,"dyn-inline-block","dyn-vertical-middle","dyn-m-r-10"],["class","dyn-bg-grey dyn-p-20 dyn-text-muted",4,"ngIf"],["style","overflow: auto;max-height: 550px;",4,"ngIf"],[1,"dyn-bg-grey","dyn-p-20","dyn-text-muted"],[2,"overflow","auto","max-height","550px"],["mat-table","",1,"dyn-full-width",3,"dataSource"],["notesTable",""],["matColumnDef","note"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdBy"],["matColumnDef","date"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","","color","warn",3,"disabled","click"],["mat-header-row",""],["mat-row",""],[1,"dyn-flex","dyn-space-between","agent-notes-section"],[1,"dyn-p-t-10"],["mat-raised-button","","color","",3,"click"],["id","create-note"],["placeholder","Write a note..",1,"dyn-full-width",2,"min-height","90px",3,"ngModel","ngModelChange"],[1,"dyn-m-t-5","dyn-text-right","dyn-text-sm"],[1,"dyn-m-t-20","dyn-text-right"],["mat-stroked-button","","color","",1,"dyn-m-r-10",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(a.bd(0,as,10,3,"div",0),a.bd(1,os,19,5,"div",0)),2&e&&(a.Bc("ngIf",!t.showNoteForm),a.Pb(1),a.Bc("ngIf",t.showNoteForm))},directives:[J.p,le.b,fe.a,Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,Uo.h,Uo.a,Uo.j,Uo.l,ge.a,te.d,te.p,te.s],pipes:[J.f],encapsulation:2}),e})();var rs=n("jVVk");let ds=(()=>{class e{constructor(e,t){this.snackBar=e,this.calendarEventTypeService=t,this.calendarEventTypes=[],this.calendarEventTypeMap=[]}getCalendarEventTypes(){this.calendarEventTypeService.list("max").subscribe({next:e=>{this.calendarEventTypes=e.results,e.results.forEach(e=>{this.calendarEventTypeMap[e.id]=e.name})}})}}return e.\u0275fac=function(t){return new(t||e)(a.nc(k.a),a.nc(rs.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ls=n("R94R");const us=["calendarEventsTable"];function gs(e,t){1&e&&(a.ic(0,"div",8),a.dd(1," No Contact Selected "),a.hc())}function hs(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Name "),a.hc())}function bs(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",null==e?null:e.name," ")}}function ps(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Type "),a.hc())}function vs(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.vc(2,"titlecase"),a.hc()),2&e){const e=t.$implicit,n=a.uc(3);a.Pb(1),a.fd(" ",a.wc(2,1,n.agentCalendarEventTypeService.calendarEventTypeMap[e.type])," ")}}function ms(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Created By "),a.hc())}function fs(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(3);a.Pb(1),a.fd(" ",e.app_user&&n.agentUserService.usersMap[e.app_user]?n.agentUserService.usersMap[e.app_user].full_name:""," ")}}function Ss(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Description "),a.hc())}function _s(e,t){if(1&e&&(a.ic(0,"span",25),a.dd(1),a.vc(2,"slice"),a.hc()),2&e){const e=a.uc(2).$implicit;a.Bc("matTooltip",e.description),a.Pb(1),a.fd(" ",a.yc(2,2,e.description,0,22)+".."," ")}}function ys(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.ed(e.description)}}function Cs(e,t){if(1&e&&(a.gc(0),a.bd(1,_s,3,6,"span",24),a.bd(2,ys,2,1,"span",0),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf",e.description.length>=22),a.Pb(1),a.Bc("ngIf",e.description.length<22)}}function Ps(e,t){if(1&e&&(a.ic(0,"td",23),a.bd(1,Cs,3,2,"ng-container",0),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.description)}}function ws(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Event Start "),a.hc())}function Ms(e,t){if(1&e&&(a.ic(0,"td",23),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.event_start,"MMM d, y, h:mm a")," ")}}function xs(e,t){1&e&&(a.ic(0,"th",22),a.dd(1," Controls "),a.hc())}function Bs(e,t){if(1&e){const e=a.kc();a.ic(0,"td",23),a.ic(1,"button",26),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(3).toggleCalendarEventForm("Edit",n)})),a.dd(2,"Edit"),a.hc(),a.ic(3,"button",27),a.qc("click",(function(){a.Qc(e);const n=t.$implicit,i=t.index;return a.uc(3).deleteCalendarEvent(n,i)})),a.dd(4,"Delete"),a.hc(),a.hc()}}function ks(e,t){1&e&&a.dc(0,"tr",28)}function Fs(e,t){1&e&&a.dc(0,"tr",29)}function Is(e,t){1&e&&(a.ic(0,"div",8),a.dd(1," No calendar events to show "),a.hc())}const Ds=function(){return["name","type","created_by","description","event_start","controls"]};function Ts(e,t){if(1&e&&(a.ic(0,"div",9),a.ic(1,"table",10,11),a.gc(3,12),a.bd(4,hs,2,0,"th",13),a.bd(5,bs,2,1,"td",14),a.fc(),a.gc(6,15),a.bd(7,ps,2,0,"th",13),a.bd(8,vs,3,3,"td",14),a.fc(),a.gc(9,16),a.bd(10,ms,2,0,"th",13),a.bd(11,fs,2,1,"td",14),a.fc(),a.gc(12,17),a.bd(13,Ss,2,0,"th",13),a.bd(14,Ps,2,1,"td",14),a.fc(),a.gc(15,18),a.bd(16,ws,2,0,"th",13),a.bd(17,Ms,3,4,"td",14),a.fc(),a.gc(18,19),a.bd(19,xs,2,0,"th",13),a.bd(20,Bs,5,0,"td",14),a.fc(),a.bd(21,ks,1,0,"tr",20),a.bd(22,Fs,1,0,"tr",21),a.hc(),a.bd(23,Is,2,0,"div",6),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("dataSource",e.calendarEvents),a.Pb(20),a.Bc("matHeaderRowDef",a.Fc(4,Ds)),a.Pb(1),a.Bc("matRowDefColumns",a.Fc(5,Ds)),a.Pb(1),a.Bc("ngIf",!e.calendarEvents.length)}}function js(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"div",2),a.ic(2,"div"),a.ic(3,"h1"),a.dd(4,"Calendar Events"),a.hc(),a.hc(),a.ic(5,"div",3),a.ic(6,"button",4),a.qc("click",(function(){return a.Qc(e),a.uc().toggleCalendarEventForm("Create")})),a.dd(7,"Create Calendar Event"),a.hc(),a.hc(),a.hc(),a.dc(8,"hr",5),a.bd(9,gs,2,0,"div",6),a.bd(10,Ts,24,6,"div",7),a.hc()}if(2&e){const e=a.uc();a.Pb(9),a.Bc("ngIf",!e.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",e.agentContactService.contactSubject.value)}}function Os(e,t){if(1&e&&(a.ic(0,"option",43),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}const Ns=function(){return{standalone:!0}};function qs(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",56),a.ic(2,"label",41),a.dd(3),a.ic(4,"mat-icon",57),a.dd(5,"help"),a.hc(),a.hc(),a.dc(6,"br"),a.ic(7,"div",41),a.ic(8,"mat-slide-toggle",58),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).useAccountTimezone=t})),a.hc(),a.hc(),a.hc(),a.dc(9,"hr"),a.fc()}if(2&e){const e=a.uc(2);a.Pb(3),a.fd(" Use Account Timezone (",null==e.accountSettings?null:e.accountSettings.time_zone,") "),a.Pb(1),a.Bc("matTooltipClass","dyn-multi-line-tooltip dyn-tooltip-lg")("matTooltip","\t\u2022\tTimezone Setting: Events are created based on the account\u2019s timezone.\n\t\u2022\tDisplay Behavior: Once saved, event times are displayed according to the viewing agent\u2019s local timezone.\n\t\u2022\tExample: If an event is scheduled at 12 PM EST, it will be shown as 9 AM PST to an agent in the Pacific Standard Time zone.\n"),a.Pb(4),a.Bc("ngModel",e.useAccountTimezone)("ngModelOptions",a.Fc(5,Ns))}}function $s(e,t){if(1&e){const e=a.kc();a.ic(0,"div",30),a.ic(1,"div",2),a.ic(2,"h1"),a.dd(3),a.hc(),a.ic(4,"div",31),a.ic(5,"button",32),a.qc("click",(function(){return a.Qc(e),a.uc().showCalendarEventForm=!1})),a.ic(6,"mat-icon"),a.dd(7,"arrow_back"),a.hc(),a.dd(8," Back to Calendar Events "),a.hc(),a.hc(),a.hc(),a.ic(9,"form",33),a.ic(10,"div",34),a.ic(11,"label",35),a.dd(12,"Contact"),a.hc(),a.dc(13,"input",36),a.hc(),a.dc(14,"hr"),a.ic(15,"div",34),a.ic(16,"label",37),a.dd(17,"Name"),a.hc(),a.dc(18,"input",38),a.hc(),a.dc(19,"hr"),a.ic(20,"div",34),a.ic(21,"label",39),a.dd(22,"Description"),a.hc(),a.dc(23,"textarea",40),a.hc(),a.dc(24,"hr"),a.ic(25,"div",34),a.ic(26,"label",41),a.dd(27,"Type"),a.hc(),a.ic(28,"select",42),a.dc(29,"option",43),a.bd(30,Os,2,2,"option",44),a.hc(),a.hc(),a.dc(31,"hr"),a.ic(32,"div",34),a.ic(33,"label",45),a.dd(34,"Event Start (required)"),a.hc(),a.dc(35,"input",46),a.dc(36,"owl-date-time",47,48),a.hc(),a.dc(38,"hr"),a.ic(39,"div",34),a.ic(40,"label",49),a.dd(41,"Event End"),a.hc(),a.dc(42,"input",50),a.dc(43,"owl-date-time",47,51),a.hc(),a.dc(45,"hr"),a.ic(46,"div",34),a.ic(47,"label",52),a.dd(48,"Notify On"),a.hc(),a.dc(49,"input",53),a.dc(50,"owl-date-time",47,54),a.hc(),a.dc(52,"hr"),a.bd(53,qs,10,6,"ng-container",0),a.ic(54,"div",2),a.ic(55,"button",55),a.qc("click",(function(){return a.Qc(e),a.uc().showCalendarEventForm=!1})),a.dd(56,"Cancel"),a.hc(),a.ic(57,"button",4),a.qc("click",(function(){return a.Qc(e),a.uc().onSubmit()})),a.dd(58,"Save"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.Mc(37),t=a.Mc(44),n=a.Mc(51),i=a.uc();a.Pb(3),a.fd(" ","Edit"===i.calendarEventFormAction?"Edit Calendar Event":"Create Calendar Event"," "),a.Pb(6),a.Bc("formGroup",i.calendarEventForm),a.Pb(4),a.Bc("value",i.agentContactService.contactSubject.value?"(ID: "+i.agentContactService.contactSubject.value.id+") "+(i.agentContactService.contactSubject.value.first_name?i.agentContactService.contactSubject.value.first_name+" ":"")+(i.agentContactService.contactSubject.value.last_name?i.agentContactService.contactSubject.value.last_name:""):""),a.Pb(16),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",i.agentCalendarEventTypeService.calendarEventTypes),a.Pb(5),a.Bc("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(7),a.Bc("owlDateTime",t)("owlDateTimeTrigger",t),a.Pb(7),a.Bc("owlDateTime",n)("owlDateTimeTrigger",n),a.Pb(4),a.Bc("ngIf",!i.accountTimezoneMatchesBrowserTimezone&&i.browserTimezone&&i.accountSettings)}}let Es=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u){this._fb=e,this._snackBar=t,this._contactCalendarEventService=n,this._agentNavService=i,this._utils=c,this._webPhoneSessionsService=a,this._agentReportingStatService=o,this._agentContactService=s,this._agentAccountSettingService=r,this.agentCalendarEventTypeService=d,this.agentContactService=l,this.agentUserService=u,this.calendarEvents=[],this.timezoneMap=an.c,this.invertedTimeZoneMap=an.b,this.useAccountTimezone=!1,this.browserTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone?Intl.DateTimeFormat().resolvedOptions().timeZone:"",this.accountTimezoneMatchesBrowserTimezone=!1}ngOnInit(){this.agentDashboardNavSubscription=this._agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{"calendar-events"===e&&this.agentContactService.contactSubject.value&&(this._getContactCalendarEvents(),this.agentCalendarEventTypeService.calendarEventTypes.length||this.agentCalendarEventTypeService.getCalendarEventTypes())}}),this.agentDashboardContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{e&&e.id&&"calendar-events"===this._agentNavService.activeDashboardSectionSubject.value&&this._getContactCalendarEvents()}}),this.accountSettingSubscription=this._agentAccountSettingService.accountSettingsSubject.subscribe({next:e=>{e&&(this.accountSettings=e,this.timezoneMap[this.browserTimezone]===e.time_zone&&(this.accountTimezoneMatchesBrowserTimezone=!0))}}),this.calendarEventForm=this._fb.group({name:"",description:"",type:null,event_start:[null,te.z.required],event_end:null,notify_on:null,campaign:null,live_filter:null,inbound_route:null,queue:null,bucket:null})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe(),this.agentDashboardContactSubscription.unsubscribe(),this.accountSettingSubscription.unsubscribe()}deleteCalendarEvent(e,t){this._contactCalendarEventService.delete(e.id).subscribe({next:()=>{this.calendarEvents.splice(t,1),this._snackBar.open("Event Deleted","",{duration:3e3,verticalPosition:"top",panelClass:["success"]}),this.calendarEventsTable&&this.calendarEventsTable.renderRows()},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Deleting Event"),"",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}toggleCalendarEventForm(e,t){this.agentContactService.contactSubject.value?(e&&(this.calendarEventFormAction=e,"Edit"===e?(this.calendarEventId=t.id,this.calendarEventForm.setValue({name:t.name?t.name:"",description:t.description,event_start:t.event_start,event_end:t.event_end,notify_on:t.notify_on,type:t.type,campaign:t.campaign,queue:t.queue,bucket:t.bucket,live_filter:t.live_filter,inbound_route:t.inbound_route})):"Create"===e&&this.calendarEventForm.setValue({name:"",description:"",event_start:null,event_end:null,notify_on:null,type:null,campaign:null,queue:null,bucket:null,live_filter:null,inbound_route:null})),this.showCalendarEventForm=!this.showCalendarEventForm):this._snackBar.open("No Contact Selected","",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}onSubmit(){var e;if(this.calendarEventForm.invalid)return void this._snackBar.open("Please Fill All Required Fields","",{duration:5e3,verticalPosition:"top",panelClass:["error"]});this.calendarEventForm.get("event_start").setValue(this._formatDateTime("event_start")),this.calendarEventForm.get("event_end").value&&this.calendarEventForm.get("event_end").setValue(this._formatDateTime("event_end"));const t=JSON.parse(JSON.stringify(this.calendarEventForm.value));if(this.useAccountTimezone){const n=this.invertedTimeZoneMap[null===(e=this.accountSettings)||void 0===e?void 0:e.time_zone],i=e=>{const t=this.calendarEventForm.get(e).value;return t?this._utils.convertToTimezone(t,this.browserTimezone,n):null},c=i("event_start"),a=i("event_end"),o=i("notify_on");c&&(t.event_start=c),a&&(t.event_end=a),o&&(t.notify_on=o)}"Create"===this.calendarEventFormAction?this._createCalendarEvent(t):"Edit"===this.calendarEventFormAction&&this._updateCalendarEvent(t)}_formatDateTime(e){const t=new Date(this.calendarEventForm.get(e).value);return new Date(t.setSeconds(0))}_createCalendarEvent(e){if(!this.agentContactService.contactSubject.value)return;e.contact=this.agentContactService.contactSubject.value.id;const t=this._agentReportingStatService.getReportingStats(),n=this._getActiveNumber();n&&(e.phone_number=n),Object.keys(t).forEach(n=>{t[n]&&(e[n]=t[n])}),this._contactCalendarEventService.create(e).subscribe({next:e=>{this.calendarEvents.push(e),this.showCalendarEventForm=!1,this.useAccountTimezone=!1,this._snackBar.open("Calendar Event Created","",{duration:3e3,verticalPosition:"top",panelClass:["success"]})},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Creating Calendar Event"),"",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}_updateCalendarEvent(e){this._contactCalendarEventService.update(this.calendarEventId,{name:e.name,description:e.description,event_start:e.event_start,event_end:e.event_end,notify_on:e.notify_on,type:e.type}).subscribe({next:e=>{const t=this.calendarEvents.findIndex(t=>t.id===e.id);this.calendarEvents[t]=e,this.showCalendarEventForm=!1,this.useAccountTimezone=!1,this._snackBar.open("Calendar Event Updated","",{duration:3e3,verticalPosition:"top",panelClass:["success"]})},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Updating Calendar Event"),"",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}_getActiveNumber(){return this._agentContactService.contactSubject.value&&this._webPhoneSessionsService.previousActiveNumber&&this._agentContactService.contactSubject.value._phone_numbers&&this._agentContactService.contactSubject.value._phone_numbers.length&&this._agentContactService.contactSubject.value._phone_numbers.find(e=>this._stripCountryCode(e.phone_number)===this._stripCountryCode(this._webPhoneSessionsService.previousActiveNumber))?this._webPhoneSessionsService.previousActiveNumber:null}_getContactCalendarEvents(){this.calendarEvents=[],this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id&&this._contactCalendarEventService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.calendarEvents=e.results},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Calendar Events"),"",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}_stripCountryCode(e){return e.replace("+1","")}}return e.\u0275fac=function(t){return new(t||e)(a.bc(te.f),a.bc(k.a),a.bc(ls.a),a.bc(d.a),a.bc(D.a),a.bc(C.a),a.bc(w),a.bc(f.a),a.bc(P.a),a.bc(ds),a.bc(f.a),a.bc(g.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-calendar-events"]],viewQuery:function(e,t){var n;1&e&&a.jd(us,!0),2&e&&a.Lc(n=a.rc())&&(t.calendarEventsTable=n.first)},decls:2,vars:2,consts:[[4,"ngIf"],["class","agent-calendar-events-container",4,"ngIf"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-p-t-15"],["mat-raised-button","","color","primary",3,"click"],[1,"dyn-m-b-0"],["class","dyn-bg-grey dyn-p-20 dyn-text-muted",4,"ngIf"],["style","overflow: auto;max-height: 550px;",4,"ngIf"],[1,"dyn-bg-grey","dyn-p-20","dyn-text-muted"],[2,"overflow","auto","max-height","550px"],["mat-table","",1,"dyn-full-width",3,"dataSource"],["calendarEventsTable",""],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","created_by"],["matColumnDef","description"],["matColumnDef","event_start"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"agent-calendar-events-container"],[1,"dyn-p-t-10"],["mat-raised-button","","color","",1,"calendar-event-back-btn",3,"click"],[1,"dyn-m-t-10",3,"formGroup"],[1,"dyn-m-t-10","dyn-flex","dyn-space-between","dyn-align-items"],["for","contact",1,"dyn-full-width"],["id","contact","type","text","readonly","",1,"dyn-full-width",3,"value"],["for","name",1,"dyn-full-width"],["id","name","formControlName","name","type","text",1,"dyn-full-width"],["for","description",1,"dyn-full-width"],["id","description","type","text","formControlName","description","cols","2",1,"dyn-full-width","dyn-no-resize"],[1,"dyn-full-width"],["formControlName","type",1,"dyn-full-width"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","event_start",1,"dyn-full-width"],["id","event_start","type","text","placeholder","Event Start","formControlName","event_start",1,"dyn-full-width",3,"owlDateTime","owlDateTimeTrigger"],["hour12Timer","true"],["dt3",""],["for","event_end",1,"dyn-full-width"],["id","event_end","type","text","placeholder","Event End","formControlName","event_end",1,"dyn-full-width",3,"owlDateTime","owlDateTimeTrigger"],["dt4",""],["for","notify_on",1,"dyn-full-width"],["id","notify_on","type","text","placeholder","Notify On","formControlName","notify_on",1,"dyn-full-width",3,"owlDateTime","owlDateTimeTrigger"],["dt5",""],["mat-stroked-button","","color","",3,"click"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[1,"dyn-button-help-icon",3,"matTooltipClass","matTooltip"],[3,"ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){1&e&&(a.bd(0,js,11,2,"div",0),a.bd(1,$s,59,12,"div",1)),2&e&&(a.Bc("ngIf",!t.showCalendarEventForm),a.Pb(1),a.Bc("ngIf",t.showCalendarEventForm))},directives:[J.p,le.b,Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,Uo.h,Uo.a,ue.a,Uo.j,Uo.l,ge.a,te.B,te.q,te.i,te.d,te.p,te.h,te.y,te.t,te.A,J.o,on.b,on.d,on.a,rn.a,te.s],pipes:[J.y,J.x,J.f],styles:['.alert[_ngcontent-%COMP%]:before{content:"NEW";position:absolute;border-radius:100px;background:red;top:-5px;right:-5px;font-size:.5rem;text-align:center;line-height:13px;padding:1px 6px;color:#fff}.show-notification[_ngcontent-%COMP%]{position:relative}.show-notification[_ngcontent-%COMP%]:before{content:"";position:absolute;width:10px;height:10px;border-radius:100px;background:red;top:-2px;right:5px}']}),e})();var As=n("ZgAi"),Qs=n("eilY"),Rs=n("YobQ"),Us=n("H/Ee"),Vs=n("6uZL");function Ws(e,t){1&e&&(a.ic(0,"div",3),a.dd(1,"No Contact Selected"),a.hc())}function zs(e,t){1&e&&(a.ic(0,"div"),a.dc(1,"mat-progress-spinner",5),a.dd(2," Loading... "),a.hc())}function Hs(e,t){1&e&&(a.ic(0,"div",3),a.dd(1," No Contact history to show "),a.hc())}function Ls(e,t){1&e&&a.dc(0,"div",17)}function Xs(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(" ",e.summary," ")}}function Gs(e,t){if(1&e&&(a.ic(0,"div",19),a.ic(1,"div",20),a.ic(2,"span",21),a.dd(3),a.hc(),a.dd(4),a.hc(),a.ic(5,"div",22),a.dd(6," Status Code: "),a.ic(7,"b"),a.dd(8),a.hc(),a.hc(),a.ic(9,"div",20),a.dd(10),a.vc(11,"date"),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(3),a.fd(" ",e.details.request_type," "),a.Pb(1),a.fd(" ",e.details.url," "),a.Pb(4),a.ed(e.details.status_code),a.Pb(2),a.fd(" Created On: ",a.xc(11,4,e.details.created_on,"MMM d, y, h:mm a")," ")}}function Ys(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Campaign: ",t.agentCampaignService.campaignMap[e.details.campaign]?t.agentCampaignService.campaignMap[e.details.campaign].name:""," ")}}function Js(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Queue: ",t.agentQueueService.queueMap[e.details.queue]?t.agentQueueService.queueMap[e.details.queue].name:""," ")}}function Zs(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.hc(),a.ic(3,"div",20),a.dd(4),a.hc(),a.bd(5,Ys,2,1,"div",23),a.bd(6,Js,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(3);a.Pb(2),a.fd(" User: ",t.agentUserService.usersMap[e.details.app_user]?t.agentUserService.usersMap[e.details.app_user].full_name:e.details.app_user," "),a.Pb(2),a.fd(" Connector Button: ",t.agentConnectorService.connectorButtonMap[e.details.connector_button]?t.agentConnectorService.connectorButtonMap[e.details.connector_button].name:""," "),a.Pb(1),a.Bc("ngIf",e.details.campaign),a.Pb(1),a.Bc("ngIf",e.details.queue)}}function Ks(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.fd(" Modified On: ",a.xc(2,1,e.details.modified_on,"MMM d, y, h:mm a")," ")}}function er(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Modified By: ",t.agentUserService.usersMap[e.details.modified_by]?t.agentUserService.usersMap[e.details.modified_by].full_name:""," ")}}function tr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Created By: ",t.agentUserService.usersMap[e.details.created_by]?t.agentUserService.usersMap[e.details.created_by].full_name:""," ")}}function nr(e,t){if(1&e&&(a.ic(0,"div"),a.bd(1,Ks,3,4,"div",23),a.bd(2,er,2,1,"div",23),a.bd(3,tr,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf",e.details.modified_on),a.Pb(1),a.Bc("ngIf",e.details.modified_by),a.Pb(1),a.Bc("ngIf",e.details.created_by)}}function ir(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.fd(" Tag: ",e.details.tag_id," ")}}function cr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.fd(" Sales Funnel ID: ",e.details.sales_funnel_id," ")}}function ar(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.fd(" Sales Funnel Rule ID: ",e.details.sales_funnel_rule_id," ")}}function or(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.vc(3,"date"),a.hc(),a.ic(4,"div",20),a.dd(5),a.hc(),a.bd(6,ir,2,1,"div",23),a.bd(7,cr,2,1,"div",23),a.bd(8,ar,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(3);a.Pb(2),a.fd(" Suppress Until: ",a.xc(3,5,e.details.suppress_until,"MMM d, y, h:mm a")," "),a.Pb(3),a.fd(" Action: ",t.actionMap[e.details.action]?t.actionMap[e.details.action]:e.details.action," "),a.Pb(1),a.Bc("ngIf",e.details.tag_id),a.Pb(1),a.Bc("ngIf",e.details.sales_funnel_id),a.Pb(1),a.Bc("ngIf",e.details.sales_funnel_rule_id)}}function sr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" User: ",t.agentUserService.usersMap[e.details.app_user_id]?t.agentUserService.usersMap[e.details.app_user_id].full_name:e.details.app_user_id," ")}}function rr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",24),a.dd(2),a.hc(),a.bd(3,sr,2,1,"div",23),a.ic(4,"div",20),a.dd(5),a.hc(),a.ic(6,"div",20),a.dd(7),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(2),a.hd(" ",e.summary," ",e.details.system_post_call_update&&!e.details.system_post_sms_update?" by the system after a phone call.":""," ",!e.details.system_post_call_update&&e.details.system_post_sms_update?" by the system after an outgoing sms.":""," "),a.Pb(1),a.Bc("ngIf",e.details.app_user_id),a.Pb(2),a.fd(" Contact Field: ",e.details.field_name," "),a.Pb(2),a.fd(" Value: ",e.details.value," ")}}function dr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.hc(),a.ic(3,"div",20),a.dd(4),a.hc(),a.ic(5,"div",20),a.dd(6),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(3);a.Pb(2),a.fd(" Action: ",t.actionMap[e.details.action_id]," "),a.Pb(2),a.fd(" Action Type: ",e.details.action_type," "),a.Pb(2),a.fd(" Automation: ",t.automationMap[e.details.automation_id]," ")}}function lr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Campaign: ",t.agentCampaignService.campaignMap[e.details.campaign]?t.agentCampaignService.campaignMap[e.details.campaign].name:""," ")}}function ur(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Queue: ",t.agentQueueService.queueMap[e.details.queue]?t.agentQueueService.queueMap[e.details.queue].name:""," ")}}function gr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.hc(),a.ic(3,"div",20),a.dd(4),a.hc(),a.bd(5,lr,2,1,"div",23),a.bd(6,ur,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(3);a.Pb(2),a.fd(" User: ",t.agentUserService.usersMap[e.details.app_user]?t.agentUserService.usersMap[e.details.app_user].full_name:""," "),a.Pb(2),a.fd(" Disposition: ",t.agentContactDispositionService.contactDispositionMap[e.details.disposition]?t.agentContactDispositionService.contactDispositionMap[e.details.disposition]:e.details.disposition," "),a.Pb(1),a.Bc("ngIf",e.details.campaign),a.Pb(1),a.Bc("ngIf",e.details.queue)}}function hr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Campaign: ",t.agentCampaignService.campaignMap[e.details.campaign]?t.agentCampaignService.campaignMap[e.details.campaign].name:""," ")}}function br(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Queue: ",t.agentQueueService.queueMap[e.details.queue]?t.agentQueueService.queueMap[e.details.queue].name:""," ")}}function pr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.hc(),a.ic(3,"div",20),a.dd(4),a.hc(),a.bd(5,hr,2,1,"div",23),a.bd(6,br,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit,t=a.uc(3);a.Pb(2),a.fd(" User: ",t.agentUserService.usersMap[e.details.app_user]?t.agentUserService.usersMap[e.details.app_user].full_name:e.details.app_user," "),a.Pb(2),a.fd(" Disposition: ",t.agentCallDispositionService.callDispositionMap[e.details.disposition]?t.agentCallDispositionService.callDispositionMap[e.details.disposition]:e.details.disposition," "),a.Pb(1),a.Bc("ngIf",e.details.campaign),a.Pb(1),a.Bc("ngIf",e.details.queue)}}function vr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.fd(" System Disposition: ",e.details.system_disposition," ")}}function mr(e,t){if(1&e&&(a.ic(0,"div",20),a.dd(1),a.hc()),2&e){const e=a.uc(3).$implicit,t=a.uc(3);a.Pb(1),a.fd(" Campaign: ",t.agentCampaignService.campaignMap[e.details.campaign]?t.agentCampaignService.campaignMap[e.details.campaign].name:""," ")}}function fr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2),a.hc(),a.ic(3,"div",20),a.dd(4),a.hc(),a.ic(5,"div",20),a.dd(6),a.vc(7,"secondFormatter"),a.hc(),a.bd(8,vr,2,1,"div",23),a.bd(9,mr,2,1,"div",23),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(2),a.fd(" Source: ",e.details.source," "),a.Pb(2),a.fd(" Destination: ",e.details.destination," "),a.Pb(2),a.fd(" Duration: ",a.wc(7,5,e.details.billsec)," "),a.Pb(2),a.Bc("ngIf",e.details.system_disposition),a.Pb(1),a.Bc("ngIf",e.details.campaign)}}function Sr(e,t){1&e&&(a.gc(0),a.dd(1," Inbound "),a.ic(2,"mat-icon",25),a.dd(3,"call_received"),a.hc(),a.fc())}function _r(e,t){1&e&&(a.gc(0),a.dd(1," Outbound "),a.ic(2,"mat-icon",25),a.dd(3,"call_made"),a.hc(),a.fc())}function yr(e,t){1&e&&(a.gc(0),a.dc(1,"img",26),a.fc())}function Cr(e,t){1&e&&(a.gc(0),a.dc(1,"img",27),a.fc())}function Pr(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",20),a.dd(2," Direction: "),a.bd(3,Sr,4,0,"ng-container",2),a.bd(4,_r,4,0,"ng-container",2),a.hc(),a.ic(5,"div",20),a.dd(6," Multimedia Message: "),a.bd(7,yr,2,0,"ng-container",2),a.bd(8,Cr,2,0,"ng-container",2),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(3),a.Bc("ngIf",e.details.inbound),a.Pb(1),a.Bc("ngIf",!e.details.inbound),a.Pb(3),a.Bc("ngIf",e.details.mms),a.Pb(1),a.Bc("ngIf",!e.details.mms)}}function wr(e,t){if(1&e&&(a.gc(0),a.bd(1,Xs,2,1,"div",2),a.bd(2,Gs,12,7,"div",18),a.bd(3,Zs,7,4,"div",2),a.bd(4,nr,4,3,"div",2),a.bd(5,or,9,8,"div",2),a.bd(6,rr,8,6,"div",2),a.bd(7,dr,7,3,"div",2),a.bd(8,gr,7,4,"div",2),a.bd(9,pr,7,4,"div",2),a.bd(10,fr,10,7,"div",2),a.bd(11,Pr,9,4,"div",2),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf","historicalcontactattr"!==e.type),a.Pb(1),a.Bc("ngIf","httprequestlog"===e.type),a.Pb(1),a.Bc("ngIf","connectorbuttonclick"===e.type),a.Pb(1),a.Bc("ngIf","note"===e.type),a.Pb(1),a.Bc("ngIf","salesfunnelruleexecutionlog"===e.type),a.Pb(1),a.Bc("ngIf","historicalcontactattr"===e.type),a.Pb(1),a.Bc("ngIf","actionexecutionlog"===e.type),a.Pb(1),a.Bc("ngIf","historicalcontactdisposition"===e.type),a.Pb(1),a.Bc("ngIf","historicalcalldisposition"===e.type),a.Pb(1),a.Bc("ngIf","call"===e.type),a.Pb(1),a.Bc("ngIf","sms"===e.type)}}function Mr(e,t){if(1&e&&(a.ic(0,"option",42),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc(6);a.Bc("value",e.id),a.Pb(1),a.fd(" ",n.agentCalendarEventTypeService.calendarEventTypeMap[e.id]," ")}}function xr(e,t){if(1&e){const e=a.kc();a.ic(0,"div",31),a.ic(1,"div"),a.ic(2,"label"),a.dd(3,"Contact"),a.hc(),a.dc(4,"br"),a.dc(5,"input",32),a.hc(),a.ic(6,"div",33),a.ic(7,"label"),a.dd(8,"Type"),a.hc(),a.dc(9,"br"),a.ic(10,"select",34),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.details.type=t})),a.bd(11,Mr,2,2,"option",35),a.hc(),a.hc(),a.ic(12,"div",33),a.ic(13,"label",36),a.dd(14,"Event Start"),a.hc(),a.dc(15,"br"),a.ic(16,"input",37),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.details.event_start=t})),a.hc(),a.dc(17,"owl-date-time",38,39),a.hc(),a.ic(19,"div",33),a.ic(20,"label"),a.dd(21,"Description"),a.hc(),a.dc(22,"br"),a.ic(23,"textarea",40),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.details.description=t})),a.hc(),a.hc(),a.ic(24,"div",33),a.ic(25,"button",41),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc(3).updateCalendarEvent(t)})),a.dd(26,"Save"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.Mc(18),t=a.uc(2).$implicit,n=a.uc(3);a.Pb(5),a.Bc("value",n.agentContactService.contactSubject.value?n.agentContactService.contactSubject.value.first_name+" "+n.agentContactService.contactSubject.value.last_name:""),a.Pb(5),a.Bc("ngModel",t.details.type),a.Pb(1),a.Bc("ngForOf",n.agentCalendarEventTypeService.calendarEventTypes),a.Pb(5),a.Bc("ngModel",t.details.event_start)("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(7),a.Bc("ngModel",t.details.description),a.Pb(2),a.Bc("disabled",n.saving)}}function Br(e,t){if(1&e){const e=a.kc();a.ic(0,"button",43),a.qc("click",(function(){return a.Qc(e),a.uc(2).$implicit.expanded=!0})),a.dd(1," View "),a.ic(2,"mat-icon"),a.dd(3,"keyboard_arrow_down"),a.hc(),a.hc()}}function kr(e,t){if(1&e){const e=a.kc();a.ic(0,"button",43),a.qc("click",(function(){return a.Qc(e),a.uc(2).$implicit.expanded=!1})),a.dd(1,"Close"),a.hc()}}function Fr(e,t){if(1&e&&(a.gc(0),a.ic(1,"div"),a.dd(2),a.hc(),a.bd(3,xr,27,8,"div",28),a.ic(4,"div",29),a.bd(5,Br,4,0,"button",30),a.bd(6,kr,2,0,"button",30),a.hc(),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(2),a.ed(e.summary),a.Pb(1),a.Bc("ngIf",e.expanded),a.Pb(2),a.Bc("ngIf",!e.expanded),a.Pb(1),a.Bc("ngIf",e.expanded)}}function Ir(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.fd(" Created by: ",e.details.app_user&&t.agentUserService.usersMap[e.details.app_user]?t.agentUserService.usersMap[e.details.app_user].full_name:""," ")}}function Dr(e,t){1&e&&a.dc(0,"div")}function Tr(e,t){if(1&e&&(a.ic(0,"div",8),a.bd(1,Ls,1,0,"div",9),a.ic(2,"div",10),a.ic(3,"div",11),a.ic(4,"span",12),a.dc(5,"img",13),a.hc(),a.hc(),a.ic(6,"div",14),a.ic(7,"div",15),a.bd(8,wr,12,11,"ng-container",2),a.bd(9,Fr,7,4,"ng-container",2),a.hc(),a.ic(10,"div",16),a.ic(11,"div"),a.bd(12,Ir,2,1,"div",2),a.hc(),a.bd(13,Dr,1,0,"div",2),a.ic(14,"div"),a.dd(15),a.vc(16,"date"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()),2&e){const e=t.$implicit,n=t.last;a.Pb(1),a.Bc("ngIf",!n),a.Pb(3),a.Bc("ngClass",e.type),a.Pb(1),a.Dc("src","assets/img/agent-dash/",e.type,".svg",a.Tc),a.Pb(3),a.Bc("ngIf","calendar-event"!==e.type),a.Pb(1),a.Bc("ngIf","calendar-event"===e.type),a.Pb(3),a.Bc("ngIf",e.details.app_user&&"sms"===e.type&&!1===e.details.inbound),a.Pb(1),a.Bc("ngIf",!e.details.app_user),a.Pb(2),a.ed(a.xc(16,8,e.created_on,"MMM d y, h:mm:ss a"))}}function jr(e,t){if(1&e&&(a.ic(0,"div",6),a.bd(1,Tr,17,11,"div",7),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngForOf",e.contactHistory)}}function Or(e,t){if(1&e&&(a.gc(0),a.bd(1,zs,3,0,"div",2),a.bd(2,Hs,2,0,"div",1),a.bd(3,jr,2,1,"div",4),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.loading),a.Pb(1),a.Bc("ngIf",!e.contactHistory.length&&!e.loading),a.Pb(1),a.Bc("ngIf",e.contactHistory.length&&!e.loading)}}let Nr=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b){this._snackBar=e,this._agentNavService=t,this._contactHistoryService=n,this._calendarEventService=i,this._utils=c,this._automationService=a,this._actionService=o,this.agentContactDispositionService=s,this.agentConnectorService=r,this.agentCallDispositionService=d,this.agentUserService=l,this.agentCalendarEventTypeService=u,this.agentContactService=g,this.agentCampaignService=h,this.agentQueueService=b,this.contactHistory=[],this.automationMap=[],this.actionMap=[]}ngOnInit(){this.agentNavSubscription=this._agentNavService.activeDashboardSectionSubject.subscribe({next:e=>{"history"===e&&this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id&&this._getContactHistory()}}),this.agentContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{e&&e.id&&"history"===this._agentNavService.activeDashboardSectionSubject.value&&this._getContactHistory()}})}ngOnDestroy(){this.agentNavSubscription.unsubscribe(),this.agentContactSubscription.unsubscribe()}updateCalendarEvent(e){this.saving=!0,this._calendarEventService.update(e.id,{type:e.details.type,event_start:e.details.event_start,description:e.details.description}).subscribe({next:()=>{this.saving=!1,this._snackBar.open("Calendar Event Updated","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})},error:e=>{this.saving=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Updating Calendar Event"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}_createAutomationMap(){this._automationService.list("max").subscribe({next:e=>{e.results.forEach(e=>{this.automationMap[e.id]=e.name})}})}_createActionMap(){this._actionService.list("max").subscribe({next:e=>{e.results.forEach(e=>{this.actionMap[e.id]=e.name})}})}_getContactHistory(){this.loading=!0,this._contactHistoryService.getByContact(this.agentContactService.contactSubject.value.id).subscribe({next:e=>{this.contactHistory=[],this._createAutomationMap(),this._createActionMap(),e.forEach(e=>{e.expanded=!1,this.contactHistory.push(e)}),this.loading=!1},error:e=>{this.loading=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Contact History"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(d.a),a.bc(As.a),a.bc(Qs.a),a.bc(D.a),a.bc(Rs.a),a.bc(Us.a),a.bc(N),a.bc(j),a.bc(b.a),a.bc(g.a),a.bc(ds),a.bc(f.a),a.bc(l.a),a.bc(u.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-history"]],decls:5,vars:2,consts:[[1,"dyn-m-b-0"],["class","dyn-bg-grey dyn-p-20 dyn-text-muted",4,"ngIf"],[4,"ngIf"],[1,"dyn-bg-grey","dyn-p-20","dyn-text-muted"],["class","contact-history-timeline dyn-p-l-10 dyn-p-r-10","style","overflow: auto;max-height: 550px;",4,"ngIf"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle","dyn-m-r-10"],[1,"contact-history-timeline","dyn-p-l-10","dyn-p-r-10",2,"overflow","auto","max-height","550px"],["class","timeline-item dyn-p-t-30 dyn-relative",4,"ngFor","ngForOf"],[1,"timeline-item","dyn-p-t-30","dyn-relative"],["class","timeline-side-line",4,"ngIf"],[1,"dyn-flex"],[1,"dyn-p-t-5","dyn-text-center","dyn-m-r-30"],[1,"timeline-circle","dyn-no-shadow",3,"ngClass"],[3,"src"],[1,"dyn-full-width"],[1,"dyn-card","dyn-m-0","history-block"],[1,"dyn-flex","dyn-space-between","dyn-m-t-5","dyn-text-muted","dyn-text-sm"],[1,"timeline-side-line"],["class","item-details",4,"ngIf"],[1,"item-details"],[1,"dyn-text-xs-sm","dyn-text-muted"],[2,"background","#2a79fe","color","#fff","font-size","0.6rem","padding","3px 5px","border-radius","3px","margin-right","2px"],[1,"dyn-text-xs-sm","dyn-text-muted","dyn-m-t-5"],["class","dyn-text-xs-sm dyn-text-muted",4,"ngIf"],[1,"dyn-text-muted"],[1,"dyn-vertical-middle"],["src","/assets/img/check-icon.svg","height","18px",1,"dyn-vertical-middle"],["src","/assets/img/cancel-icon.svg","height","18px",1,"dyn-vertical-middle"],["class","dyn-m-t-20",4,"ngIf"],[1,"dyn-text-right","dyn-m-t-10","dyn-p-10","dyn-bg-grey"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"dyn-m-t-20"],["readonly","",1,"dyn-full-width",3,"value"],[1,"dyn-m-t-10"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","event_start"],["id","event_start","type","text","matInput","","placeholder","Date",1,"dyn-full-width",3,"ngModel","owlDateTime","owlDateTimeTrigger","ngModelChange"],["hour12Timer","true"],["dt3",""],[1,"dyn-full-width",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(a.ic(0,"h1"),a.dd(1,"History"),a.hc(),a.dc(2,"hr",0),a.bd(3,Ws,2,0,"div",1),a.bd(4,Or,4,3,"ng-container",2)),2&e&&(a.Pb(3),a.Bc("ngIf",!t.agentContactService.contactSubject.value),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value))},directives:[J.p,fe.a,J.o,J.n,ge.a,te.y,te.p,te.s,me.b,te.d,on.b,on.d,on.a,le.b,te.t,te.A],pipes:[J.f,Vs.a],styles:['.timeline-circle[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;width:50px;height:50px;background:#ddd;border-radius:100px;position:relative;box-shadow:0 2px 8px 0 rgba(0,0,0,.25098039215686274)}.timeline-circle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:25px;align-self:center}.timeline-circle[_ngcontent-%COMP%]:before{content:"";position:absolute;right:-30px;bottom:50%;width:28px;height:2px;background:#dce4ea}.timeline-side-line[_ngcontent-%COMP%]{position:absolute;left:30px;height:100%;width:2px;background:#dce4ea;margin-top:20px}.timeline-circle.note[_ngcontent-%COMP%]{background:#3a8bff}.timeline-circle.calendarevent[_ngcontent-%COMP%]{background:#eb4d4d}.timeline-circle.sms[_ngcontent-%COMP%]{background:#2bcce6}.timeline-circle.call[_ngcontent-%COMP%]{background:#3ddc37}.timeline-circle.goal[_ngcontent-%COMP%]{background:#e2de00}.timeline-circle.email[_ngcontent-%COMP%]{background:#97f334}.timeline-circle.case[_ngcontent-%COMP%]{background:#343cf3}.timeline-circle.connectorbuttonclick[_ngcontent-%COMP%]{background:#ff7729}.timeline-circle.opportunity[_ngcontent-%COMP%]{background:#7034f3}.timeline-circle.historicalcontactdisposition[_ngcontent-%COMP%]{background:#f7b10c}.timeline-circle.historicalcalldisposition[_ngcontent-%COMP%]{background:#215ab7}.timeline-circle.actionexecutionlog[_ngcontent-%COMP%]{background:#803ab7}.timeline-circle.salesfunnelruleexecutionlog[_ngcontent-%COMP%]{background:#3dc37a}.timeline-circle.historicalcontactattr[_ngcontent-%COMP%]{background:#24ddc4}.timeline-circle.added[_ngcontent-%COMP%]{background:#1175ee}.timeline-circle.tageventlog[_ngcontent-%COMP%], .timeline-circle.tageventlog_removed[_ngcontent-%COMP%]{background:#eb4d4d}.timeline-circle.httprequestlog[_ngcontent-%COMP%]{background:#914fe9}.history-block[_ngcontent-%COMP%]{border:2px solid #dce4ea;border-radius:7px}']}),e})();var qr=n("CU0k"),$r=n("as3Y"),Er=n("Oz8o"),Ar=n("hihj");let Qr=(()=>{class e{constructor(e,t){this._tagService=e,this._agentContactService=t,this.tagSubject=new x.a([]),this.loadingTags=!1,this.nextTagUrl="",this.tagMap=[],this.tagSearchInput=new ut.a,this.agentDashboardContactSubscription=this._agentContactService.contactSubject.subscribe({next:e=>{if(e&&e.tags&&e.tags.length){const t=new Set(this.tagSubject.value.map(e=>e.id));e.tags.filter(e=>!t.has(e)).length>0&&this._tagService.getByContact(e.id).subscribe({next:e=>{const t=[...this.tagSubject.value,...e.results];this.tagSubject.next(t),e.results.forEach(e=>{this.tagMap[e.id]=e.name})}})}}})}ngOnDestroy(){this.agentDashboardContactSubscription&&this.agentDashboardContactSubscription.unsubscribe()}loadMoreTags(){this.loadingTags=!0,this._tagService.fetchUsingNextString(""+this.nextTagUrl).subscribe({next:e=>{e.results.forEach(t=>{this.tagMap[t.id]=t.name,-1===this.tagSubject.value.findIndex(e=>e.id===t.id)&&this.tagSubject.value.push(...e.results)}),this.nextTagUrl=e.next,this.loadingTags=!1}})}getTags(){this._tagService.list(25,1).subscribe({next:e=>{this.tagSubject.next(e.results),this.nextTagUrl=e.next,e.results.forEach(e=>{this.tagMap[e.id]=e.name})}}),this.tagSearchInput.pipe(Object(gt.a)(2e3),Object(ht.a)()).subscribe(()=>this._searchTags())}tagInputValueChanged(e){this.tagSearchInput.next(e)}_searchTags(){this.loadingTags=!0,this._tagService.search(1,this.tagInput).subscribe({next:e=>{e.results.forEach(e=>{this.tagMap[e.id]=e.name}),this.loadingTags=!1,this.nextTagUrl=e.next,this.tagSubject.next(e.results)}})}}return e.\u0275fac=function(t){return new(t||e)(a.nc(Ar.a),a.nc(f.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Rr=n("7EHt");function Ur(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",t.getContactValue(e.field)," ")}}function Vr(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",a.xc(2,1,t.getContactValue(e.field),"M/d/yy")," ")}}function Wr(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",a.xc(2,1,t.getContactValue(e.field),"M/d/yy, h:mm a")," ")}}function zr(e,t){if(1&e&&(a.gc(0),a.ic(1,"div"),a.ic(2,"label"),a.dd(3),a.hc(),a.dc(4,"br"),a.gc(5,30),a.bd(6,Ur,2,1,"div",31),a.bd(7,Vr,3,4,"div",32),a.bd(8,Wr,3,4,"div",32),a.fc(),a.hc(),a.fc()),2&e){const e=t.$implicit,n=a.uc().$implicit,i=a.uc(2);a.Pb(1),a.Yc("width",2===n.length?"48%":"100%"),a.Pb(2),a.ed(e.label||i.fieldNameMap.get(e.field)),a.Pb(2),a.Bc("ngSwitch",e.type),a.Pb(2),a.Bc("ngSwitchCase","Date"),a.Pb(1),a.Bc("ngSwitchCase","Date Time")}}const Hr=function(e){return{"dyn-space-between":e}};function Lr(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",28),a.bd(2,zr,9,6,"ng-container",27),a.hc(),a.dc(3,"hr",29),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngClass",a.Gc(2,Hr,2===e.length)),a.Pb(1),a.Bc("ngForOf",e)}}function Xr(e,t){if(1&e&&(a.gc(0),a.bd(1,Lr,4,4,"ng-container",27),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.getGroupedSidebarFields())}}function Gr(e,t){if(1&e&&(a.ic(0,"div",33),a.ic(1,"div"),a.ic(2,"label"),a.dd(3,"First Name"),a.hc(),a.dc(4,"br"),a.ic(5,"div"),a.dd(6),a.hc(),a.hc(),a.ic(7,"div"),a.ic(8,"label"),a.dd(9,"Last Name"),a.hc(),a.dc(10,"br"),a.ic(11,"div"),a.dd(12),a.hc(),a.hc(),a.hc(),a.dc(13,"hr",29),a.ic(14,"div",24),a.ic(15,"label"),a.dd(16,"Address"),a.hc(),a.dc(17,"br"),a.ic(18,"div"),a.dd(19),a.hc(),a.hc(),a.dc(20,"hr",29),a.ic(21,"div",33),a.ic(22,"div"),a.ic(23,"label"),a.dd(24,"City"),a.hc(),a.dc(25,"br"),a.ic(26,"div"),a.dd(27),a.hc(),a.hc(),a.ic(28,"div"),a.ic(29,"label"),a.dd(30,"State"),a.hc(),a.dc(31,"br"),a.ic(32,"div"),a.dd(33),a.hc(),a.hc(),a.hc(),a.dc(34,"hr",29),a.ic(35,"div",33),a.ic(36,"div"),a.ic(37,"label"),a.dd(38,"Zip Code"),a.hc(),a.dc(39,"br"),a.ic(40,"div"),a.dd(41),a.hc(),a.hc(),a.ic(42,"div"),a.ic(43,"label"),a.dd(44,"Country"),a.hc(),a.dc(45,"br"),a.ic(46,"div"),a.dd(47),a.hc(),a.hc(),a.hc()),2&e){const e=a.uc();a.Pb(6),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.first_name)||""),a.Pb(6),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.last_name)||""),a.Pb(7),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.address)||""),a.Pb(8),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.city)||""),a.Pb(6),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.state)||""),a.Pb(8),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.zip_code)||""),a.Pb(6),a.ed((null==e.agentContactService.contactSubject.value?null:e.agentContactService.contactSubject.value.country)||"")}}function Yr(e,t){if(1&e){const e=a.kc();a.ic(0,"div",24),a.ic(1,"span",34),a.qc("click",(function(){return a.Qc(e),a.uc().showCreateTagDialog()})),a.dd(2," Create Tag "),a.ic(3,"mat-icon",35),a.dd(4,"add"),a.hc(),a.hc(),a.hc()}}function Jr(e,t){1&e&&(a.ic(0,"mat-icon",36),a.dd(1,"search"),a.hc())}function Zr(e,t){1&e&&a.dc(0,"mat-progress-spinner",37)}function Kr(e,t){if(1&e&&(a.ic(0,"mat-option",13),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("value",e),a.Pb(1),a.fd(" ",e.name," ")}}function ed(e,t){if(1&e&&(a.gc(0),a.bd(1,Kr,2,2,"mat-option",38),a.fc()),2&e){const e=t.$implicit,n=a.uc(2);a.Pb(1),a.Bc("ngIf",!n.agentContactService.contactSubject.value.tags.includes(e.id))}}function td(e,t){if(1&e&&(a.gc(0),a.bd(1,ed,2,1,"ng-container",27),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.agentTagService.tagSubject.value)}}function nd(e,t){1&e&&a.dc(0,"mat-progress-spinner",37)}function id(e,t){if(1&e&&(a.gc(0),a.dd(1),a.vc(2,"slice"),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.fd(" ",t.agentTagService.tagMap[e].length>30?a.yc(2,1,t.agentTagService.tagMap[e],0,15)+"..":t.agentTagService.tagMap[e]," ")}}function cd(e,t){1&e&&(a.ic(0,"mat-icon",42),a.dd(1,"cancel"),a.hc())}function ad(e,t){if(1&e){const e=a.kc();a.ic(0,"mat-chip",40),a.qc("removed",(function(){a.Qc(e);const n=t.$implicit,i=t.index;return a.uc(3).removeContactTag(n,i)})),a.bd(1,id,3,5,"ng-container",14),a.bd(2,cd,2,0,"mat-icon",41),a.hc()}if(2&e){const e=t.$implicit,n=a.uc(3);a.Pb(1),a.Bc("ngIf",n.agentTagService.tagMap.length&&n.agentTagService.tagMap[e]),a.Pb(1),a.Bc("ngIf",n.permissionService.hasPermission("contact_tag_delete"))}}function od(e,t){if(1&e&&(a.ic(0,"mat-chip-list"),a.bd(1,ad,3,2,"mat-chip",39),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngForOf",e.agentContactService.contactSubject.value.tags)}}function sd(e,t){if(1&e&&(a.ic(0,"div",20),a.bd(1,od,2,1,"mat-chip-list",14),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentContactService.contactSubject.value.tags)}}function rd(e,t){1&e&&a.dc(0,"mat-progress-spinner",37)}function dd(e,t){if(1&e){const e=a.kc();a.ic(0,"div",24),a.ic(1,"button",26),a.qc("click",(function(){return a.Qc(e),a.uc(3).agentContactService.getNextContact()})),a.bd(2,rd,1,0,"mat-progress-spinner",11),a.dd(3," Next Contact "),a.ic(4,"mat-icon"),a.dd(5,"chevron_right"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3);a.Pb(1),a.Bc("disabled",e.agentPostCallService.selectedCall.value&&e.agentPostCallService.selectedCall.value.forcePostCall||e.agentContactService.loading.value||!e.agentStatusService.agentStatusSubject.value||!e.agentStatusService.agentStatusSubject.value.campaign),a.Pb(1),a.Bc("ngIf",e.agentContactService.loading.value)}}function ld(e,t){1&e&&a.dc(0,"hr")}function ud(e,t){if(1&e){const e=a.kc();a.ic(0,"div",24),a.bd(1,ld,1,0,"hr",14),a.ic(2,"button",43),a.qc("click",(function(){return a.Qc(e),a.uc(3).nextAndCall()})),a.ic(3,"mat-icon"),a.dd(4,"phone"),a.hc(),a.dd(5," Next & Call "),a.ic(6,"mat-icon"),a.dd(7,"chevron_right"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3);a.Pb(1),a.Bc("ngIf",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].preview_next_visible),a.Pb(1),a.Bc("disabled",e.agentPostCallService.selectedCall.value&&e.agentPostCallService.selectedCall.value.forcePostCall||e.agentContactService.loading.value||!e.agentStatusService.agentStatusSubject.value||!e.agentStatusService.agentStatusSubject.value.campaign)}}function gd(e,t){if(1&e){const e=a.kc();a.ic(0,"div",24),a.ic(1,"button",43),a.qc("click",(function(){return a.Qc(e),a.uc(3).agentContactService.nextContactAndLaunchAsyncCall()})),a.ic(2,"mat-icon"),a.dd(3,"phone"),a.hc(),a.dd(4," Next & Async Call "),a.ic(5,"mat-icon"),a.dd(6,"chevron_right"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3);a.Pb(1),a.Bc("disabled",e.agentPostCallService.selectedCall.value&&e.agentPostCallService.selectedCall.value.forcePostCall||e.agentContactService.loading.value||!e.agentStatusService.agentStatusSubject.value||!e.agentStatusService.agentStatusSubject.value.campaign)}}function hd(e,t){if(1&e&&(a.gc(0),a.bd(1,dd,6,2,"div",5),a.bd(2,ud,8,2,"div",5),a.bd(3,gd,7,1,"div",5),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].preview_next_visible),a.Pb(1),a.Bc("ngIf",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].dial_next_visible),a.Pb(1),a.Bc("ngIf",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].async_dial_next_visible)}}function bd(e,t){if(1&e&&(a.gc(0),a.bd(1,hd,4,3,"ng-container",14),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value.campaign&&e.agentCampaignService.campaignMap.length)}}let pd=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p,v,m){this.snackBar=e,this.dialog=t,this.webPhoneSessionsService=n,this.contactTagService=i,this.campaignContactService=c,this.agentAccountSettingsService=a,this.utils=o,this.agentReportingStatService=s,this.agentContactFieldService=r,this.agentDashboardSettingsService=d,this.agentNoteService=l,this.permissionService=u,this.userPreferenceService=g,this.agentContactService=h,this.agentStatusService=b,this.agentPostCallService=p,this.agentCampaignService=v,this.agentTagService=m,this.selectedTag=null,this.fieldNameMap=new Map}ngOnInit(){this.agentAccountSettingsService.accountSettingsSubject.subscribe({next:e=>{this.accountSettings=e}}),this.contactFieldSubjectSubscription=this.agentContactFieldService.contactFieldSubject.subscribe(e=>{e&&e.length&&this.buildFieldNameMap()})}ngOnDestroy(){this.contactFieldSubjectSubscription.unsubscribe()}buildFieldNameMap(){this.fieldNameMap=new Map,Object.keys(this.agentContactFieldService.contactFieldMap).forEach(e=>{const t=this.agentContactFieldService.contactFieldMap[e];this.fieldNameMap.set(t.name,t.label)})}getFieldLabel(e){return this.fieldNameMap.get(e)?this.fieldNameMap.get(e):this.formatLabel(e)}formatLabel(e){return e.replace(/_/g," ").replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase())}getFieldType(e){const t=this.agentContactFieldService.contactFieldNameMap[e];return t?t.data_type:"Text"}getGroupedSidebarFields(){const e=[];let t=[];return(this.agentDashboardSettingsService.customSidebarFields||[]).forEach(n=>{n.label=this.getFieldLabel(n.field),n.type=this.getFieldType(n.field),n.full_width?(t.length&&(e.push([...t]),t=[]),e.push([n])):(t.push(n),2===t.length&&(e.push([...t]),t=[]))}),t.length&&e.push([...t]),e}getContactValue(e){var t,n;return null!==(n=null===(t=this.agentContactService.contactSubject.value)||void 0===t?void 0:t[e])&&void 0!==n?n:""}onCreateContactTag(){if(!this.selectedTag||!this.permissionService.hasPermission("contact_tag_write"))return;const e=this.agentContactService.contactSubject.value.id,t=this.agentReportingStatService.getReportingStats();t.contact=e,t.tag=this.selectedTag.id,this.contactTagService.create(t).subscribe({next:()=>{this.agentContactService.contactSubject.value.tags.push(this.selectedTag.id),this.selectedTag=null,this.snackBar.open("Tag Created","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Adding Tag"),"X",{duration:2500,verticalPosition:"top",panelClass:"error"})}})}nextAndCall(){this.agentContactService.loading.next(!0);const e=this.agentStatusService.agentStatusSubject.value.campaign;if(e){const t=this.agentContactService.checkIfUnlockContact();this.campaignContactService.get(e,t).subscribe({next:t=>{this.agentContactService.loading.next(!1),this.agentContactService.campaignContactSubject.next(t),this.agentContactService.contactSubject.next(t),this.agentContactService.assignSelectedEmailAddress(t),this.campaignContactService.lastCampaignContact.id=t.id,this.campaignContactService.lastCampaignContact.called=!0;const n=this.agentCampaignService.campaignMap[e].phone_number_field_preference;let i=0;this.agentContactService.contactSubject.value._phone_numbers.forEach((e,t)=>{e.contact_field===n&&(i=t)});const c=this.agentContactService.contactSubject.value._phone_numbers[i];if(this.agentContactService.selectedPhoneNumber=c,c.do_not_contact||c.is_fdnc)if(this.agentContactService.contactSubject.value&&1===this.agentContactService.contactSubject.value._phone_numbers.length)this.webPhoneSessionsService.call(c.phone_number);else{let e=null;this.agentContactService.contactSubject.value._phone_numbers.forEach((t,n)=>{t.is_fdnc||t.do_not_contact||(e=n)}),e?(this.agentContactService.selectedPhoneNumber=this.agentContactService.contactSubject.value._phone_numbers[e],this.webPhoneSessionsService.call(this.agentContactService.selectedPhoneNumber.phone_number)):this.webPhoneSessionsService.call(c.phone_number)}else this.webPhoneSessionsService.call(c.phone_number)},error:e=>{this.agentContactService.loading.next(!1),this.snackBar.open(this.utils.handleErrorResponse(e,"Error Getting Next Contact"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}}onSaveContact(){const e=this.agentReportingStatService.getReportingStats();this.agentContactService.saveContact(e)}removeContactTag(e,t){this.permissionService.hasPermission("contact_tag_delete")&&this.contactTagService.getByTagAndContactId(e,this.agentContactService.contactSubject.value.id).subscribe({next:e=>{e.results&&e.results.length&&this.contactTagService.delete(e.results[0].id).subscribe({next:()=>{this.agentContactService.contactSubject.value.tags.splice(t,1),this.snackBar.open("Tag Deleted","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})}})}})}showCreateTagDialog(){this.permissionService.hasPermission("contact_tag_write")?this.dialog.open(Er.a,{width:"600px",data:null}).afterClosed().subscribe({next:e=>{e&&(this.agentTagService.tagSubject.value.push(e),this.agentTagService.tagMap[e.id]=e.name,this.agentContactService.contactSubject.value&&(this.selectedTag=e))}}):this.snackBar.open('You must have the "contact_tag_write" permission to create tags',"",{duration:3e3,verticalPosition:"top",panelClass:"error"})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(Y.b),a.bc(C.a),a.bc(qr.a),a.bc($r.a),a.bc(P.a),a.bc(D.a),a.bc(w),a.bc(h.a),a.bc(nn.a),a.bc(R.a),a.bc(A.a),a.bc(q.a),a.bc(f.a),a.bc(p.a),a.bc(v.a),a.bc(l.a),a.bc(Qr))},e.\u0275cmp=a.Vb({type:e,selectors:[["dashboard-contact-side-view"]],decls:49,vars:29,consts:[[3,"multi"],[3,"expanded"],[1,"dyn-align-items"],[4,"ngIf","ngIfElse"],["defaultSidebar",""],["class","dyn-m-t-10",4,"ngIf"],[1,"dyn-flex","dyn-m-t-10"],["appearance","outline",1,"dyn-search-select","dyn-m-r-10",2,"width","135px!important"],["disableRipple","",2,"width","110px!important",3,"ngModel","disabled","ngModelChange"],[1,"dyn-flex","dyn-align-items","dyn-dropdown-search-bar"],["class","dyn-icon-sm",4,"ngIf"],["class","dyn-inline-block dyn-vertical-middle","diameter","20","mode","indeterminate",4,"ngIf"],["type","search","placeholder","Search",1,"dyn-full-width","dyn-m-l-10",2,"width","100px",3,"ngModel","keydown","ngModelChange"],[3,"value"],[4,"ngIf"],[1,"dyn-text-center","dyn-m-10"],["mat-button","","color","primary",3,"disabled","click"],["diameter","20","mode","indeterminate","class","dyn-inline-block dyn-vertical-middle",4,"ngIf"],["mat-raised-button","","color","primary","matTooltip","Add Tag",1,"add-tag",3,"disabled","click"],["class","dyn-m-t-20",4,"ngIf"],[1,"dyn-m-t-20"],["placeholder","Enter a Note","rows","4",1,"dyn-full-width","dyn-no-resize",3,"ngModel","disabled","ngModelChange","focus"],[1,"dyn-m-t-5","dyn-text-right","dyn-text-sm"],[1,"dyn-card","dyn-p-t-10","dyn-m-t-10"],[1,"dyn-m-t-10"],["matTooltip","You must have the 'contacts_write_update' permission to update & create contacts",3,"matTooltipDisabled"],["mat-raised-button","","color","primary",1,"dyn-full-width",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10",3,"ngClass"],[1,"dyn-m-t-0"],[3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10"],[1,"dyn-link","dyn-underline","dyn-text-sm",3,"click"],[1,"dyn-icon-sm","dyn-vertical-middle"],[1,"dyn-icon-sm"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[3,"value",4,"ngIf"],["removable","",3,"removed",4,"ngFor","ngForOf"],["removable","",3,"removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["mat-raised-button","","color","accent",1,"dyn-full-width",3,"disabled","click"]],template:function(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div"),a.ic(2,"mat-accordion",0),a.ic(3,"mat-expansion-panel",1),a.ic(4,"mat-expansion-panel-header"),a.ic(5,"mat-panel-title",2),a.dd(6," Contact "),a.hc(),a.hc(),a.bd(7,Xr,2,1,"ng-container",3),a.bd(8,Gr,48,7,"ng-template",null,4,a.cd),a.hc(),a.ic(10,"mat-expansion-panel"),a.ic(11,"mat-expansion-panel-header"),a.ic(12,"mat-panel-title"),a.dd(13,"Tags"),a.hc(),a.hc(),a.bd(14,Yr,5,0,"div",5),a.ic(15,"div",6),a.ic(16,"mat-form-field",7),a.ic(17,"mat-select",8),a.qc("ngModelChange",(function(e){return t.selectedTag=e})),a.ic(18,"div",9),a.bd(19,Jr,2,0,"mat-icon",10),a.bd(20,Zr,1,0,"mat-progress-spinner",11),a.ic(21,"input",12),a.qc("keydown",(function(e){return e.stopPropagation()}))("ngModelChange",(function(e){return t.agentTagService.tagInput=e}))("ngModelChange",(function(e){return t.agentTagService.tagInputValueChanged(e)})),a.hc(),a.hc(),a.dc(22,"mat-option",13),a.bd(23,td,2,1,"ng-container",14),a.ic(24,"div",15),a.ic(25,"button",16),a.qc("click",(function(){return t.agentTagService.loadMoreTags()})),a.bd(26,nd,1,0,"mat-progress-spinner",17),a.dd(27," Load More "),a.ic(28,"mat-icon"),a.dd(29,"expand_more"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(30,"div"),a.ic(31,"button",18),a.qc("click",(function(){return t.onCreateContactTag()})),a.ic(32,"mat-icon"),a.dd(33,"add"),a.hc(),a.hc(),a.hc(),a.hc(),a.bd(34,sd,2,1,"div",19),a.hc(),a.ic(35,"mat-expansion-panel"),a.ic(36,"mat-expansion-panel-header"),a.ic(37,"mat-panel-title"),a.dd(38,"Create Note"),a.hc(),a.hc(),a.ic(39,"div",20),a.ic(40,"textarea",21),a.qc("ngModelChange",(function(e){return t.agentNoteService.noteInput=e}))("focus",(function(){return t.agentNoteService.showNoteAlert=!1})),a.hc(),a.hc(),a.ic(41,"div",22),a.dd(42),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(43,"div",23),a.bd(44,bd,2,1,"ng-container",14),a.ic(45,"div",24),a.ic(46,"div",25),a.ic(47,"button",26),a.qc("click",(function(){return t.onSaveContact()})),a.dd(48),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()),2&e){const e=a.Mc(9);a.Rb(t.userPreferenceService.userPreferenceSubject.value&&"Phone Right 1"===t.userPreferenceService.userPreferenceSubject.value.agent_dashboard_layout?"dyn-m-r-20":"dyn-m-l-20"),a.Pb(2),a.Bc("multi",!0),a.Pb(1),a.Bc("expanded",!0),a.Pb(4),a.Bc("ngIf",null==t.agentDashboardSettingsService.customSidebarFields?null:t.agentDashboardSettingsService.customSidebarFields.length)("ngIfElse",e),a.Pb(7),a.Bc("ngIf",t.accountSettings&&t.accountSettings.agent_tag_create),a.Pb(3),a.Bc("ngModel",t.selectedTag)("disabled",!t.agentContactService.contactSubject.value),a.Pb(2),a.Bc("ngIf",!t.agentTagService.loadingTags),a.Pb(1),a.Bc("ngIf",t.agentTagService.loadingTags),a.Pb(1),a.Bc("ngModel",t.agentTagService.tagInput),a.Pb(1),a.Bc("value",null),a.Pb(1),a.Bc("ngIf",t.agentContactService.contactSubject.value&&t.agentContactService.contactSubject.value.tags),a.Pb(2),a.Bc("disabled",!t.agentTagService.nextTagUrl),a.Pb(1),a.Bc("ngIf",t.agentTagService.loadingTags),a.Pb(5),a.Bc("disabled",!t.agentContactService.contactSubject.value||!t.agentTagService.tagSubject.value.length||!t.permissionService.hasPermission("contact_tag_write")||null===t.selectedTag),a.Pb(3),a.Bc("ngIf",t.agentContactService.contactSubject.value),a.Pb(2),a.Tb("show-notification",t.agentNoteService.showNoteAlert),a.Pb(4),a.Bc("ngModel",t.agentNoteService.noteInput)("disabled",!t.agentContactService.contactSubject.value),a.Pb(1),a.Tb("dyn-error",t.agentNoteService.noteInput.length>1024),a.Pb(1),a.fd(" ",t.agentNoteService.noteInput.length,"/1024 "),a.Pb(2),a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value),a.Pb(2),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_write_update")),a.Pb(1),a.Bc("disabled",t.agentContactService.loading.value||!t.agentContactService.contactSubject.value||!t.permissionService.hasPermission("contacts_write_update")),a.Pb(1),a.fd(" ",t.agentContactService.contactSubject.value&&!t.agentContactService.contactSubject.value.id?"Create Contact":"Save Contact"," ")}},directives:[Rr.a,Rr.c,Rr.e,Rr.f,J.p,K.b,ee.a,te.p,te.s,te.d,ne.o,le.b,ge.a,ue.a,J.o,J.n,J.r,J.t,J.s,fe.a,Ba.c,Ba.a,Ba.d],pipes:[J.f,J.x],styles:['.mat-chip[_ngcontent-%COMP%]{font-size:.8rem;min-height:26px}.add-tag[_ngcontent-%COMP%]{line-height:30px;padding:0 7px;min-width:35px;height:28px}.add-tag[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:1.1rem}.status-dropdown[_ngcontent-%COMP%]{height:35px;outline:none;border:none;box-shadow:-2px 2px 11px 0 rgba(0,0,0,.1)}.show-notification[_ngcontent-%COMP%]{position:relative}.show-notification[_ngcontent-%COMP%]:before{content:"";position:absolute;width:10px;height:10px;border-radius:100px;background:red;top:5px;right:5px}label[_ngcontent-%COMP%]{font-size:.65rem;opacity:.75}']}),e})();const vd=function(e){return{active:e}};function md(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",3),a.qc("click",(function(){return a.Qc(e),a.uc().agentNavService.activeDashboardSectionSubject.next("history")})),a.dd(2,"History"),a.hc(),a.fc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("ngClass",a.Gc(1,vd,"history"===e.agentNavService.activeDashboardSectionSubject.value))}}const fd=function(e,t){return{active:e,alert:t}};let Sd=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u){this.agentCallDispositionService=e,this.agentNavService=t,this.userPreferenceService=n,this.agentContactService=i,this.agentAgentScriptService=c,this.agentNoteService=a,this.permissionService=o,this._agentAccountSettingsService=s,this._agentStatusService=r,this._agentCampaignService=d,this._agentQueueService=l,this._webPhoneSessionsService=u}ngOnInit(){this.agentStatusSubscription=this._agentStatusService.agentStatusSubject.subscribe({next:e=>{if(e)if(this._webPhoneSessionsService.activeSession&&this._webPhoneSessionsService.activeSession.data){const e=this._webPhoneSessionsService.activeSession.data.queueId;if(this._agentQueueService.queueMap[e]&&this._agentQueueService.queueMap[e].agent_script)return}else if(e.campaign){const t=this._agentCampaignService.campaignMap[e.campaign];t&&t.agent_script&&t.agent_script!==this.agentAgentScriptService.agentScriptIdSubject.value&&this.agentAgentScriptService.agentScriptIdSubject.next(t.agent_script)}else this._agentAccountSettingsService.accountSettings&&this.agentAgentScriptService.agentScriptIdSubject.next(this._agentAccountSettingsService.accountSettings.agent_script)}}),this.agentScriptIdSubscription=this.agentAgentScriptService.agentScriptIdSubject.subscribe({next:e=>{e&&this.agentAgentScriptService.getAgentScript(e)}}),this.accountSettingSubscription=this._agentAccountSettingsService.accountSettingsSubject.subscribe({next:e=>{var t,n,i;if(e){if(this._agentAccountSettingsService.accountSettings=e,this._agentStatusService.agentStatusSubject.value&&this._agentStatusService.agentStatusSubject.value.campaign){const e=this._agentCampaignService.campaignMap[this._agentStatusService.agentStatusSubject.value.campaign];if(e&&e.agent_script)return}if((null===(t=this._webPhoneSessionsService)||void 0===t?void 0:t.activeSession)&&(null===(i=null===(n=this._webPhoneSessionsService)||void 0===n?void 0:n.activeSession)||void 0===i?void 0:i.data)){const e=this._webPhoneSessionsService.activeSession.data.queueId;if(this._agentQueueService.queueMap[e]&&this._agentQueueService.queueMap[e].agent_script)return}e.agent_script&&this.agentAgentScriptService.agentScriptIdSubject.next(e.agent_script)}}}),this.userPreferenceSubscription=this.userPreferenceService.userPreferenceSubject.subscribe({next:e=>{e&&"agentScript"===e.agent_dash_lower_section&&this.agentAgentScriptService.formatAgentScript()}}),this.agentDashboardContactSubscription=this.agentContactService.contactSubject.subscribe({next:e=>{e&&e.id&&(this.userPreferenceService.userPreferenceSubject.value&&"agentScript"===this.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"agent-script"===this.agentNavService.activeDashboardSectionSubject.value)&&this.agentAgentScriptService.formatAgentScript()}})}ngOnDestroy(){this.accountSettingSubscription&&this.accountSettingSubscription.unsubscribe(),this.userPreferenceSubscription&&this.userPreferenceSubscription.unsubscribe(),this.agentDashboardContactSubscription&&this.agentDashboardContactSubscription.unsubscribe(),this.agentScriptIdSubscription&&this.agentScriptIdSubscription.unsubscribe(),this.agentStatusSubscription&&this.agentStatusSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(b.a),a.bc(d.a),a.bc(q.a),a.bc(f.a),a.bc(zt.a),a.bc(R.a),a.bc(A.a),a.bc(P.a),a.bc(p.a),a.bc(l.a),a.bc(u.a),a.bc(C.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-dashboard"]],decls:26,vars:31,consts:[[1,"dyn-flex"],[2,"flex","1"],["id","dashboard-nav-tabs"],["mat-button","","color","primary","disableRipple","",3,"ngClass","click"],[4,"ngIf"],[1,"dyn-card","dyn-m-0","dyn-overflow-hidden"],[3,"hidden"],[2,"width","250px"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"div",2),a.ic(3,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("contact")})),a.dd(4,"Contact"),a.hc(),a.ic(5,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("sms")})),a.dd(6,"SMS"),a.hc(),a.ic(7,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("email")})),a.dd(8,"Email"),a.hc(),a.ic(9,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("agent-script")})),a.dd(10,"Agent Script"),a.hc(),a.ic(11,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("notes")})),a.dd(12,"Notes"),a.hc(),a.ic(13,"button",3),a.qc("click",(function(){return t.agentNavService.activeDashboardSectionSubject.next("calendar-events")})),a.dd(14,"Calendar Events"),a.hc(),a.bd(15,md,3,3,"ng-container",4),a.hc(),a.ic(16,"div",5),a.dc(17,"dashboard-contact",6),a.dc(18,"dashboard-sms",6),a.dc(19,"dashboard-email",6),a.dc(20,"dashboard-agent-script",6),a.dc(21,"dashboard-notes",6),a.dc(22,"dashboard-calendar-events",6),a.dc(23,"dashboard-history",6),a.hc(),a.hc(),a.ic(24,"div",7),a.dc(25,"dashboard-contact-side-view"),a.hc(),a.hc()),2&e&&(a.Tb("dyn-row-reverse",t.userPreferenceService.userPreferenceSubject.value&&"Phone Right 1"===t.userPreferenceService.userPreferenceSubject.value.agent_dashboard_layout),a.Pb(3),a.Bc("ngClass",a.Gc(18,vd,"contact"===t.agentNavService.activeDashboardSectionSubject.value)),a.Pb(2),a.Bc("ngClass",a.Hc(20,fd,"sms"===t.agentNavService.activeDashboardSectionSubject.value,t.agentNavService.showAgentDashboardSmsAlert)),a.Pb(2),a.Bc("ngClass",a.Gc(23,vd,"email"===t.agentNavService.activeDashboardSectionSubject.value)),a.Pb(2),a.Bc("ngClass",a.Gc(25,vd,"agent-script"===t.agentNavService.activeDashboardSectionSubject.value)),a.Pb(2),a.Tb("show-notification",t.agentNoteService.showNoteAlert),a.Bc("ngClass",a.Gc(27,vd,"notes"===t.agentNavService.activeDashboardSectionSubject.value)),a.Pb(2),a.Bc("ngClass",a.Gc(29,vd,"calendar-events"===t.agentNavService.activeDashboardSectionSubject.value)),a.Pb(2),a.Bc("ngIf",t.permissionService.hasPermission("contact_history_read")),a.Pb(2),a.Bc("hidden","contact"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","sms"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","email"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","agent-script"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","notes"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","calendar-events"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(1),a.Bc("hidden","history"!==t.agentNavService.activeDashboardSectionSubject.value))},directives:[le.b,J.n,J.p,_a,bo,$o,Ro,ss,Es,Nr,pd],styles:['.alert[_ngcontent-%COMP%]:before{content:"NEW";position:absolute;border-radius:100px;background:red;top:-5px;right:-5px;font-size:.5rem;text-align:center;line-height:13px;padding:1px 6px;color:#fff}.show-notification[_ngcontent-%COMP%]{position:relative}.show-notification[_ngcontent-%COMP%]:before{content:"";position:absolute;width:10px;height:10px;border-radius:100px;background:red;top:-2px;right:5px}']}),e})();const _d=["campaignsTable"],yd=["queuesTable"];function Cd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Name "),a.hc())}function Pd(e,t){if(1&e&&(a.ic(0,"td",18),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=t.index;a.Pb(1),a.gd(" ",n+1,". ",e.name," ")}}function wd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Contacts Remaining "),a.hc())}function Md(e,t){if(1&e&&(a.ic(0,"td",18),a.dd(1),a.vc(2,"number"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.total_contact_count?a.wc(2,1,e.total_contact_count):0," ")}}function xd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Active "),a.hc())}function Bd(e,t){1&e&&(a.gc(0),a.dc(1,"img",20),a.fc())}function kd(e,t){1&e&&(a.gc(0),a.dc(1,"img",21),a.fc())}function Fd(e,t){if(1&e&&(a.ic(0,"td",18),a.bd(1,Bd,2,0,"ng-container",19),a.bd(2,kd,2,0,"ng-container",19),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.active),a.Pb(1),a.Bc("ngIf",!e.active)}}function Id(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Status "),a.hc())}const Dd=function(e,t){return{"dyn-text-green":e,"dyn-text-muted":t}};function Td(e,t){if(1&e&&(a.gc(0),a.ic(1,"span",22),a.dd(2),a.hc(),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc();a.Pb(1),a.Bc("ngClass",a.Hc(2,Dd,t.agentStatusService.agentStatusSubject.value.campaign===e.id,t.agentStatusService.agentStatusSubject.value.campaign!==e.id)),a.Pb(1),a.fd(" ",t.agentStatusService.agentStatusSubject.value.campaign===e.id?"In Campaign":"Not In"," ")}}function jd(e,t){1&e&&(a.gc(0),a.ic(1,"span",23),a.dd(2,"Not In"),a.hc(),a.fc())}function Od(e,t){if(1&e&&(a.ic(0,"td",18),a.bd(1,Td,3,5,"ng-container",19),a.bd(2,jd,3,0,"ng-container",19),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value),a.Pb(1),a.Bc("ngIf",!e.agentStatusService.agentStatusSubject.value)}}function Nd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Controls "),a.hc())}function qd(e,t){if(1&e){const e=a.kc();a.ic(0,"button",27),a.qc("click",(function(){return a.Qc(e),a.uc(4).exitCurrentCampaign()})),a.dd(1,"Exit Campaign"),a.hc()}if(2&e){const e=a.uc(4);a.Bc("disabled",!e.permissionService.hasPermission("campaign_agent_join_exit"))}}function $d(e,t){1&e&&(a.ic(0,"span",28),a.ic(1,"button",29),a.dd(2,"Join Campaign"),a.hc(),a.hc())}function Ed(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",24),a.bd(2,qd,2,1,"button",25),a.hc(),a.bd(3,$d,3,0,"span",26),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc();a.Pb(1),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("campaign_agent_join_exit")),a.Pb(1),a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value.campaign===e.id),a.Pb(1),a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value.campaign!==e.id)}}function Ad(e,t){1&e&&(a.ic(0,"span",33),a.dd(1,"(campaign is not active)"),a.hc())}function Qd(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",30),a.ic(2,"button",31),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc().joinCampaign(t)})),a.dd(3," Join Campaign "),a.hc(),a.hc(),a.bd(4,Ad,2,0,"span",32),a.fc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc();a.Pb(1),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("campaign_agent_join_exit")),a.Pb(1),a.Bc("disabled",!e.active||!t.permissionService.hasPermission("campaign_agent_join_exit")),a.Pb(2),a.Bc("ngIf",!e.active)}}function Rd(e,t){if(1&e&&(a.gc(0),a.bd(1,Ed,4,3,"ng-container",19),a.bd(2,Qd,5,3,"ng-container",19),a.fc()),2&e){const e=a.uc(2);a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value.campaign),a.Pb(1),a.Bc("ngIf",!e.agentStatusService.agentStatusSubject.value.campaign)}}function Ud(e,t){if(1&e&&(a.ic(0,"td",18),a.bd(1,Rd,3,2,"ng-container",19),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value)}}function Vd(e,t){1&e&&a.dc(0,"tr",34)}function Wd(e,t){1&e&&a.dc(0,"tr",35)}function zd(e,t){1&e&&(a.ic(0,"p",36),a.dd(1,"No Campaigns to Show"),a.hc())}function Hd(e,t){1&e&&(a.ic(0,"div",37),a.dc(1,"mat-progress-spinner",38),a.dd(2," Loading... "),a.hc())}function Ld(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Name "),a.hc())}function Xd(e,t){if(1&e&&(a.ic(0,"td",18),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=t.index;a.Pb(1),a.gd(" ",n+1,". ",e.name," ")}}function Gd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Status "),a.hc())}function Yd(e,t){if(1&e&&(a.gc(0),a.ic(1,"span",22),a.dd(2),a.hc(),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc();a.Pb(1),a.Bc("ngClass",a.Hc(2,Dd,t.agentQueueService.isAgentInQueue(e.id)||t.agentQueueService.isAgentStaticMember(e.id),!t.agentQueueService.isAgentInQueue(e.id)&&!t.agentQueueService.isAgentStaticMember(e.id))),a.Pb(1),a.fd(" ",t.agentQueueService.isAgentInQueue(e.id)||t.agentQueueService.isAgentStaticMember(e.id)?"In Queue":"Not In"," ")}}function Jd(e,t){1&e&&(a.gc(0),a.ic(1,"span",23),a.dd(2,"Not In"),a.hc(),a.fc())}function Zd(e,t){if(1&e&&(a.ic(0,"td",18),a.bd(1,Yd,3,5,"ng-container",19),a.bd(2,Jd,3,0,"ng-container",19),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentQueueService.queueAgents.length),a.Pb(1),a.Bc("ngIf",!e.agentQueueService.queueAgents.length)}}function Kd(e,t){1&e&&(a.ic(0,"th",17),a.dd(1," Controls "),a.hc())}function el(e,t){1&e&&(a.gc(0),a.ic(1,"button",29),a.dd(2,"STATIC MEMBER"),a.hc(),a.fc())}function tl(e,t){if(1&e){const e=a.kc();a.ic(0,"button",42),a.qc("click",(function(){a.Qc(e);const t=a.uc(3).$implicit;return a.uc().agentQueueService.createQueueAgent(t.id)})),a.dd(1,"Join Queue"),a.hc()}}function nl(e,t){if(1&e){const e=a.kc();a.ic(0,"button",43),a.qc("click",(function(){a.Qc(e);const t=a.uc(3).$implicit;return a.uc().agentQueueService.deleteQueueAgent(t.id)})),a.dd(1,"Exit Queue"),a.hc()}}function il(e,t){if(1&e&&(a.gc(0),a.bd(1,tl,2,0,"button",40),a.bd(2,nl,2,0,"button",41),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc();a.Pb(1),a.Bc("ngIf",!t.agentQueueService.isAgentInQueue(e.id)),a.Pb(1),a.Bc("ngIf",t.agentQueueService.isAgentInQueue(e.id))}}function cl(e,t){if(1&e){const e=a.kc();a.ic(0,"span",44),a.dd(1," Currently Paused "),a.ic(2,"button",45),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc().agentQueueService.unPauseQueueAgent(t.id)})),a.dd(3),a.hc(),a.hc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc();a.Pb(2),a.Bc("disabled",t.agentQueueService.queueAgentBeingResumed===e.id),a.Pb(1),a.fd(" ",t.agentQueueService.queueAgentBeingResumed===e.id?"Resuming...":"Resume"," ")}}function al(e,t){if(1&e&&(a.gc(0),a.bd(1,el,3,0,"ng-container",19),a.bd(2,il,3,2,"ng-container",19),a.bd(3,cl,4,2,"span",39),a.fc()),2&e){const e=a.uc().$implicit,t=a.uc();a.Pb(1),a.Bc("ngIf",t.agentQueueService.isAgentStaticMember(e.id)),a.Pb(1),a.Bc("ngIf",!t.agentQueueService.isAgentStaticMember(e.id)),a.Pb(1),a.Bc("ngIf",t.agentQueueService.isQueueAgentPaused(e.id))}}function ol(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",42),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc().joinQueue(t)})),a.dd(2," Join Queue "),a.hc(),a.fc()}}function sl(e,t){if(1&e&&(a.ic(0,"td",18),a.bd(1,al,4,3,"ng-container",19),a.bd(2,ol,3,0,"ng-container",19),a.hc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentQueueService.queueAgents.length),a.Pb(1),a.Bc("ngIf",!e.agentQueueService.queueAgents.length)}}function rl(e,t){1&e&&a.dc(0,"tr",34)}function dl(e,t){1&e&&a.dc(0,"tr",35)}function ll(e,t){1&e&&(a.ic(0,"p",36),a.dd(1,"No Queues to Show"),a.hc())}function ul(e,t){1&e&&(a.ic(0,"div",37),a.dc(1,"mat-progress-spinner",38),a.dd(2," Loading... "),a.hc())}const gl=function(){return["name","status","controls"]};let hl=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r){this.snackBar=e,this.utils=t,this.agentNavService=n,this._agentAccountSettingService=i,this._myAgentStatusService=c,this.agentCampaignService=a,this.agentQueueService=o,this.permissionService=s,this.agentStatusService=r,this.campaignTableColumns=["name","active","status","controls"],this.campaignChangeSubscription=this.agentCampaignService.campaignsUpdatedSubject.subscribe(e=>{e&&this.campaignsTable.renderRows()}),this.queueChangeSubscription=this.agentQueueService.queuesUpdatedSubject.subscribe(e=>{e&&this.queuesTable.renderRows()})}ngOnInit(){this.agentNavSubscription=this.agentNavService.activeTopSectionSubject.subscribe({next:e=>{"campaigns-queues"===e&&(this.agentCampaignService.getCampaigns(),this.agentQueueService.getQueues())}}),this.accountSettingSubscription=this._agentAccountSettingService.accountSettingsSubject.subscribe({next:e=>{e&&e.agent_contact_count_visible&&(this.campaignTableColumns=["name","contacts_remaining","active","status","controls"])}})}ngOnDestroy(){this.agentNavSubscription.unsubscribe(),this.campaignChangeSubscription.unsubscribe(),this.queueChangeSubscription.unsubscribe(),this.accountSettingSubscription.unsubscribe()}exitCurrentCampaign(){this.permissionService.hasPermission("campaign_agent_join_exit")?this.agentStatusService.updateAgentStatus({campaign:null}):this.snackBar.open("Error: You are missing the campaign_agent_join_exit permission","",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}joinQueue(e){this.permissionService.hasPermission("contacts_read")?(this.agentQueueService.createQueueAgent(e.id),this.agentStatusService.updateAgentStatus({agent_status:e.ready_status,ready:!0})):this.snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}joinCampaign(e){if(!this.permissionService.hasPermission("contacts_read"))return void this.snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]});if(!this.permissionService.hasPermission("campaign_agent_join_exit"))return void this.snackBar.open("Error: You are missing the campaign_agent_join_exit permission","",{duration:3e3,verticalPosition:"top",panelClass:["error"]});if(!this.agentStatusService.getUserId())return void console.error("No agent id found");const t={campaign:e.id,agent_status:e.ready_status,ready:!0};this._myAgentStatusService.update(this.agentStatusService.getUserId(),t).subscribe({next:e=>{this.agentStatusService.agentStatusSubject.next(e),this.agentNavService.activeTopSectionSubject.next("dashboard")},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Joining Campaign"),"",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(k.a),a.bc(D.a),a.bc(d.a),a.bc(P.a),a.bc(Q.a),a.bc(l.a),a.bc(u.a),a.bc(A.a),a.bc(p.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-campaigns-queues"]],viewQuery:function(e,t){var n;1&e&&(a.Wc(_d,!0),a.Wc(yd,!0)),2&e&&(a.Lc(n=a.rc())&&(t.campaignsTable=n.first),a.Lc(n=a.rc())&&(t.queuesTable=n.first))},decls:43,vars:12,consts:[[1,"dyn-card","dyn-m-0"],[1,"dyn-m-b-0","dyn-m-t-0"],["mat-table","",1,"dyn-full-width",3,"dataSource"],["campaignsTable",""],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","contacts_remaining"],["matColumnDef","active"],["matColumnDef","status"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","dyn-text-center",4,"ngIf"],["class","dyn-p-20",4,"ngIf"],[1,"dyn-m-t-40"],["queuesTable",""],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["src","/assets/img/check-icon.svg",1,"dyn-vertical-middle"],["src","/assets/img/cancel-icon.svg",1,"dyn-vertical-middle"],[3,"ngClass"],[1,"dyn-text-muted"],["matTooltip","You must have the 'campaign_agent_join_exit' permission to exit a campaign",1,"dyn-inline-block",3,"matTooltipDisabled"],["mat-button","","color","warn",3,"disabled","click",4,"ngIf"],["matTooltip","You can only join one campaign",4,"ngIf"],["mat-button","","color","warn",3,"disabled","click"],["matTooltip","You can only join one campaign"],["mat-button","","disabled",""],["matTooltip","You must have the 'campaign_agent_join_exit' permission to join a campaign",1,"dyn-inline-block",3,"matTooltipDisabled"],["mat-button","","color","primary",3,"disabled","click"],["class","dyn-text-sm dyn-text-muted dyn-m-l-10",4,"ngIf"],[1,"dyn-text-sm","dyn-text-muted","dyn-m-l-10"],["mat-header-row",""],["mat-row",""],[1,"dyn-text-center"],[1,"dyn-p-20"],["mode","indeterminate","diameter","20",1,"dyn-inline-block","dyn-vertical-middle"],["class","dyn-m-l-10","style","background: #EFF3F6;border-radius: 3px;display: inline-block;padding: 4px 10px;color: #56636d;",4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],[1,"dyn-m-l-10",2,"background","#EFF3F6","border-radius","3px","display","inline-block","padding","4px 10px","color","#56636d"],[2,"background","#2a79fe","border","none","color","#fff","border-radius","3px","margin-left","3px","font-size",".8rem",3,"disabled","click"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"h1"),a.dd(2,"Campaigns"),a.hc(),a.dc(3,"hr",1),a.ic(4,"table",2,3),a.gc(6,4),a.bd(7,Cd,2,0,"th",5),a.bd(8,Pd,2,2,"td",6),a.fc(),a.gc(9,7),a.bd(10,wd,2,0,"th",5),a.bd(11,Md,3,3,"td",6),a.fc(),a.gc(12,8),a.bd(13,xd,2,0,"th",5),a.bd(14,Fd,3,2,"td",6),a.fc(),a.gc(15,9),a.bd(16,Id,2,0,"th",5),a.bd(17,Od,3,2,"td",6),a.fc(),a.gc(18,10),a.bd(19,Nd,2,0,"th",5),a.bd(20,Ud,2,1,"td",6),a.fc(),a.bd(21,Vd,1,0,"tr",11),a.bd(22,Wd,1,0,"tr",12),a.hc(),a.bd(23,zd,2,0,"p",13),a.bd(24,Hd,3,0,"div",14),a.ic(25,"h1",15),a.dd(26,"Queues"),a.hc(),a.dc(27,"hr",1),a.ic(28,"table",2,16),a.gc(30,4),a.bd(31,Ld,2,0,"th",5),a.bd(32,Xd,2,2,"td",6),a.fc(),a.gc(33,9),a.bd(34,Gd,2,0,"th",5),a.bd(35,Zd,3,2,"td",6),a.fc(),a.gc(36,10),a.bd(37,Kd,2,0,"th",5),a.bd(38,sl,3,2,"td",6),a.fc(),a.bd(39,rl,1,0,"tr",11),a.bd(40,dl,1,0,"tr",12),a.hc(),a.bd(41,ll,2,0,"p",13),a.bd(42,ul,3,0,"div",14),a.hc()),2&e&&(a.Pb(4),a.Bc("dataSource",t.agentCampaignService.campaignsShownOnTable),a.Pb(17),a.Bc("matHeaderRowDef",t.campaignTableColumns),a.Pb(1),a.Bc("matRowDefColumns",t.campaignTableColumns),a.Pb(1),a.Bc("ngIf",!t.agentCampaignService.campaignsShownOnTable.length&&!t.agentCampaignService.loading),a.Pb(1),a.Bc("ngIf",t.agentCampaignService.loading),a.Pb(4),a.Bc("dataSource",t.agentQueueService.queuesShownOnTable),a.Pb(11),a.Bc("matHeaderRowDef",a.Fc(10,gl)),a.Pb(1),a.Bc("matRowDefColumns",a.Fc(11,gl)),a.Pb(1),a.Bc("ngIf",!t.agentQueueService.queuesShownOnTable.length&&!t.agentQueueService.loading),a.Pb(1),a.Bc("ngIf",t.agentQueueService.loading))},directives:[Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,J.p,Uo.h,Uo.a,J.n,ue.a,le.b,Uo.j,Uo.l,fe.a],pipes:[J.g],encapsulation:2}),e})(),bl=(()=>{class e{constructor(e){this.http=e}list(e,t){return this.http.get(t?`/api/myconversations/?page=${t}&page_size=${e}`:"/api/myconversations/?page_size="+e)}getByContact(e){return this.http.get(`/api/myconversations/${e}/`)}delete(e){return this.http.delete(`/api/myconversations/${e}/`)}filter(e,t,n){let i=`?page=${t}&page_size=${e}`;return Object.keys(n).forEach(e=>{null!==n[e]&&""!==n[e]&&(i+="&"+e+"="+n[e])}),this.http.get("/api/myconversations/"+i)}update(e,t){return this.http.patch(`/api/myconversations/${e}/`,t)}}return e.\u0275fac=function(t){return new(t||e)(a.nc(W.b))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var pl=n("b3De");function vl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Contact"),a.hc())}function ml(e,t){if(1&e){const e=a.kc();a.ic(0,"td",25),a.ic(1,"span",26),a.dd(2),a.hc(),a.ic(3,"mat-menu",null,27),a.ic(5,"button",28),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().openContact(n)})),a.dd(6,"Open Contact"),a.hc(),a.ic(7,"button",28),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().viewContactOnDashboard(n.contact,n)})),a.dd(8,"View on Dashboard"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.Mc(4);a.Pb(1),a.Bc("mat-menu-trigger-for",n),a.Pb(1),a.fd(" ",e.contact," ")}}function fl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," First Name "),a.hc())}function Sl(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.first_name)}}function _l(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Last Name "),a.hc())}function yl(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.last_name)}}function Cl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Phone Number "),a.hc())}function Pl(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.phone_number_str)}}function wl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," User "),a.hc())}function Ml(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",e.app_user&&n.agentUserService.usersMap[e.app_user]?n.agentUserService.usersMap[e.app_user].full_name:""," ")}}function xl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Needs Attention "),a.hc())}function Bl(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(a.xc(2,1,e.needs_attention_since,"MMM d, y, h:mm a"))}}function kl(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Last Message "),a.hc())}function Fl(e,t){if(1&e&&(a.ic(0,"td",25),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(a.xc(2,1,e.last_message,"MMM d, y, h:mm a"))}}function Il(e,t){1&e&&(a.ic(0,"th",24),a.dd(1," Controls "),a.hc())}function Dl(e,t){if(1&e){const e=a.kc();a.ic(0,"td",25),a.ic(1,"button",29),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().onViewConversation(n)})),a.dd(2,"View"),a.hc(),a.ic(3,"button",30),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().onDeleteConversation(n)})),a.dd(4,"Delete"),a.hc(),a.hc()}}function Tl(e,t){1&e&&a.dc(0,"tr",31)}const jl=function(e){return{alert:e}};function Ol(e,t){if(1&e&&a.dc(0,"tr",32),2&e){const e=t.$implicit;a.Tb("even",t.even),a.Bc("ngClass",a.Gc(3,jl,e.unread))}}function Nl(e,t){if(1&e){const e=a.kc();a.ic(0,"paginator",33),a.qc("updatePerPage",(function(t){return a.Qc(e),a.uc().updateResultsPerPage(t)}))("goPage",(function(t){return a.Qc(e),a.uc().goToPage(t)})),a.hc()}if(2&e){const e=a.uc();a.Bc("showPaginationLoader",e.paginator.showPaginationLoader)("totalCount",e.paginator.totalCount)("perPage",e.paginator.resultsPerPage)("currentPage",e.paginator.currentPage)("prevButton",e.paginator.prevButton)("nextButton",e.paginator.nextButton)}}function ql(e,t){1&e&&(a.ic(0,"div",34),a.dc(1,"img",35),a.ic(2,"h3",7),a.dd(3,"No Conversations to show"),a.hc(),a.hc())}function $l(e,t){1&e&&(a.ic(0,"div",36),a.dc(1,"mat-progress-spinner",37),a.dd(2," Loading... "),a.hc())}let El=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r){this.utils=e,this.dialog=t,this.snackBar=n,this.authService=i,this.agentNavService=c,this.agentContactService=a,this.agentUserService=o,this.permissionService=s,this.myConversationsService=r,this.conversations=[],this.displayedColumns=["contact_id","first_name","last_name","phone_number","user","needs_attention","last_message","controls"],this.timerCount=0,this.paginator={showPaginationLoader:!1,totalCount:null,prevButton:"",nextButton:"",currentPage:1,resultsPerPage:25},this.userId=this.authService.getUserId()}ngOnInit(){$.listen(e=>{if(("incoming_sms"===e.method||"outgoing_sms"===e.method)&&(this.agentNavService.showAgentConversationAlert=!0,"conversations"===this.agentNavService.activeTopSectionSubject.value&&e.contact_id)){const t=this.conversations.findIndex(t=>t.contact===e.contact_id);-1!==t&&(this.conversations[t].unread=!0)}}),this.agentDashboardNavSubscription=this.agentNavService.activeTopSectionSubject.subscribe({next:e=>{"conversations"===e&&(!this.agentNavService.showAgentConversationAlert&&this.alreadyGotData||(this._getConversations(),this.alreadyGotData=!0,this.agentNavService.showAgentConversationAlert&&(this.agentNavService.showAgentConversationAlert=!1)))}})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe()}onDeleteConversation(e){this.dialog.open(en.a,{width:"500px",data:{title:"Are you sure you want to delete this conversation?",buttonText:"Delete"}}).afterClosed().subscribe({next:t=>{t&&this.myConversationsService.delete(e.contact).subscribe({next:()=>{this.refreshConversationsTable(),this.snackBar.open("Conversation Deleted Successfully","X",{duration:5e3,verticalPosition:"top",panelClass:"success"})},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Deleting Conversation"),"X",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}})}onViewConversation(e){this._userHasContactReadPermission()&&this.dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"SMS",contactIds:[e.contact],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&"viewOnDashboard"===t&&(this.agentContactService.getContact(e.contact),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact")),this.myConversationsService.update(e.contact,{unread:!1}).subscribe({next:()=>{const t=this.conversations.findIndex(t=>t.contact===e.contact);this.conversations[t]&&(this.conversations[t].unread=!1)}})}})}goToPage(e){this.paginator.currentPage=e,this._getConversations()}updateResultsPerPage(e){this.paginator.currentPage=1,this.paginator.resultsPerPage=e,this._getConversations()}openContact(e){this._userHasContactReadPermission()&&this.dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"SMS",contactIds:[e.contact],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{if(e.unread){const t=this.conversations.findIndex(t=>t.contact===e.contact);this.conversations[t]&&(this.conversations[t].unread=!1),this.agentNavService.showAgentConversationAlert=!1}t&&"viewOnDashboard"===t&&(this.agentContactService.getContact(e.contact),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact"))}})}refreshConversationsTable(){this.timerInterval||(this.loading=!0,this.myConversationsService.list(this.paginator.resultsPerPage,this.paginator.currentPage).subscribe({next:e=>{this.conversations=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.loading=!1,this.timerInterval=setInterval(()=>{this.timerCount++,this.timerCount>=15&&(clearInterval(this.timerInterval),this.timerInterval=null,this.timerCount=0)},1e3)}}))}viewContactOnDashboard(e,t){if(!this._userHasContactReadPermission())return;const n=this.agentContactService.contactSubject.value;(!n||n&&n.id!==e)&&this.agentContactService.getContact(e),t.unread=!1,this.myConversationsService.update(t.contact,{unread:!1}).subscribe(),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("sms")}_userHasContactReadPermission(){return!!this.permissionService.hasPermission("contacts_read")||(this.snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}),!1)}_getConversations(){this.loading=!0,this.myConversationsService.list(this.paginator.resultsPerPage,this.paginator.currentPage).subscribe({next:e=>{this.conversations=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.loading=!1}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(D.a),a.bc(Y.b),a.bc(k.a),a.bc(r.a),a.bc(d.a),a.bc(f.a),a.bc(g.a),a.bc(A.a),a.bc(bl))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-conversations"]],decls:42,vars:6,consts:[[1,"dyn-card","dyn-m-0"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-m-b-0"],[1,"dyn-text-muted","dyn-m-0"],[1,"dyn-p-t-15"],["mat-mini-fab","","color","","matTooltip","Refresh Table",1,"dyn-no-shadow","refresh-btn",3,"click"],["color","primary"],[1,"dyn-m-t-10","dyn-m-b-10"],["mat-table","",1,"dyn-full-width",3,"dataSource"],["matColumnDef","contact_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","first_name"],["matColumnDef","last_name"],["matColumnDef","phone_number"],["matColumnDef","user"],["matColumnDef","needs_attention"],["matColumnDef","last_message"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","dyn-table-hover",3,"even","ngClass",4,"matRowDef","matRowDefColumns"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage",4,"ngIf"],["class","dyn-text-center dyn-m-t-50 dyn-m-b-50",4,"ngIf"],["class","dyn-m-t-20",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"dyn-link","dyn-underline",3,"mat-menu-trigger-for"],["contactMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row","",1,"dyn-table-hover",3,"ngClass"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage"],[1,"dyn-text-center","dyn-m-t-50","dyn-m-b-50"],["src","/assets/img/warning-icon.svg",2,"height","60px"],[1,"dyn-m-t-20"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"div"),a.ic(3,"h1",2),a.dd(4,"SMS Conversations"),a.hc(),a.ic(5,"p",3),a.dd(6," SMS Conversations with unresponded to inbound texts will become available to other agents after a set amount of time. "),a.hc(),a.hc(),a.ic(7,"div",4),a.ic(8,"button",5),a.qc("click",(function(){return t.refreshConversationsTable()})),a.ic(9,"mat-icon",6),a.dd(10,"refresh"),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(11,"hr",7),a.ic(12,"table",8),a.gc(13,9),a.bd(14,vl,2,0,"th",10),a.bd(15,ml,9,2,"td",11),a.fc(),a.gc(16,12),a.bd(17,fl,2,0,"th",10),a.bd(18,Sl,2,1,"td",11),a.fc(),a.gc(19,13),a.bd(20,_l,2,0,"th",10),a.bd(21,yl,2,1,"td",11),a.fc(),a.gc(22,14),a.bd(23,Cl,2,0,"th",10),a.bd(24,Pl,2,1,"td",11),a.fc(),a.gc(25,15),a.bd(26,wl,2,0,"th",10),a.bd(27,Ml,2,1,"td",11),a.fc(),a.gc(28,16),a.bd(29,xl,2,0,"th",10),a.bd(30,Bl,3,4,"td",11),a.fc(),a.gc(31,17),a.bd(32,kl,2,0,"th",10),a.bd(33,Fl,3,4,"td",11),a.fc(),a.gc(34,18),a.bd(35,Il,2,0,"th",10),a.bd(36,Dl,5,0,"td",11),a.fc(),a.bd(37,Tl,1,0,"tr",19),a.bd(38,Ol,1,5,"tr",20),a.hc(),a.bd(39,Nl,1,6,"paginator",21),a.bd(40,ql,4,0,"div",22),a.bd(41,$l,3,0,"div",23),a.hc()),2&e&&(a.Pb(12),a.Bc("dataSource",t.conversations),a.Pb(25),a.Bc("matHeaderRowDef",t.displayedColumns),a.Pb(1),a.Bc("matRowDefColumns",t.displayedColumns),a.Pb(1),a.Bc("ngIf",t.conversations.length&&!t.loading),a.Pb(1),a.Bc("ngIf",!t.conversations.length&&!t.loading),a.Pb(1),a.Bc("ngIf",t.loading))},directives:[le.b,ue.a,ge.a,Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,J.p,Uo.h,Uo.a,cn.e,cn.f,cn.c,Uo.j,Uo.l,J.n,pl.a,fe.a],pipes:[J.f],styles:['.mat-row.alert[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{position:relative}.mat-row.alert[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child:before{content:"NEW";position:absolute;border-radius:100px;background:red;top:7px;left:-15px;font-size:.5rem;text-align:center;line-height:13px;padding:1px 6px;color:#fff}']}),e})();var Al=n("Kpx/"),Ql=n("SXCX"),Rl=n("TGtB");let Ul=(()=>{class e{constructor(e){this.bucketService=e,this.bucketSubject=new x.a([]),this.bucketMap=[]}getBuckets(){this.bucketService.list("max").subscribe({next:e=>{this.bucketSubject.next(e.results),e.results.forEach(e=>{this.bucketMap[e.id]=e})}})}}return e.\u0275fac=function(t){return new(t||e)(a.nc(Rl.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Vl=n("20Vn"),Wl=n("hn12"),zl=n("0EQZ"),Hl=n("WxqE"),Ll=n("QibW"),Xl=n("bSwM");const Gl=["filterDropdownBody"],Yl=["mainContent"],Jl=["contactsTable"];function Zl(e,t){1&e&&(a.ic(0,"div",61),a.ic(1,"mat-icon",62),a.dd(2,"warning"),a.hc(),a.dd(3," Permission "),a.ic(4,"strong"),a.dd(5,"contacts_read"),a.hc(),a.dd(6," is required to view contacts.\n"),a.hc())}function Kl(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.internal_value),a.Pb(1),a.ed(e.external_value)}}function eu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",63),a.dd(3),a.hc(),a.dc(4,"br"),a.ic(5,"select",64),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t})),a.dc(6,"option",21),a.bd(7,Kl,2,2,"option",65),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(2),a.Dc("for","",e.name,"-picklist"),a.Pb(1),a.ed(e.label),a.Pb(2),a.Dc("id","",e.name,"-picklist"),a.Bc("ngModel",e.value),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",e.choices)}}function tu(e,t){if(1&e&&(a.ic(0,"mat-option",71),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.abbr),a.Pb(1),a.gd(" ",e.state," - ",e.abbr," ")}}function nu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",66),a.dd(3),a.hc(),a.dc(4,"br"),a.ic(5,"input",67),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc(4);return t.preventDefault(),n.filterContacts()}))("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t}))("ngModelChange",(function(){a.Qc(e);const t=a.uc(3).$implicit;return a.uc().filterStates(t.value)})),a.hc(),a.ic(6,"mat-autocomplete",68,69),a.bd(8,tu,2,3,"mat-option",70),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.Mc(7),t=a.uc(3).$implicit,n=a.uc();a.Pb(3),a.ed(t.label),a.Pb(2),a.Bc("ngModel",t.value)("matAutocomplete",e),a.Pb(3),a.Bc("ngForOf",n.filteredStates)}}function iu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",72),a.dd(3),a.vc(4,"slice"),a.hc(),a.dc(5,"br"),a.ic(6,"input",73),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(4);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit;a.Pb(2),a.Dc("for","",e.name,"-text"),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(4,6,e.label,0,20)+"..":e.label,""),a.Pb(3),a.Dc("id","",e.name,"-text"),a.Bc("ngModel",e.value)}}function cu(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.app_user),a.Pb(1),a.ed(e.full_name)}}function au(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",74),a.dd(3),a.vc(4,"slice"),a.hc(),a.dc(5,"br"),a.ic(6,"div",75),a.ic(7,"select",76),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(4).$implicit.value=t})),a.dc(8,"option",21),a.bd(9,cu,2,2,"option",65),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(4).$implicit,t=a.uc();a.Pb(2),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(4,8,e.label,0,20)+"..":e.label," "),a.Pb(3),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_read_all")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_read_all"))("ngModel",e.value),a.Pb(1),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentUserService.users)}}function ou(e,t){if(1&e&&(a.gc(0),a.bd(1,au,10,12,"ng-container",40),a.fc()),2&e){const e=a.uc(4);a.Pb(1),a.Bc("ngIf",e.accountSettings&&!0===e.accountSettings.agent_query_all_contacts)}}function su(e,t){if(1&e&&(a.ic(0,"span",82),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.gd(" (+",e.value.length-1," ",2===(null==e.value?null:e.value.length)?"other":"others",") ")}}function ru(e,t){if(1&e&&(a.ic(0,"mat-option",83),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e),a.Pb(1),a.fd(" ",e," ")}}function du(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",77),a.dd(3),a.vc(4,"slice"),a.hc(),a.ic(5,"mat-form-field",78),a.ic(6,"mat-select",79),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t})),a.ic(7,"mat-select-trigger"),a.dd(8),a.bd(9,su,2,2,"span",80),a.hc(),a.bd(10,ru,2,2,"mat-option",81),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(2),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<36),a.Pb(1),a.fd(" ",e.label.length>36?a.yc(4,7,e.label,0,36)+"..":e.label," "),a.Pb(3),a.Bc("ngModel",e.value),a.Pb(2),a.fd(" ",e.value?e.value[0]:""," "),a.Pb(1),a.Bc("ngIf",(null==e.value?null:e.value.length)>1),a.Pb(1),a.Bc("ngForOf",t.systemDispositions)}}function lu(e,t){if(1&e&&(a.gc(0),a.bd(1,nu,9,4,"ng-container",40),a.bd(2,iu,7,10,"ng-container",40),a.bd(3,ou,2,1,"ng-container",40),a.bd(4,du,11,11,"ng-container",40),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","state"===e.name),a.Pb(1),a.Bc("ngIf","system_disposition"!==e.name&&"state"!==e.name&&"owned_by"!==e.name),a.Pb(1),a.Bc("ngIf","owned_by"===e.name),a.Pb(1),a.Bc("ngIf","system_disposition"===e.name)}}function uu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",84),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"div",85),a.ic(6,"input",86),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.min_value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(4);return t.preventDefault(),n.filterContacts()})),a.hc(),a.ic(7,"div",87),a.dd(8,"-"),a.hc(),a.ic(9,"input",86),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.max_value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(4);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(3,5,e.label,0,20)+"..":e.label," "),a.Pb(4),a.Bc("ngModel",e.min_value),a.Pb(3),a.Bc("ngModel",e.max_value)}}function gu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",88),a.dd(3),a.vc(4,"slice"),a.hc(),a.ic(5,"input",89),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(4);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit;a.Pb(2),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<36),a.Pb(1),a.fd(" ",e.label.length>36?a.yc(4,4,e.label,0,36)+"..":e.label," "),a.Pb(2),a.Bc("ngModel",e.value)}}function hu(e,t){if(1&e&&(a.ic(0,"span",82),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.gd(" (+",e.value.length-1," ",2===(null==e.value?null:e.value.length)?"other":"others",") ")}}function bu(e,t){if(1&e&&(a.ic(0,"mat-option",83),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.id),a.Pb(1),a.fd(" ",e.name," ")}}function pu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",90),a.dd(3),a.vc(4,"slice"),a.hc(),a.ic(5,"mat-form-field",78),a.ic(6,"mat-select",91),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t})),a.ic(7,"mat-select-trigger"),a.dd(8),a.bd(9,hu,2,2,"span",80),a.hc(),a.bd(10,bu,2,2,"mat-option",81),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(2),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<36),a.Pb(1),a.fd(" ",e.label.length>36?a.yc(4,7,e.label,0,36)+"..":e.label," "),a.Pb(3),a.Bc("ngModel",e.value),a.Pb(2),a.fd(" ",e.value?t.agentContactDispositionService.contactDispositionMap[e.value[0]]:""," "),a.Pb(1),a.Bc("ngIf",(null==e.value?null:e.value.length)>1),a.Pb(1),a.Bc("ngForOf",t.agentContactDispositionService.contactDispositions)}}function vu(e,t){if(1&e&&(a.ic(0,"span",82),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.gd(" (+",e.value.length-1," ",2===(null==e.value?null:e.value.length)?"other":"others",") ")}}function mu(e,t){if(1&e&&(a.ic(0,"mat-option",83),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e.id),a.Pb(1),a.fd(" ",e.name," ")}}function fu(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div"),a.ic(2,"label",92),a.dd(3),a.vc(4,"slice"),a.hc(),a.ic(5,"mat-form-field",78),a.ic(6,"mat-select",93),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(3).$implicit.value=t})),a.ic(7,"mat-select-trigger"),a.dd(8),a.bd(9,vu,2,2,"span",80),a.hc(),a.bd(10,mu,2,2,"mat-option",81),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(3).$implicit,t=a.uc();a.Pb(2),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<36),a.Pb(1),a.fd(" ",e.label.length>36?a.yc(4,7,e.label,0,36)+"..":e.label," "),a.Pb(3),a.Bc("ngModel",e.value),a.Pb(2),a.fd(" ",e.value?t.agentCallDispositionService.callDispositionMap[e.value[0]]:""," "),a.Pb(1),a.Bc("ngIf",(null==e.value?null:e.value.length)>1),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions)}}function Su(e,t){if(1&e&&(a.gc(0),a.bd(1,uu,10,9,"div",40),a.bd(2,gu,6,8,"ng-container",40),a.bd(3,pu,11,11,"ng-container",40),a.bd(4,fu,11,11,"ng-container",40),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","disposition_id"!==e.name&&"call_disposition_id"!==e.name&&"id"!==e.name),a.Pb(1),a.Bc("ngIf","id"===e.name),a.Pb(1),a.Bc("ngIf","disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","call_disposition_id"===e.name)}}function _u(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",84),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"div",85),a.ic(6,"input",86),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.min_value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()})),a.hc(),a.ic(7,"div",87),a.dd(8,"-"),a.hc(),a.ic(9,"input",86),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.max_value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(3,5,e.label,0,20)+"..":e.label," "),a.Pb(4),a.Bc("ngModel",e.min_value),a.Pb(3),a.Bc("ngModel",e.max_value)}}function yu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",72),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"input",73),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Dc("for","",e.name,"-phonenumber"),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(3,6,e.label,0,20)+"..":e.label," "),a.Pb(3),a.Dc("id","",e.name,"-phonenumber"),a.Bc("ngModel",e.value)}}function Cu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",72),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"input",94),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t}))("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()})),a.hc(),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Dc("for","",e.name,"-email"),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(3,6,e.label,0,20)+"..":e.label," "),a.Pb(3),a.Dc("id","",e.name,"-email"),a.Bc("ngModel",e.value)}}function Pu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",72),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"input",95),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()}))("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t})),a.hc(),a.dc(6,"owl-date-time",96,97),a.hc()}if(2&e){const e=a.Mc(7),t=a.uc(2).$implicit;a.Pb(1),a.Dc("for","",t.name,"-datetime"),a.Bc("matTooltip",t.label)("matTooltipDisabled",t.label.length<20),a.Pb(1),a.fd(" ",t.label.length>20?a.yc(3,9,t.label,0,20)+"..":t.label," "),a.Pb(3),a.Dc("id","",t.name,"-datetime"),a.Bc("ngModel",t.value)("selectMode","range")("owlDateTime",e)("owlDateTimeTrigger",e)}}function wu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",72),a.dd(2),a.vc(3,"slice"),a.hc(),a.dc(4,"br"),a.ic(5,"input",95),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc(3);return t.preventDefault(),n.filterContacts()}))("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t})),a.hc(),a.dc(6,"owl-date-time",98,99),a.hc()}if(2&e){const e=a.Mc(7),t=a.uc(2).$implicit;a.Pb(1),a.Dc("for","",t.name,"-date"),a.Bc("matTooltip",t.label)("matTooltipDisabled",t.label.length<20),a.Pb(1),a.fd(" ",t.label.length>20?a.yc(3,10,t.label,0,20)+"..":t.label," "),a.Pb(3),a.Dc("id","",t.name,"-date"),a.Bc("ngModel",t.value)("selectMode","range")("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(1),a.Bc("pickerType","calendar")}}function Mu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label",72),a.dd(2),a.vc(3,"slice"),a.hc(),a.ic(4,"select",64),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc(2).$implicit.value=t})),a.dc(5,"option",21),a.ic(6,"option",100),a.dd(7,"True"),a.hc(),a.ic(8,"option",101),a.dd(9,"False"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Dc("for","",e.name,"-checkbox"),a.Bc("matTooltip",e.label)("matTooltipDisabled",e.label.length<20),a.Pb(1),a.fd(" ",e.label.length>20?a.yc(3,7,e.label,0,20)+"..":e.label," "),a.Pb(2),a.Dc("id","",e.name,"-checkbox"),a.Bc("ngModel",e.value),a.Pb(1),a.Bc("ngValue",null)}}function xu(e,t){if(1&e&&(a.gc(0),a.bd(1,eu,8,6,"ng-container",40),a.bd(2,lu,5,4,"ng-container",40),a.bd(3,Su,5,4,"ng-container",40),a.bd(4,_u,10,9,"div",40),a.bd(5,yu,6,10,"div",40),a.bd(6,Cu,6,10,"div",40),a.bd(7,Pu,8,13,"div",40),a.bd(8,wu,8,14,"div",40),a.bd(9,Mu,10,11,"div",40),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf","Picklist"===e.data_type||"Picklist Multiselect"===e.data_type),a.Pb(1),a.Bc("ngIf","Text"===e.data_type),a.Pb(1),a.Bc("ngIf","Integer"===e.data_type),a.Pb(1),a.Bc("ngIf","Decimal"===e.data_type),a.Pb(1),a.Bc("ngIf","Phone Number"===e.data_type),a.Pb(1),a.Bc("ngIf","Email Address"===e.data_type),a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type),a.Pb(1),a.Bc("ngIf","Date"===e.data_type),a.Pb(1),a.Bc("ngIf","Checkbox"===e.data_type)}}function Bu(e,t){if(1&e&&(a.gc(0),a.bd(1,xu,10,9,"ng-container",40),a.fc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("ngIf",n.filterSearchResult&&e.label.toLowerCase().includes(n.filterSearchResult.toLowerCase())||""===n.filterSearchResult)}}function ku(e,t){if(1&e&&(a.ic(0,"option",21),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngValue",e),a.Pb(1),a.ed(e.name)}}function Fu(e,t){if(1&e&&(a.gc(0),a.bd(1,ku,2,2,"option",102),a.fc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("ngIf",!n.selectedBuckets.includes(e))}}function Iu(e,t){1&e&&(a.ic(0,"p",103),a.dd(1,"No Buckets Selected."),a.hc())}function Du(e,t){if(1&e){const e=a.kc();a.ic(0,"mat-chip",104),a.qc("removed",(function(){a.Qc(e);const n=t.index,i=a.uc();return i.selectedBuckets.splice(n,1),i.selectedBucket=null})),a.dd(1),a.ic(2,"mat-icon",105),a.dd(3,"cancel"),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.fd("",e.name," ")}}function Tu(e,t){1&e&&(a.ic(0,"mat-icon",106),a.dd(1,"search"),a.hc())}function ju(e,t){1&e&&a.dc(0,"mat-progress-spinner",107)}function Ou(e,t){if(1&e&&(a.ic(0,"mat-option",31),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("value",e),a.Pb(1),a.fd(" ",e.name," ")}}function Nu(e,t){if(1&e&&(a.gc(0),a.bd(1,Ou,2,2,"mat-option",108),a.fc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("ngIf",!n.selectedTags.includes(e))}}function qu(e,t){1&e&&a.dc(0,"mat-progress-spinner",107)}function $u(e,t){1&e&&(a.ic(0,"p",103),a.dd(1,"No Tags Selected."),a.hc())}function Eu(e,t){if(1&e){const e=a.kc();a.ic(0,"mat-chip",104),a.qc("removed",(function(){a.Qc(e);const n=t.index,i=a.uc();return i.selectedTags.splice(n,1),i.selectedTag=null})),a.dd(1),a.ic(2,"mat-icon",105),a.dd(3,"cancel"),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.fd("",e.name," ")}}function Au(e,t){if(1&e){const e=a.kc();a.ic(0,"div",109),a.ic(1,"span",110),a.ic(2,"mat-radio-group",111),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().multiTagFilterMode=t})),a.ic(3,"mat-radio-button",112),a.dd(4," Contact must have at least one of these tags "),a.hc(),a.ic(5,"mat-radio-button",113),a.dd(6," Contact must have all of these tags "),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(2),a.Bc("ngModel",e.multiTagFilterMode)}}function Qu(e,t){1&e&&(a.gc(0),a.ic(1,"mat-icon",114),a.dd(2,"filter_list"),a.hc(),a.dd(3," Filter "),a.fc())}function Ru(e,t){1&e&&(a.gc(0),a.ic(1,"mat-icon",114),a.dd(2,"close"),a.hc(),a.dd(3," Close "),a.fc())}function Uu(e,t){if(1&e){const e=a.kc();a.ic(0,"button",46),a.qc("click",(function(){return a.Qc(e),a.uc().showCsvUploadDialog()})),a.ic(1,"mat-icon"),a.dd(2,"cloud_upload"),a.hc(),a.dd(3," Upload Contacts "),a.hc()}}function Vu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"mat-chip",116),a.qc("removed",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).removeFilterBucket(n)})),a.dd(2),a.ic(3,"mat-icon",105),a.dd(4,"cancel"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.Bc("removable",!0),a.Pb(1),a.fd(" Bucket: ",e.name," ")}}function Wu(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"mat-chip",116),a.qc("removed",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).removeFilterTag(n)})),a.dd(2),a.ic(3,"mat-icon",105),a.dd(4,"cancel"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.Bc("removable",!0),a.Pb(1),a.fd(" Tag: ",e.name," ")}}function zu(e,t){if(1&e&&(a.gc(0),a.ic(1,"b"),a.dd(2),a.hc(),a.fc()),2&e){const e=a.uc(3).$implicit,t=a.uc(2);a.Pb(2),a.ed(t.agentUserService.usersMap[e.value].full_name)}}function Hu(e,t){1&e&&(a.ic(0,"span"),a.dd(1,", "),a.hc())}function Lu(e,t){if(1&e&&(a.gc(0),a.ic(1,"b"),a.dd(2),a.hc(),a.bd(3,Hu,2,0,"span",40),a.fc()),2&e){const e=t.$implicit,n=t.last;a.Pb(2),a.ed(e),a.Pb(1),a.Bc("ngIf",!n)}}function Xu(e,t){if(1&e&&(a.gc(0),a.bd(1,Lu,4,2,"ng-container",17),a.fc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("ngForOf",e.value)}}function Gu(e,t){1&e&&(a.ic(0,"span"),a.dd(1,", "),a.hc())}function Yu(e,t){if(1&e&&(a.gc(0),a.ic(1,"b"),a.dd(2),a.hc(),a.bd(3,Gu,2,0,"span",40),a.fc()),2&e){const e=t.$implicit,n=t.last,i=a.uc(6);a.Pb(2),a.ed(i.agentContactDispositionService.contactDispositionMap[e]),a.Pb(1),a.Bc("ngIf",!n)}}function Ju(e,t){if(1&e&&(a.gc(0),a.bd(1,Yu,4,2,"ng-container",17),a.fc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("ngForOf",e.value)}}function Zu(e,t){1&e&&(a.ic(0,"span"),a.dd(1,", "),a.hc())}function Ku(e,t){if(1&e&&(a.gc(0),a.ic(1,"b"),a.dd(2),a.hc(),a.bd(3,Zu,2,0,"span",40),a.fc()),2&e){const e=t.$implicit,n=t.last,i=a.uc(6);a.Pb(2),a.ed(i.agentCallDispositionService.callDispositionMap[e]),a.Pb(1),a.Bc("ngIf",!n)}}function eg(e,t){if(1&e&&(a.gc(0),a.bd(1,Ku,4,2,"ng-container",17),a.fc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("ngForOf",e.value)}}function tg(e,t){if(1&e&&(a.gc(0),a.ic(1,"b"),a.dd(2),a.vc(3,"date"),a.hc(),a.dd(4),a.fc()),2&e){const e=t.$implicit,n=t.first;a.Pb(2),a.ed(a.xc(3,2,e,"MMM d, y, h:mm a")),a.Pb(2),a.fd(" ",n?" - ":""," ")}}function ng(e,t){if(1&e&&(a.gc(0),a.bd(1,tg,5,5,"ng-container",17),a.fc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("ngForOf",e.value)}}function ig(e,t){if(1&e&&(a.ic(0,"b"),a.dd(1),a.vc(2,"date"),a.vc(3,"date"),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.hd(" ",e.value[0]?a.xc(2,3,e.value[0],"MMM d, y"):""," ",e.value[0]&&e.value[1]?" - ":""," ",e.value[1]?a.xc(3,6,e.value[1],"MMM d, y"):""," ")}}function cg(e,t){if(1&e&&(a.ic(0,"b"),a.dd(1),a.vc(2,"date"),a.vc(3,"date"),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.hd(" ",e.value[0]?a.xc(2,3,e.value[0],"MMM d, y, h:mm a"):""," ",e.value[0]&&e.value[1]?" - ":""," ",e.value[1]?a.xc(3,6,e.value[1],"MMM d, y, h:mm a"):""," ")}}function ag(e,t){if(1&e&&(a.ic(0,"b"),a.dd(1),a.hc()),2&e){const e=a.uc(4).$implicit;a.Pb(1),a.fd(" ",e.value," ")}}function og(e,t){if(1&e&&(a.gc(0),a.bd(1,ig,4,9,"b",40),a.bd(2,cg,4,9,"b",40),a.bd(3,ag,2,1,"b",40),a.fc()),2&e){const e=a.uc(3).$implicit;a.Pb(1),a.Bc("ngIf","Date"===e.data_type),a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type),a.Pb(1),a.Bc("ngIf","Date"!==e.data_type&&"Date Time"!==e.data_type)}}function sg(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.bd(2,zu,3,1,"ng-container",40),a.bd(3,Xu,2,1,"ng-container",40),a.bd(4,Ju,2,1,"ng-container",40),a.bd(5,eg,2,1,"ng-container",40),a.bd(6,ng,2,1,"ng-container",40),a.bd(7,og,4,3,"ng-container",40),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(" ",e.label,": "),a.Pb(1),a.Bc("ngIf","owned_by"===e.name),a.Pb(1),a.Bc("ngIf","system_disposition_id"===e.name||"system_disposition"===e.name),a.Pb(1),a.Bc("ngIf","disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","call_disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","last_call_inbound"===e.name||"created_on"===e.name||"suppress_until"===e.name||"last_call_outbound_human"===e.name||"last_call_outbound_machine"===e.name||"last_sms_received"===e.name||"last_sms_sent"===e.name||"last_email_sent"===e.name||"last_call_outbound"===e.name),a.Pb(1),a.Bc("ngIf","owned_by"!==e.name&&"created_on"!==e.name&&"suppress_until"!==e.name&&"last_call_outbound_human"!==e.name&&"last_call_outbound_machine"!==e.name&&"last_sms_received"!==e.name&&"last_sms_sent"!==e.name&&"last_email_sent"!==e.name&&"last_call_inbound"!==e.name&&"last_call_outbound"!==e.name&&"system_disposition"!==e.name&&"system_disposition_id"!==e.name&&"disposition_id"!==e.name&&"call_disposition_id"!==e.name)}}function rg(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.ic(2,"b"),a.dd(3),a.hc(),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(" ",e.label,": "),a.Pb(2),a.hd(" ",e.min_value||0===e.min_value?"Min: "+e.min_value:""," ",!e.min_value&&0!==e.min_value||!e.max_value&&0!==e.max_value?"":" - "," ",e.max_value||0===e.max_value?"Max: "+e.max_value:""," ")}}function dg(e,t){if(1&e&&(a.gc(0),a.bd(1,sg,8,7,"span",40),a.bd(2,rg,4,4,"span",40),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf",e.value),a.Pb(1),a.Bc("ngIf",!e.value)}}function lg(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"mat-chip",116),a.qc("removed",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).removeFilterField(n)})),a.bd(2,dg,3,2,"ng-container",40),a.ic(3,"mat-icon",105),a.dd(4,"cancel"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(1),a.Bc("removable",!0),a.Pb(1),a.Bc("ngIf",e.value||e.min_value||e.max_value||0===e.min_value||0===e.max_value)}}function ug(e,t){if(1&e&&(a.gc(0),a.ic(1,"h4",115),a.dd(2,"Filters:"),a.hc(),a.ic(3,"mat-chip-list"),a.bd(4,Vu,5,2,"div",17),a.bd(5,Wu,5,2,"div",17),a.bd(6,lg,5,2,"div",17),a.hc(),a.dc(7,"hr",115),a.fc()),2&e){const e=a.uc();a.Pb(4),a.Bc("ngForOf",e.filteredBuckets),a.Pb(1),a.Bc("ngForOf",e.filteredTags),a.Pb(1),a.Bc("ngForOf",e.filteredFields)}}function gg(e,t){if(1&e&&(a.ic(0,"div"),a.dd(1),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.ed(e.label)}}function hg(e,t){1&e&&a.dc(0,"div")}const bg=function(e){return{"dyn-p-r-10":e}};function pg(e,t){if(1&e&&(a.ic(0,"th",125),a.bd(1,gg,2,1,"div",40),a.bd(2,hg,1,0,"div",40),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngClass",a.Gc(3,bg,"select"===e.name)),a.Pb(1),a.Bc("ngIf","select"!=e.name),a.Pb(1),a.Bc("ngIf","select"===e.name)}}function vg(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"mat-checkbox",128),a.qc("click",(function(t){return a.Qc(e),t.stopPropagation()}))("change",(function(t){a.Qc(e);const n=a.uc().$implicit;return a.uc(3).onCheckboxChange(t,n)})),a.hc(),a.hc()}if(2&e){const e=a.uc().$implicit,t=a.uc(3);a.Pb(1),a.Bc("checked",t.selection.isSelected(e))}}const mg=function(e){return[e]};function fg(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit,n=a.uc(2);a.Pb(1),a.fd(" ",n.agentContactDispositionService.contactDispositionMap&&n.agentContactDispositionService.contactDispositionMap.length?n.agentContactDispositionService.contactDispositionMap[e[t.name]]:a.Gc(1,mg,e[t.name])," ")}}function Sg(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit,n=a.uc(2);a.Pb(1),a.fd(" ",n.agentCallDispositionService.callDispositionMap&&n.agentCallDispositionService.callDispositionMap.length?n.agentCallDispositionService.callDispositionMap[e[t.name]]:a.Gc(1,mg,e[t.name])," ")}}function _g(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit,n=a.uc(2);a.Pb(1),a.fd(" ",n.agentUserService.usersMap[e[t.name]]?n.agentUserService.usersMap[e[t.name]].full_name:""," ")}}function yg(e,t){1&e&&(a.gc(0),a.dc(1,"img",131),a.fc())}function Cg(e,t){1&e&&(a.gc(0),a.dc(1,"img",132),a.fc())}function Pg(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"span",130),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit,n=a.uc().$implicit;return a.uc(2).updateField(t,n)})),a.bd(2,yg,2,0,"ng-container",40),a.bd(3,Cg,2,0,"ng-container",40),a.hc(),a.fc()}if(2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit;a.Pb(2),a.Bc("ngIf",e[t.name]),a.Pb(1),a.Bc("ngIf",!e[t.name])}}function wg(e,t){if(1&e&&(a.gc(0),a.dd(1),a.vc(2,"date"),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e[t.name],"MMM d, y, h:mm a")," ")}}function Mg(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit,t=a.uc().$implicit;a.Pb(1),a.ed(e[t.name])}}function xg(e,t){if(1&e&&(a.ic(0,"div",129),a.bd(1,fg,2,3,"ng-container",40),a.bd(2,Sg,2,3,"ng-container",40),a.bd(3,_g,2,1,"ng-container",40),a.bd(4,Pg,4,2,"ng-container",40),a.bd(5,wg,3,4,"ng-container",40),a.bd(6,Mg,2,1,"ng-container",40),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.Bc("ngIf","disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","call_disposition_id"===e.name),a.Pb(1),a.Bc("ngIf","modified_by"===e.name||"owned_by"===e.name||"created_by"===e.name),a.Pb(1),a.Bc("ngIf","Checkbox"===e.data_type),a.Pb(1),a.Bc("ngIf","Date Time"===e.data_type),a.Pb(1),a.Bc("ngIf","Date Time"!==e.data_type&&"Checkbox"!==e.data_type&&"owned_by"!==e.name&&"created_by"!==e.name&&"modified_by"!==e.name&&"disposition_id"!==e.name&&"call_disposition_id"!==e.name)}}function Bg(e,t){if(1&e&&(a.ic(0,"td",126),a.bd(1,vg,2,1,"div",40),a.bd(2,xg,7,6,"div",127),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("ngClass",a.Gc(3,bg,"select"===e.name)),a.Pb(1),a.Bc("ngIf","select"===e.name),a.Pb(1),a.Bc("ngIf","select"!==e.name)}}function kg(e,t){1&e&&(a.gc(0,122),a.bd(1,pg,3,5,"th",123),a.bd(2,Bg,3,5,"td",124),a.fc()),2&e&&a.Bc("matColumnDef",t.$implicit.name)}function Fg(e,t){1&e&&a.dc(0,"tr",133)}function Ig(e,t){if(1&e){const e=a.kc();a.ic(0,"tr",134),a.qc("dblclick",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).viewContact(n)}))("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).onTableRowClick(n)})),a.hc()}2&e&&a.Tb("even",t.even)}function Dg(e,t){if(1&e&&(a.ic(0,"table",117,118),a.bd(2,kg,3,1,"ng-container",119),a.bd(3,Fg,1,0,"tr",120),a.bd(4,Ig,1,2,"tr",121),a.hc()),2&e){const e=a.uc();a.Bc("dataSource",e.contacts),a.Pb(2),a.Bc("ngForOf",e.columns),a.Pb(1),a.Bc("matHeaderRowDef",e.selectedColumns),a.Pb(1),a.Bc("matRowDefColumns",e.selectedColumns)}}function Tg(e,t){1&e&&(a.ic(0,"div",135),a.dc(1,"mat-progress-spinner",136),a.dd(2," Loading... "),a.hc())}function jg(e,t){1&e&&(a.ic(0,"div",137),a.dc(1,"img",138),a.ic(2,"h3",139),a.dd(3,"No Contacts to show"),a.hc(),a.ic(4,"button",140),a.dd(5," Add Contact "),a.ic(6,"mat-icon",141),a.dd(7,"arrow_forward"),a.hc(),a.hc(),a.hc())}function Og(e,t){if(1&e){const e=a.kc();a.ic(0,"paginator",142),a.qc("updatePerPage",(function(t){return a.Qc(e),a.uc().updateResultsPerPage(t)}))("goPage",(function(t){return a.Qc(e),a.uc().goToPage(t)})),a.hc()}if(2&e){const e=a.uc();a.Bc("showPaginationLoader",e.paginator.showPaginationLoader)("totalCount",e.paginator.totalCount)("perPage",e.paginator.resultsPerPage)("currentPage",e.paginator.currentPage)("prevButton",e.paginator.prevButton)("nextButton",e.paginator.nextButton)}}const Ng=function(e){return{height:e}},qg=function(e){return{show:e}};let $g=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p,v,m){this._agentStoredContactService=e,this._dialog=t,this._snackBar=n,this._utils=i,this._authService=c,this._agentNavService=a,this._contactService=o,this._agentContactService=s,this._agentContactFieldService=r,this._systemDispositionService=d,this._agentAccountSettingsService=l,this._userPreferenceService=u,this.permissionService=g,this.agentTagService=h,this.agentContactDispositionService=b,this.agentCallDispositionService=p,this.agentBucketService=v,this.agentUserService=m,this.customTableHeight=0,this.mainContentHeight=0,this.contacts=[],this.filterSearchResult="",this.filterableFields=[],this.callDispositions=[],this.filterParams=new W.e,this.filteredFields=[],this.filteredBuckets=[],this.filteredTags=[],this.selectedTag=null,this.selectedTags=[],this.multiTagFilterMode="mustHaveOneTag",this.buckets=[],this.selectedBucket=null,this.selectedBuckets=[],this.systemDispositions=[],this.contactSearchInput=new ut.a,this.columns=[],this.selectedColumns=[],this.defaultColumns=[],this.selection=new zl.c(!0,[]),this.states=Hl.a,this.filteredStates=Hl.a,this.paginator={showPaginationLoader:!1,totalCount:null,prevButton:"",nextButton:"",currentPage:1,resultsPerPage:25},this.contactSearchInput.pipe(Object(gt.a)(2e3),Object(ht.a)()).subscribe({next:()=>{this.paginator.currentPage=1,this.filterContacts()}})}ngOnInit(){this.agentDashboardNavSubscription=this._agentNavService.activeTopSectionSubject.subscribe({next:e=>{"contacts"!==e||this.alreadyGotData||(this._getContacts(),this.alreadyGotData=!0)}}),this.agentTagService.getTags(),this.agentBucketService.getBuckets(),this._getSystemDispositions(),this.accountSettingsSubscription=this._agentAccountSettingsService.accountSettingsSubject.subscribe({next:e=>{this.accountSettings=e}}),this.agentContactFieldSubscription=this._agentContactFieldService.contactFieldSubject.subscribe({next:e=>{if(e.length){this.filterableFields.push({data_type:"Text",label:"Phone Number",name:"phone_number",value:""});const t=Math.floor(1e9*Math.random());this.filterableFields.push({id:t,data_type:"Text",label:"Email Address",name:"email_address",value:""});const n=[];e.forEach(e=>{"Phone Number"!==e.data_type&&"Email Address"!==e.data_type&&(this._authService.isUserManager()||!this._authService.isUserManager()&&e.show_on_dash)&&n.push(e),e.filterable&&("Integer"!==e.data_type&&"Decimal"!==e.data_type||"call_disposition_id"===e.name||"disposition_id"===e.name||"id"===e.name?(e.value=null,this.filterableFields.push(e)):(e.min_value=null,e.max_value=null,this.filterableFields.push(e)))});const i=n.findIndex(e=>"id"===e.name);let c="";-1!==i&&(c=n[i],n.splice(i,1));const a=n.findIndex(e=>"first_name"===e.name);let o="";-1!==a&&(o=n[a],n.splice(a,1));const s=n.findIndex(e=>"last_name"===e.name);let r="";-1!==s&&(r=n[s],n.splice(s,1)),r&&n.unshift(r),o&&n.unshift(o),c&&n.unshift(c),n.unshift({name:"select"}),this.columns=n,this._authService.isUserManager()?this.defaultColumns=n.map(e=>e.name):(this.defaultColumns=["select"],c&&this.defaultColumns.push("id"),o&&this.defaultColumns.push("first_name"),r&&this.defaultColumns.push("last_name")),this._checkTableColumnPreference()}}})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe(),this.accountSettingsSubscription.unsubscribe(),this.agentContactFieldSubscription.unsubscribe()}filterStates(e){const t=JSON.parse(JSON.stringify(this.states));if(!e)return void(this.filteredStates=t);const n=e.toLowerCase();this.filteredStates=t.filter(e=>e.abbr.toLowerCase().includes(n)),t.filter(e=>e.state.toLowerCase().includes(n)).forEach(e=>{this.filteredStates.includes(e)||this.filteredStates.push(e)})}clearFilters(){this.liveFilterSearch=null,this.filterableFields.forEach(e=>{e.value=null,e.min_value=null,e.max_value=null}),this.selectedTags=[],this.selectedBuckets=[]}filterContacts(){this.filteredFields=[],this.filteredBuckets=[],this.filteredTags=[];let e=new W.e;const t=(t,n)=>{if(null!=n&&""!==n)if(Array.isArray(n)){const i=(t.endsWith("__in"),n.join(","));e=e.append(t,String(i))}else e=e.append(t,String(n))};if(this.filterableFields.forEach(e=>{var n,i,c,a;if(e.value||e.min_value||0===e.min_value||e.max_value||0===e.max_value)if(this.filteredFields.push(e),e.min_value||0===e.min_value||e.max_value||0===e.max_value)!e.min_value&&0!==e.min_value||!e.max_value&&0!==e.max_value?e.min_value||0===e.min_value?t(e.name+"__range_min",e.min_value):(e.max_value||0===e.max_value)&&t(e.name+"__range_max",e.max_value):(t(e.name+"__range_min",e.min_value),t(e.name+"__range_max",e.max_value));else if("Integer"===e.data_type)if(["call_disposition_id","disposition_id"].includes(e.name))if(e.value.length)t(e.name+"__in",e.value);else{const t=this.filteredFields.findIndex(t=>t.name===e.name);-1!==t&&this.filteredFields.splice(t,1)}else t(e.name,e.value);else if("Date Time"===e.data_type||"Date"===e.data_type){const o=null!==(i=null===(n=null==e?void 0:e.value)||void 0===n?void 0:n[0])&&void 0!==i?i:null,s=null!==(a=null===(c=null==e?void 0:e.value)||void 0===c?void 0:c[1])&&void 0!==a?a:null;if(!o&&!s)return;const r=e=>e.toISOString().split("T")[0],d=e=>e.toISOString().split(".")[0].replace("T"," "),l="Date"===e.data_type?r:d;if(o&&s&&o.getTime()===s.getTime())return void t(e.name,l(o));s&&t(e.name+"__range_before",l(s)),o&&t(e.name+"__range_after",l(o))}else if(["system_disposition"].includes(e.name))if(e.value.length)t(e.name+"__in",e.value);else{const t=this.filteredFields.findIndex(t=>t.name===e.name);-1!==t&&this.filteredFields.splice(t,1)}else t(e.name,e.value)}),this.selectedBuckets.length&&(this.selectedBuckets.length>1?t("buckets__id__in",this.selectedBuckets.map(e=>e.id).join(",")):t("buckets__id",this.selectedBuckets[0].id),this.filteredBuckets=this.selectedBuckets),this.selectedTags.length){if(this.selectedTags.length>1){const e=this.selectedTags.map(e=>e.id).join(",");t("mustHaveOneTag"===this.multiTagFilterMode?"tags__id__in":"all_tags__id__in",e)}else t("tags__id",this.selectedTags[0].id);this.filteredTags=this.selectedTags}this.searchResult&&t("search",this.searchResult),this.accountSettings?(this.searchResult||e.keys().length>0)&&!1===this.accountSettings.agent_query_all_contacts&&t("owned_by",this._authService.getUserId()):t("owned_by",this._authService.getUserId()),this.filterParams=e,this.loading=!0,this._snackBar.open("Filtering Contacts...","X",{duration:3e4,verticalPosition:"top",panelClass:["success"]}),this.showFilterDropdown=!1,this.paginator.currentPage=1,this._contactService.filterWithParams(e).subscribe({next:e=>{this._snackBar.open("Contacts Filtered","X",{duration:2500,verticalPosition:"top",panelClass:["success"]}),this.contacts=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.loading=!1},error:e=>{this.loading=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Filtering Contacts"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}inputValueChanged(e){this.contactSearchInput.next(e)}getContentHeight(){this.customTableHeight=this.filterDropdownBody.nativeElement.offsetHeight+100,this.mainContentHeight=this.mainContent.nativeElement.offsetHeight}onCheckboxChange(e,t){e.checked?(this.selection.selected.length&&this.selection.selected[0].id!==t.id&&this.selection.clear(),this.selection.select(t)):this.selection.deselect(t)}onTableRowClick(e){this.selection.selected.length&&this.selection.selected[0].id!==e.id&&this.selection.clear(),this.selection.toggle(e)}removeFilterField(e){const t=this.filteredFields.findIndex(t=>t.id===e.id);this.filteredFields.splice(t,1);const n=this.filterableFields.findIndex(t=>t.id===e.id);this.filterableFields[n].value=null,this.filterableFields[n].min_value=null,this.filterableFields[n].max_value=null,this.filterContacts()}removeFilterBucket(e){const t=this.selectedBuckets.findIndex(t=>t.id===e.id);this.selectedBuckets.splice(t,1),this.filterContacts()}removeFilterTag(e){const t=this.selectedTags.findIndex(t=>t.id===e.id);this.selectedTags.splice(t,1),this.filterContacts()}showCreateContactDialog(){this._dialog.open(E.a,{width:"1200px",data:{dialogType:"createContact",contactIds:[],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:e=>{e&&(this.paginator.totalCount++,this.contacts.unshift(e),this.contactsTable.renderRows())}})}showCsvUploadDialog(){this.accountSettings.agent_contact_import&&this._dialog.open(Al.a,{width:"1000px"})}showEditTableDialog(){const e=JSON.parse(JSON.stringify(this.columns)),t=JSON.parse(JSON.stringify(this.selectedColumns));e.splice(0,1),t.splice(0,1),this._dialog.open(Wl.a,{width:"800px",data:{allColumns:e,selectedColumns:t}}).afterClosed().subscribe({next:e=>{e&&(e.unshift("select"),this._userPreferenceService.updateReturn({contact_table_field_order:e}).subscribe({next:e=>{this._userPreferenceService.userPreferenceSubject.next(e),this.selectedColumns=e.contact_table_field_order}}))}})}viewContact(e){this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",contactIds:[e?e.id:this.selection.selected[0].id],contactsTotal:null,paginator:{currentPage:this.paginator.currentPage,resultsPerPage:this.paginator.resultsPerPage,results:this.contacts,totalCount:this.paginator.totalCount}},autoFocus:!1}).afterClosed().subscribe({next:t=>{if(t&&"viewOnDashboard"===t)this.viewContactOnDashboard(e?e.id:this.selection.selected[0].id);else if(t){const n=e?e.id:this.selection.selected[0].id,i=this.contacts.findIndex(e=>e.id===n);-1!==i&&(this.contacts[i]=t,this.loading||this.contactsTable.renderRows())}}})}viewContactOnDashboard(e){if(!this.selection.selected.length&&!e)return;let t;t=e||this.selection.selected[0].id,this._agentContactService.getContact(t),this._agentContactService.contactSubject.value&&this._agentContactService.contactSubject.value.id!==t&&this._agentStoredContactService.storeContact(this._agentContactService.contactSubject.value),this._agentNavService.activeTopSectionSubject.next("dashboard"),this._agentNavService.activeDashboardSectionSubject.next("contact"),this.selection.clear()}updateField(e,t){const n=!e[t.name];setTimeout(()=>{this.selection.clear()},50);const i={};i[t.name]=n,this._contactService.update(e.id,i).subscribe({next:e=>{this._snackBar.open(t.label+" Field updated successfully","",{duration:3e3,verticalPosition:"top",panelClass:"success"});const n=this.contacts.findIndex(t=>t.id===e.id);-1!==n&&(this.contacts[n]=e,this.contactsTable.renderRows())},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error updating field"),"X",{duration:5e3,verticalPosition:"top",panelClass:"error"})}})}goToPage(e){this.paginator.currentPage=e,this.paginator.showPaginationLoader=!0;let t=new URL(this.paginator.nextButton?this.paginator.nextButton:this.paginator.prevButton);t.searchParams.set("page",String(this.paginator.currentPage));let n="/api/contacts/?"+t.searchParams.toString();this._contactService.buttonClick(n).subscribe({next:e=>{this.contacts=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.paginator.showPaginationLoader=!1},error:e=>{this.paginator.showPaginationLoader=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Contacts"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}updateResultsPerPage(e){this.paginator.currentPage=1,this.paginator.resultsPerPage=e,this.filterContacts()}_checkTableColumnPreference(){if(this._userPreferenceService.userPreferenceSubject.value&&this._userPreferenceService.userPreferenceSubject.value.contact_table_field_order&&this._userPreferenceService.userPreferenceSubject.value.contact_table_field_order.length){const e=JSON.parse(JSON.stringify(this.columns.map(e=>e.name)));this._userPreferenceService.userPreferenceSubject.value.contact_table_field_order.forEach(t=>{e.includes(t)&&this.selectedColumns.push(t)})}else this.selectedColumns=JSON.parse(JSON.stringify(this.defaultColumns))}_getContacts(){this.loading=!0,this._contactService.list(this.paginator.resultsPerPage,this.paginator.currentPage).subscribe({next:e=>{this.loading=!1,this.contacts=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count},error:e=>{this.loading=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Contacts"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}_getSystemDispositions(){this._systemDispositionService.list().subscribe({next:e=>{this.systemDispositions=e.results},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting System Dispositions"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(m.a),a.bc(Y.b),a.bc(k.a),a.bc(D.a),a.bc(r.a),a.bc(d.a),a.bc(Ql.a),a.bc(f.a),a.bc(h.a),a.bc(Vl.a),a.bc(P.a),a.bc(q.a),a.bc(A.a),a.bc(Qr),a.bc(N),a.bc(b.a),a.bc(Ul),a.bc(g.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-contacts"]],viewQuery:function(e,t){var n;1&e&&(a.Wc(Gl,!0),a.Wc(Yl,!0),a.jd(Jl,!0)),2&e&&(a.Lc(n=a.rc())&&(t.filterDropdownBody=n.first),a.Lc(n=a.rc())&&(t.mainContent=n.first),a.Lc(n=a.rc())&&(t.contactsTable=n.first))},decls:115,vars:44,consts:[["class","red-warning-banner dyn-m-b-10 dyn-p-20","style","font-size: .9rem;",4,"ngIf"],[1,"dyn-card","dyn-p-t-0","dyn-relative","dyn-m-b-20","agent-contacts-container",2,"overflow","hidden","transition",".5s ease-in-out",3,"ngStyle"],["mainContent",""],[1,"filter-dropdown-overlay",3,"ngClass","click"],[1,"filter-dropdown-test",3,"ngClass"],["filterDropdownBody",""],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[1,"dyn-flex"],[1,"dyn-m-0"],[1,"dyn-m-l-20"],[1,"dyn-search-bar"],[1,"left"],["type","search","placeholder","Search Filters",3,"ngModel","ngModelChange"],[1,"dyn-p-t-10"],["mat-stroked-button","","color","",1,"dyn-m-r-20","close-filter-dropdown",3,"click"],[1,"dyn-m-t-10","dyn-m-b-20"],[1,"filter-options-container"],[4,"ngFor","ngForOf"],[1,"dyn-p-t-20","dyn-p-b-20"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-m-r-10",3,"ngModel","ngModelChange"],[3,"ngValue"],["class","dyn-text-muted dyn-text-center dyn-m-0",4,"ngIf"],["removable","",3,"removed",4,"ngFor","ngForOf"],[1,"dyn-flex","dyn-space-between","dyn-m-t-10"],["appearance","outline",1,"dyn-search-select","dyn-m-r-10"],["disableRipple","",3,"ngModel","ngModelChange"],[1,"dyn-flex","dyn-align-items","dyn-dropdown-search-bar"],["class","dyn-icon-sm",4,"ngIf"],["class","dyn-inline-block dyn-vertical-middle","diameter","20","mode","indeterminate",4,"ngIf"],["type","search","placeholder","Search",1,"dyn-full-width","dyn-m-l-10",2,"width","100px",3,"ngModel","keydown","ngModelChange"],[1,"dyn-text-sm","dyn-menu-option-sm",3,"value"],[1,"dyn-text-center","dyn-m-10"],["mat-button","","color","primary",3,"disabled","click"],["diameter","20","mode","indeterminate","class","dyn-inline-block dyn-vertical-middle",4,"ngIf"],["class","dyn-text-center",4,"ngIf"],[1,"dyn-text-center","dyn-m-t-20"],["mat-stroked-button","","color","primary",1,"dyn-m-r-10",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"tab",3,"click"],[4,"ngIf"],[1,"dyn-flex","dyn-space-between","dyn-align-items","dyn-p-t-20"],[1,"dyn-flex","dyn-align-items"],[1,"dyn-inline-block","dyn-m-l-20"],["matTooltip","Partial match search on first name, last name, address, city, state, zip code, county, country",1,"dyn-search-bar"],["type","search","name","search contacts","placeholder","Search",3,"ngModel","ngModelChange"],["mat-stroked-button","","color","primary",1,"dyn-m-r-10",3,"click"],[1,"dyn-vertical-middle","dyn-m-r-5"],["mat-stroked-button","","color","primary","class","dyn-m-r-10",3,"click",4,"ngIf"],["matTooltip","You must have the 'contacts_write_create' permission to create contacts",1,"dyn-inline-block",3,"matTooltipDisabled"],[1,"dyn-full-width","dyn-relative","dyn-m-t-20",2,"overflow-x","auto","overflow-y","hidden","height","fit-content"],["mat-table","","class","dyn-full-width contacts-table collapse-view",3,"dataSource",4,"ngIf"],["class","dyn-p-20 loading-indicator",4,"ngIf"],["class","dyn-text-center dyn-m-t-50 dyn-m-b-50",4,"ngIf"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage",4,"ngIf"],[1,"dyn-agent-table-pop-up","dyn-flex","dyn-align-items","dyn-space-between",3,"ngClass"],[1,"dyn-p-r-50"],["mat-stroked-button","","color","",1,"dyn-m-r-15",2,"border-color","#fff",3,"click"],[1,"material-icons","dyn-vertical-middle"],["mat-raised-button","",1,"dyn-m-r-20",3,"click"],["mat-raised-button","",3,"click"],[1,"red-warning-banner","dyn-m-b-10","dyn-p-20",2,"font-size",".9rem"],[1,"dyn-vertical-middle","dyn-m-r-10"],[3,"for"],[1,"dyn-full-width",3,"id","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["for","state"],["type","text","id","state",1,"dyn-full-width",3,"ngModel","matAutocomplete","keydown.enter","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],["style","height: 30px!important;line-height: 30px!important",3,"value",4,"ngFor","ngForOf"],[2,"height","30px!important","line-height","30px!important",3,"value"],[3,"for","matTooltip","matTooltipDisabled"],["type","text",1,"dyn-full-width",3,"id","ngModel","ngModelChange","keydown.enter"],["for","owned_by",3,"matTooltip","matTooltipDisabled"],["matTooltip","You must have the 'contacts_read_all permission to view all contacts",1,"dyn-inline-block","dyn-full-width",3,"matTooltipDisabled"],["id","owned_by",1,"dyn-full-width",3,"disabled","ngModel","ngModelChange"],["for","system_disposition",3,"matTooltip","matTooltipDisabled"],["appearance","outline",1,"dyn-full-width","dyn-search-select"],["id","system_disposition","multiple","","disableRipple","",1,"dyn-full-width",3,"ngModel","ngModelChange"],["class","dyn-opacity-50",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"dyn-opacity-50"],[3,"value"],[3,"matTooltip","matTooltipDisabled"],[1,"dyn-flex",2,"align-items","center"],["type","number",2,"width","50%",3,"ngModel","ngModelChange","keydown.enter"],[1,"dyn-m-l-5","dyn-m-r-5"],["for","id",3,"matTooltip","matTooltipDisabled"],["id","id","type","number",1,"dyn-full-width",3,"ngModel","ngModelChange","keydown.enter"],["for","disposition",3,"matTooltip","matTooltipDisabled"],["id","disposition","multiple","","disableRipple","",1,"dyn-full-width",3,"ngModel","ngModelChange"],["for","call_disposition",3,"matTooltip","matTooltipDisabled"],["id","call_disposition","multiple","","disableRipple","",1,"dyn-full-width",3,"ngModel","ngModelChange"],["type","email",1,"dyn-full-width",3,"id","ngModel","ngModelChange","keydown.enter"],["type","text",1,"dyn-full-width",3,"id","ngModel","selectMode","owlDateTime","owlDateTimeTrigger","keydown.enter","ngModelChange"],["hour12Timer","true"],["dt2",""],["hour12Timer","true",3,"pickerType"],["dt3",""],["value","true"],["value","false"],[3,"ngValue",4,"ngIf"],[1,"dyn-text-muted","dyn-text-center","dyn-m-0"],["removable","",3,"removed"],["matChipRemove",""],[1,"dyn-icon-sm"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],["class","dyn-text-sm dyn-menu-option-sm",3,"value",4,"ngIf"],[1,"dyn-text-center"],[1,"dyn-inline-block","dyn-bg-grey","dyn-m-t-20","dyn-p-20"],[3,"ngModel","ngModelChange"],["value","mustHaveOneTag",1,"dyn-m-r-20"],["value","mustHaveAllTags"],[1,"dyn-vertical-middle","dyn-icon-sm"],[1,"dyn-m-b-0"],[3,"removable","removed"],["mat-table","",1,"dyn-full-width","contacts-table","collapse-view",3,"dataSource"],["contactsTable",""],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","dyn-table-hover",3,"even","dblclick","click",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-header-cell","",3,"ngClass"],["mat-cell","",3,"ngClass"],["class","dyn-text-sm",4,"ngIf"],[1,"dyn-p-l-5",3,"checked","click","change"],[1,"dyn-text-sm"],[3,"click"],["height","18px","src","/assets/img/check-icon.svg",1,"dyn-vertical-middle"],["height","18px","src","/assets/img/cancel-icon.svg",1,"dyn-vertical-middle"],["mat-header-row",""],["mat-row","",1,"dyn-table-hover",3,"dblclick","click"],[1,"dyn-p-20","loading-indicator"],["mode","indeterminate","diameter","20",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-text-center","dyn-m-t-50","dyn-m-b-50"],["src","/assets/img/warning-icon.svg",2,"height","60px"],[1,"dyn-m-t-10","dyn-m-b-10"],["mat-button","","color","primary"],[1,"dyn-vertical-middle"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage"]],template:function(e,t){1&e&&(a.bd(0,Zl,7,0,"div",0),a.ic(1,"div",1,2),a.ic(3,"div",3),a.qc("click",(function(){return t.showFilterDropdown=!t.showFilterDropdown})),a.hc(),a.ic(4,"div",4,5),a.ic(6,"div",6),a.ic(7,"div",7),a.ic(8,"h1",8),a.dd(9,"Filter Contacts"),a.hc(),a.ic(10,"div",9),a.ic(11,"div",10),a.ic(12,"div",11),a.ic(13,"mat-icon"),a.dd(14,"search"),a.hc(),a.hc(),a.ic(15,"input",12),a.qc("ngModelChange",(function(e){return t.filterSearchResult=e})),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(16,"div",13),a.ic(17,"button",14),a.qc("click",(function(){return t.showFilterDropdown=!t.showFilterDropdown})),a.dd(18,"Close"),a.hc(),a.hc(),a.hc(),a.dc(19,"hr",15),a.ic(20,"div",16),a.bd(21,Bu,2,1,"ng-container",17),a.hc(),a.dc(22,"hr"),a.ic(23,"div",18),a.ic(24,"div",19),a.ic(25,"h3",8),a.dd(26,"Buckets"),a.hc(),a.ic(27,"div"),a.ic(28,"select",20),a.qc("ngModelChange",(function(e){return t.selectedBucket=e}))("ngModelChange",(function(){return t.selectedBucket?t.selectedBuckets.push(t.selectedBucket):null})),a.ic(29,"option",21),a.dd(30,"Select a bucket"),a.hc(),a.bd(31,Fu,2,1,"ng-container",17),a.hc(),a.hc(),a.hc(),a.dc(32,"hr"),a.ic(33,"div"),a.bd(34,Iu,2,0,"p",22),a.ic(35,"mat-chip-list"),a.bd(36,Du,4,1,"mat-chip",23),a.hc(),a.hc(),a.hc(),a.ic(37,"div",18),a.ic(38,"div",24),a.ic(39,"h3",8),a.dd(40,"Tags"),a.hc(),a.ic(41,"div"),a.ic(42,"mat-form-field",25),a.ic(43,"mat-select",26),a.qc("ngModelChange",(function(e){return t.selectedTag=e}))("ngModelChange",(function(){return t.selectedTag?t.selectedTags.push(t.selectedTag):null})),a.ic(44,"div",27),a.bd(45,Tu,2,0,"mat-icon",28),a.bd(46,ju,1,0,"mat-progress-spinner",29),a.ic(47,"input",30),a.qc("keydown",(function(e){return e.stopPropagation()}))("ngModelChange",(function(e){return t.agentTagService.tagInput=e}))("ngModelChange",(function(e){return t.agentTagService.tagInputValueChanged(e)})),a.hc(),a.hc(),a.dc(48,"mat-option",31),a.bd(49,Nu,2,1,"ng-container",17),a.ic(50,"div",32),a.ic(51,"button",33),a.qc("click",(function(){return t.agentTagService.loadMoreTags()})),a.bd(52,qu,1,0,"mat-progress-spinner",34),a.dd(53," Load More "),a.ic(54,"mat-icon"),a.dd(55,"expand_more"),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(56,"hr"),a.ic(57,"div"),a.bd(58,$u,2,0,"p",22),a.ic(59,"mat-chip-list"),a.bd(60,Eu,4,1,"mat-chip",23),a.hc(),a.hc(),a.bd(61,Au,7,1,"div",35),a.hc(),a.dc(62,"hr"),a.ic(63,"div",36),a.ic(64,"button",37),a.qc("click",(function(){return t.clearFilters()})),a.dd(65," Clear Filters "),a.hc(),a.ic(66,"button",38),a.qc("click",(function(){return t.filterContacts()})),a.ic(67,"mat-icon"),a.dd(68,"autorenew"),a.hc(),a.dd(69," Filter Results "),a.hc(),a.hc(),a.ic(70,"div",39),a.qc("click",(function(){return t.showFilterDropdown=!t.showFilterDropdown,t.filterSearchResult="",t.getContentHeight()})),a.bd(71,Qu,4,0,"ng-container",40),a.bd(72,Ru,4,0,"ng-container",40),a.hc(),a.hc(),a.ic(73,"div"),a.ic(74,"div",41),a.ic(75,"div",42),a.ic(76,"h1"),a.dd(77,"Contacts"),a.hc(),a.ic(78,"div",43),a.ic(79,"div",44),a.ic(80,"div",11),a.ic(81,"mat-icon"),a.dd(82,"search"),a.hc(),a.hc(),a.ic(83,"input",45),a.qc("ngModelChange",(function(e){return t.searchResult=e}))("ngModelChange",(function(e){return t.inputValueChanged(e)})),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(84,"div"),a.ic(85,"button",46),a.qc("click",(function(){return t.showEditTableDialog()})),a.ic(86,"mat-icon",47),a.dd(87,"edit"),a.hc(),a.dd(88," Edit Table "),a.hc(),a.bd(89,Uu,4,0,"button",48),a.ic(90,"div",49),a.ic(91,"button",38),a.qc("click",(function(){return t.showCreateContactDialog()})),a.dd(92,"Create Contact"),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(93,"hr",8),a.bd(94,ug,8,3,"ng-container",40),a.ic(95,"div",50),a.bd(96,Dg,5,4,"table",51),a.bd(97,Tg,3,0,"div",52),a.hc(),a.bd(98,jg,8,0,"div",53),a.bd(99,Og,1,6,"paginator",54),a.hc(),a.hc(),a.ic(100,"div",55),a.ic(101,"div",56),a.ic(102,"button",57),a.qc("click",(function(){return t.selection.clear()})),a.ic(103,"i",58),a.dd(104,"close"),a.hc(),a.dd(105," Clear Selection "),a.hc(),a.hc(),a.ic(106,"div"),a.ic(107,"button",59),a.qc("click",(function(){return t.viewContactOnDashboard()})),a.ic(108,"i",58),a.dd(109,"arrow_back"),a.hc(),a.dd(110," View on Dashboard "),a.hc(),a.ic(111,"button",60),a.qc("click",(function(){return t.viewContact()})),a.ic(112,"i",58),a.dd(113,"edit"),a.hc(),a.dd(114," Edit Contact "),a.hc(),a.hc(),a.hc()),2&e&&(a.Bc("ngIf",!t.permissionService.hasPermission("contacts_read")),a.Pb(1),a.Bc("ngStyle",a.Gc(36,Ng,t.showFilterDropdown&&t.customTableHeight>t.mainContentHeight?t.customTableHeight+50+"px":"auto")),a.Pb(2),a.Bc("ngClass",a.Gc(38,qg,t.showFilterDropdown)),a.Pb(1),a.Bc("ngClass",a.Gc(40,qg,t.showFilterDropdown)),a.Pb(11),a.Bc("ngModel",t.filterSearchResult),a.Pb(6),a.Bc("ngForOf",t.filterableFields),a.Pb(7),a.Bc("ngModel",t.selectedBucket),a.Pb(1),a.Bc("ngValue",null),a.Pb(2),a.Bc("ngForOf",t.agentBucketService.bucketSubject.value),a.Pb(3),a.Bc("ngIf",!t.selectedBuckets.length),a.Pb(2),a.Bc("ngForOf",t.selectedBuckets),a.Pb(7),a.Bc("ngModel",t.selectedTag),a.Pb(2),a.Bc("ngIf",!t.agentTagService.loadingTags),a.Pb(1),a.Bc("ngIf",t.agentTagService.loadingTags),a.Pb(1),a.Bc("ngModel",t.agentTagService.tagInput),a.Pb(1),a.Bc("value",null),a.Pb(1),a.Bc("ngForOf",t.agentTagService.tagSubject.value),a.Pb(2),a.Bc("disabled",!t.agentTagService.nextTagUrl),a.Pb(1),a.Bc("ngIf",t.agentTagService.loadingTags),a.Pb(6),a.Bc("ngIf",!t.selectedTags.length),a.Pb(2),a.Bc("ngForOf",t.selectedTags),a.Pb(1),a.Bc("ngIf",t.selectedTags.length>1),a.Pb(3),a.Bc("disabled",t.loading),a.Pb(2),a.Bc("disabled",t.loading),a.Pb(5),a.Bc("ngIf",!t.showFilterDropdown),a.Pb(1),a.Bc("ngIf",t.showFilterDropdown),a.Pb(11),a.Bc("ngModel",t.searchResult),a.Pb(6),a.Bc("ngIf",t.accountSettings&&t.accountSettings.agent_contact_import),a.Pb(1),a.Bc("matTooltipDisabled",t.permissionService.hasPermission("contacts_write_create")),a.Pb(1),a.Bc("disabled",!t.permissionService.hasPermission("contacts_write_create")),a.Pb(3),a.Bc("ngIf",t.filteredFields.length||t.filteredBuckets.length||t.filteredTags.length),a.Pb(2),a.Bc("ngIf",t.columns.length&&t.selectedColumns.length),a.Pb(1),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.contacts&&!t.loading),a.Pb(1),a.Bc("ngIf",t.contacts&&!t.loading),a.Pb(1),a.Bc("ngClass",a.Gc(42,qg,t.selection.selected.length)))},directives:[J.p,J.q,J.n,ge.a,te.d,te.p,te.s,le.b,J.o,te.y,te.t,te.A,Ba.c,K.b,ee.a,ne.o,ue.a,sn.c,sn.a,ee.c,te.u,on.b,on.d,on.a,Ba.a,Ba.d,fe.a,Ll.b,Ll.a,Uo.n,Uo.k,Uo.m,Uo.c,Uo.i,Uo.b,Uo.h,Uo.a,Xl.a,Uo.j,Uo.l,pl.a],pipes:[J.x,J.f],styles:[".filter-dropdown-test[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{border:1px solid #dee2e5;border-bottom-left-radius:10px;border-bottom-right-radius:10px;box-shadow:0 1px 4px 0 rgba(172,179,184,.21176470588235294);font-size:.9rem}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{white-space:nowrap;border-right:1px solid #eff3f6}.filter-dropdown-test[_ngcontent-%COMP%]{padding:20px;box-sizing:border-box;position:absolute;background:#fff;width:100%;z-index:3;left:0;transform:translateY(-100%);transition:.5s ease-in-out}.filter-dropdown-test[_ngcontent-%COMP%]   .filter-options-container[_ngcontent-%COMP%]{display:grid;width:100%;grid-gap:10px 20px;align-items:center;grid-template-columns:repeat(auto-fit,minmax(170px,1fr))}.filter-dropdown-test[_ngcontent-%COMP%]   .filter-options-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{max-width:250px}.filter-dropdown-test[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:-35px;background:#fff;width:120px;text-align:center;padding:5px 0;cursor:pointer;height:35px;box-sizing:border-box;border:1px solid #ddd;border-top:none;margin-left:-60px}.filter-dropdown-test[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{background:#f1f1f1}.filter-dropdown-test.show[_ngcontent-%COMP%]{transform:translate(0);box-shadow:-2px 2px 11px 0 rgba(0,0,0,.1)}.filter-dropdown-test.show[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{background:#fff}.filter-dropdown-overlay.show[_ngcontent-%COMP%]{position:absolute;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,.2);z-index:2}tr.scheduled-for-delete[_ngcontent-%COMP%]{background:#f5f5f5}tr.scheduled-for-delete[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-child){opacity:.4}.even[_ngcontent-%COMP%]{background-color:#f4f4f4}.dyn-table-hover[_ngcontent-%COMP%]:hover{background-color:#eaeaea!important}"]}),e})();var Eg=n("kEQC"),Ag=n("pN+a"),Qg=n("4hdQ"),Rg=n("ju6A"),Ug=n("5/5z"),Vg=n("H4hi"),Wg=n("bv9b"),zg=n("GJrw");function Hg(e,t){1&e&&(a.ic(0,"mat-icon",56),a.dd(1,"search"),a.hc())}function Lg(e,t){1&e&&(a.ic(0,"mat-icon",56),a.dd(1,"close"),a.hc())}function Xg(e,t){if(1&e&&(a.ic(0,"option",90),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("value",e),a.Pb(1),a.ed(e)}}function Gg(e,t){if(1&e&&(a.ic(0,"option",62),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.fd(" ",e.name," ")}}function Yg(e,t){if(1&e&&(a.ic(0,"mat-option",72),a.dd(1),a.hc()),2&e){const e=a.uc().$implicit;a.Bc("value",e.name),a.Pb(1),a.ed(e.name)}}function Jg(e,t){if(1&e&&(a.gc(0),a.bd(1,Yg,2,2,"mat-option",91),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf","none"===e.group&&"No Call Yet"!==e.name)}}function Zg(e,t){if(1&e&&(a.ic(0,"option",62),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function Kg(e,t){if(1&e&&(a.gc(0),a.ic(1,"option",62),a.dd(2),a.hc(),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function eh(e,t){if(1&e&&(a.gc(0),a.ic(1,"option",62),a.dd(2),a.hc(),a.fc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function th(e,t){if(1&e&&(a.ic(0,"option",62),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function nh(e,t){if(1&e){const e=a.kc();a.ic(0,"div",57),a.ic(1,"form",58),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc();return t.preventDefault(),n.onFilterResults()})),a.ic(2,"div",59),a.ic(3,"div"),a.ic(4,"label"),a.dd(5,"Contact ID"),a.hc(),a.dc(6,"br"),a.dc(7,"input",60),a.hc(),a.ic(8,"div"),a.ic(9,"label"),a.dd(10,"Call Type"),a.hc(),a.dc(11,"br"),a.ic(12,"select",61),a.dc(13,"option",62),a.bd(14,Xg,2,2,"option",63),a.hc(),a.hc(),a.ic(15,"div"),a.ic(16,"label"),a.dd(17,"Queue"),a.hc(),a.dc(18,"br"),a.ic(19,"select",64),a.dc(20,"option",62),a.bd(21,Gg,2,2,"option",65),a.hc(),a.hc(),a.ic(22,"div"),a.ic(23,"label"),a.dd(24,"System Disposition"),a.hc(),a.dc(25,"br"),a.ic(26,"mat-form-field",66),a.ic(27,"mat-select",67,68),a.ic(29,"div",69),a.dc(30,"mat-option",70),a.bd(31,Jg,2,1,"ng-container",71),a.ic(32,"mat-option",72),a.dd(33," Answered Machine "),a.hc(),a.ic(34,"mat-option",72),a.dd(35," Agent Connect "),a.hc(),a.ic(36,"mat-option",72),a.dd(37," Abandoned "),a.hc(),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(38,"div"),a.ic(39,"label"),a.dd(40,"Call Length Seconds"),a.hc(),a.dc(41,"br"),a.ic(42,"div",73),a.dc(43,"input",74),a.ic(44,"span",75),a.dd(45,"to"),a.hc(),a.dc(46,"input",76),a.hc(),a.hc(),a.ic(47,"div"),a.ic(48,"label"),a.dd(49,"Live Filter"),a.hc(),a.dc(50,"br"),a.ic(51,"select",77),a.dc(52,"option",62),a.bd(53,Zg,2,2,"option",65),a.hc(),a.hc(),a.ic(54,"div"),a.ic(55,"label"),a.dd(56,"Call Start Range"),a.hc(),a.dc(57,"br"),a.dc(58,"input",78),a.dc(59,"owl-date-time",79,80),a.hc(),a.ic(61,"div"),a.ic(62,"label"),a.dd(63,"Campaign"),a.hc(),a.dc(64,"br"),a.ic(65,"select",81),a.dc(66,"option",62),a.bd(67,Kg,3,2,"ng-container",71),a.hc(),a.hc(),a.ic(68,"div"),a.ic(69,"label"),a.dd(70,"Destination Phone Number"),a.hc(),a.dc(71,"br"),a.dc(72,"input",82),a.hc(),a.ic(73,"div"),a.ic(74,"label"),a.dd(75,"Call Disposition"),a.hc(),a.dc(76,"br"),a.ic(77,"select",83),a.dc(78,"option",62),a.bd(79,eh,3,2,"ng-container",71),a.hc(),a.hc(),a.ic(80,"div"),a.ic(81,"label"),a.dd(82,"Bucket"),a.hc(),a.dc(83,"br"),a.ic(84,"select",84),a.dc(85,"option",62),a.bd(86,th,2,2,"option",65),a.hc(),a.hc(),a.hc(),a.ic(87,"div",85),a.ic(88,"input",86),a.qc("change",(function(t){return a.Qc(e),a.uc().onViewTodaysEventsChecked(t)})),a.hc(),a.ic(89,"label",87),a.dd(90,"Today's Calls Only"),a.hc(),a.ic(91,"button",88),a.qc("click",(function(){return a.Qc(e),a.uc().clearFilterForm()})),a.dd(92,"Clear Filters"),a.hc(),a.ic(93,"button",89),a.qc("click",(function(){return a.Qc(e),a.uc().onFilterResults()})),a.dd(94,"Filter"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.Mc(60),t=a.uc();a.Pb(1),a.Bc("formGroup",t.filterForm),a.Pb(12),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.callTypes),a.Pb(6),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentQueueService.queuesShownOnTable),a.Pb(9),a.Bc("value",null),a.Pb(1),a.Bc("ngForOf",t.systemDispositions),a.Pb(1),a.Bc("value","answered-machine-group"),a.Pb(2),a.Bc("value","agent-connect-group"),a.Pb(2),a.Bc("value","abandoned-group"),a.Pb(16),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.liveFilters),a.Pb(5),a.Bc("selectMode","range")("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(1),a.Bc("disabled",!0===t.filterForm.get("start__date_local_today").value),a.Pb(7),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCampaignService.campaignsShownOnTable),a.Pb(11),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentCallDispositionService.callDispositions),a.Pb(6),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",t.agentBucketService.bucketSubject.value)}}function ih(e,t){1&e&&(a.ic(0,"th",92),a.dc(1,"div"),a.hc())}function ch(e,t){if(1&e){const e=a.kc();a.ic(0,"td",93),a.ic(1,"mat-checkbox",94),a.qc("click",(function(t){return a.Qc(e),t.stopPropagation()}))("change",(function(n){a.Qc(e);const i=t.$implicit;return a.uc().onCheckboxChange(n,i)})),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("checked",n.selection.isSelected(e))}}function ah(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Bucket "),a.hc())}function oh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentBucketService.bucketMap[e.bucket]?n.agentBucketService.bucketMap[e.bucket].name:""," ")}}function sh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Callback Queue "),a.hc())}function rh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.callBackQueueMap[e.call_back_queue]?n.callBackQueueMap[e.call_back_queue]:""," ")}}function dh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Campaign "),a.hc())}function lh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentCampaignService.campaignMap[e.campaign]?n.agentCampaignService.campaignMap[e.campaign].name:""," ")}}function uh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Duration "),a.hc())}function gh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.vc(2,"MmSsFormat"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.duration?a.wc(2,1,e.duration):"00:00"," ")}}function hh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," End "),a.hc())}function bh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.end,"MMM d y, h:mm a")," ")}}function ph(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Inbound "),a.hc())}function vh(e,t){1&e&&a.dc(0,"img",99)}function mh(e,t){1&e&&a.dc(0,"img",100)}function fh(e,t){if(1&e&&(a.ic(0,"td",96),a.bd(1,vh,1,0,"img",97),a.bd(2,mh,1,0,"img",98),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.inbound),a.Pb(1),a.Bc("ngIf",!e.inbound)}}function Sh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Inbound Route "),a.hc())}function _h(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.inboundRouteMap[e.inbound_route]?n.inboundRouteMap[e.inbound_route]:""," ")}}function yh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Live Filter "),a.hc())}function Ch(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.liveFilterMap[e.live_filter]?n.liveFilterMap[e.live_filter]:""," ")}}function Ph(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Queue "),a.hc())}function wh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentQueueService.queueMap[e.queue]?n.agentQueueService.queueMap[e.queue].name:""," ")}}function Mh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Transferred To "),a.hc())}function xh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.transferred_to," ")}}function Bh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Web Call Back "),a.hc())}function kh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.webCallBackMap[e.web_call_back]?n.webCallBackMap[e.web_call_back]:""," ")}}function Fh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Created On "),a.hc())}function Ih(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.created_on,"MMM d, y, h:mm a")," ")}}function Dh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Contact "),a.hc())}function Th(e,t){if(1&e){const e=a.kc();a.ic(0,"td",96),a.ic(1,"span",101),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().openContact(n.contact)})),a.dd(2),a.hc(),a.hc()}if(2&e){const e=t.$implicit;a.Pb(2),a.fd(" ",e.contact," ")}}function jh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Start "),a.hc())}function Oh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.start,"MMM d, y, h:mm a")," ")}}function Nh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Call Type "),a.hc())}function qh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.call_type)}}function $h(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Destination Phone Number"),a.hc())}function Eh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.destination)}}function Ah(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Source Phone Number "),a.hc())}function Qh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.source)}}function Rh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," System Dispo "),a.hc())}function Uh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.ed(e.system_disposition)}}function Vh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1,"Call Disposition "),a.hc())}function Wh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentCallDispositionService.callDispositionMap[e.call_disposition]?n.agentCallDispositionService.callDispositionMap[e.call_disposition]:""," ")}}function zh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," Call Length "),a.hc())}function Hh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.vc(2,"MmSsFormat"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.billsec?a.wc(2,1,e.billsec):"00:00"," ")}}function Lh(e,t){1&e&&(a.ic(0,"th",95),a.dd(1," User "),a.hc())}function Xh(e,t){if(1&e&&(a.ic(0,"td",96),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentUserService.usersMap[e.app_user]?n.agentUserService.usersMap[e.app_user].full_name:""," ")}}function Gh(e,t){1&e&&(a.ic(0,"th",102),a.dd(1," Controls "),a.hc())}function Yh(e,t){if(1&e){const e=a.kc();a.ic(0,"button",112),a.qc("click",(function(){return a.Qc(e),a.uc(2).stopAudio()})),a.ic(1,"mat-icon",7),a.dd(2,"stop"),a.hc(),a.hc()}}const Jh=function(e){return{"dyn-opacity-30":e}};function Zh(e,t){if(1&e){const e=a.kc();a.ic(0,"button",113),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc().playAudio(t.id,t.call_recording_fsfile_id)})),a.ic(1,"mat-icon",109),a.dd(2,"play_arrow"),a.hc(),a.hc()}if(2&e){const e=a.uc().$implicit,t=a.uc();a.Bc("disabled",!e.call_recording_fsfile_id||!t.permissionService.hasPermission("call_recordings_read")||t.audioPlaying&&t.pausedAudio!==e.call_recording_fsfile_id),a.Pb(1),a.Bc("ngClass",a.Gc(2,Jh,!e.call_recording_fsfile_id||!t.permissionService.hasPermission("call_recordings_read")))}}function Kh(e,t){if(1&e){const e=a.kc();a.ic(0,"button",114),a.qc("click",(function(){return a.Qc(e),a.uc(2).pauseAudio()})),a.ic(1,"mat-icon",7),a.dd(2,"pause"),a.hc(),a.hc()}if(2&e){const e=a.uc(2);a.Bc("disabled",e.disablePauseBtn)}}function eb(e,t){if(1&e){const e=a.kc();a.ic(0,"button",115),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit,n=a.uc();return n.getFileUrlPath(t.call_recording_fsfile_id),n.copiedToClipboard=!1})),a.dd(1," File URL "),a.ic(2,"mat-icon"),a.dd(3,"keyboard_arrow_down"),a.hc(),a.hc()}if(2&e){const e=a.uc(2),t=a.Mc(95);a.Bc("disabled",!e.permissionService.hasPermission("call_recordings_read"))("mat-menu-trigger-for",t)}}function tb(e,t){if(1&e){const e=a.kc();a.ic(0,"div",116),a.ic(1,"div",117,118),a.qc("click",(function(t){a.Qc(e);const n=a.Mc(2);return a.uc(2).onProgressBarClick(t,n)})),a.dc(3,"mat-progress-bar",119),a.hc(),a.hc()}if(2&e){const e=a.uc(2);a.Pb(3),a.Bc("value",e.progress)}}function nb(e,t){if(1&e){const e=a.kc();a.ic(0,"td",103),a.ic(1,"div",104),a.bd(2,Yh,3,0,"button",105),a.bd(3,Zh,3,4,"button",106),a.bd(4,Kh,3,1,"button",107),a.ic(5,"button",108),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().downloadFile(n.call_recording_fsfile_id)})),a.ic(6,"mat-icon",109),a.dd(7,"cloud_download"),a.hc(),a.hc(),a.bd(8,eb,4,2,"button",110),a.hc(),a.bd(9,tb,4,1,"div",111),a.hc()}if(2&e){const e=t.$implicit,n=a.uc();a.Pb(2),a.Bc("ngIf",n.audioPlaying&&n.audioPlaying===e.call_recording_fsfile_id),a.Pb(1),a.Bc("ngIf",n.audioPlaying!==e.call_recording_fsfile_id||n.pausedAudio===e.call_recording_fsfile_id),a.Pb(1),a.Bc("ngIf",n.audioPlaying&&n.audioPlaying===e.call_recording_fsfile_id&&n.pausedAudio!==e.call_recording_fsfile_id),a.Pb(1),a.Bc("disabled",!e.call_recording_fsfile_id||!n.permissionService.hasPermission("call_recordings_read")),a.Pb(1),a.Bc("ngClass",a.Gc(7,Jh,!e.call_recording_fsfile_id||!n.permissionService.hasPermission("call_recordings_read"))),a.Pb(2),a.Bc("ngIf",e.call_recording_fsfile_id),a.Pb(1),a.Bc("ngIf",n.audioPlaying&&n.audioPlaying===e.call_recording_fsfile_id)}}function ib(e,t){1&e&&a.dc(0,"tr",120)}function cb(e,t){if(1&e){const e=a.kc();a.ic(0,"tr",121),a.qc("dblclick",(function(){a.Qc(e);const n=t.$implicit;return a.uc().openContact(n.contact)}))("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().onTableRowClick(n)})),a.hc()}2&e&&a.Tb("even",t.even)}function ab(e,t){1&e&&(a.ic(0,"div",122),a.dc(1,"mat-progress-spinner",123),a.dd(2," Loading... "),a.hc())}function ob(e,t){1&e&&(a.ic(0,"div",124),a.dd(1," No Results Found "),a.hc())}function sb(e,t){if(1&e){const e=a.kc();a.ic(0,"paginator",125),a.qc("updatePerPage",(function(t){return a.Qc(e),a.uc().updateResultsPerPage(t)}))("goPage",(function(t){return a.Qc(e),a.uc().goToPage(t)})),a.hc()}if(2&e){const e=a.uc();a.Bc("showPaginationLoader",e.paginator.showPaginationLoader)("totalCount",e.paginator.totalCount)("perPage",e.paginator.resultsPerPage)("currentPage",e.paginator.currentPage)("prevButton",e.paginator.prevButton)("nextButton",e.paginator.nextButton)}}const rb=function(e){return{show:e}};let db=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g,h,b,p,v,m,f,S,_,y,C){this.permissionService=e,this.agentCampaignService=t,this.agentCallDispositionService=n,this.agentBucketService=i,this.agentUserService=c,this.agentQueueService=a,this._fb=o,this._dialog=s,this._snackBar=r,this._webCallBackService=d,this._callBackQueueService=l,this._authService=u,this._systemDispositionService=g,this._liveFilterService=h,this._fileSystemFileService=b,this._agentNavService=p,this._utils=v,this._myRecentCallsService=m,this._callTypeService=f,this._userPreferenceService=S,this._inboundRouteMinimalService=_,this._permissionService=y,this._agentContactService=C,this.recentCalls=[],this.systemDispositions=[],this.callTypes=[],this.alreadyGotData=!1,this.liveFilters=[],this.loading=!1,this.timerCount=0,this.audioPlaying=null,this.audio=null,this.copiedToClipboard=!1,this.showFilterSection=!1,this.disablePauseBtn=!1,this.inboundRoutes=[],this.inboundRouteMap=[],this.liveFilterMap=[],this.callBackQueueMap=[],this.webCallBackMap=[],this.systemDispoGroups=[],this.selectedColumns=[],this.defaultColumns=["destination","call_type","system_disposition","start","end","duration","billsec","source","campaign","contact","app_user","call_disposition","transferred_to","live_filter","bucket","inbound_route","queue","created_on","controls"],this.remainingTime=0,this.currentTime=0,this.progress=0,this.pausedAudio=null,this.fileFetchedMap=new Map,this.selection=new zl.c(!0,[]),this.paginator={showPaginationLoader:!1,totalCount:null,prevButton:"",nextButton:"",currentPage:1,resultsPerPage:25},this.userId=this._authService.getUserId(),this.filterForm=this._fb.group({call_type:null,queue_id:null,system_disposition:null,live_filter_id:null,campaign_id:null,destination:null,call_disposition_id:null,bucket_id:null,inbound_route_id:null,start:null,billsec__range_min:null,billsec__range_max:null,start__date_local_today:!1,contact_id:null})}ngOnInit(){this.agentDashboardNavSubscription=this._agentNavService.activeTopSectionSubject.subscribe({next:e=>{"recent-calls"!==e||this.alreadyGotData||(this._getRecentCalls(),this.alreadyGotData=!0)}}),this._getCallTypes(),this._getSystemDispositions(),this._getLiveFilters(),this._getWebCallBacks(),this._getCallBackQueues(),this._userPreferenceService.getUserPreferences(),this._userPreferenceService.userPreferenceSubject.subscribe(e=>{if(e){let t=e.calls_table_columns;t&&t.length?(t=t.filter(e=>"controls"!==e),t.push("controls"),this.selectedColumns=t):this.selectedColumns=JSON.parse(JSON.stringify(this.defaultColumns)),this.selectedColumns.includes("select")||this.selectedColumns.unshift("select")}})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe()}showEditTableDialog(){const e=JSON.parse(JSON.stringify(this.selectedColumns));e.shift(),this._dialog.open(Ug.a,{width:"1200px",data:{selectedColumns:e,allColumns:this.defaultColumns}}).afterClosed().subscribe({next:e=>{e&&(this.selectedColumns=e,this.selectedColumns.includes("select")||this.selectedColumns.unshift("select"))}})}clearFilterForm(){this.filterForm=this._fb.group({call_type:null,queue_id:null,system_disposition:null,live_filter_id:null,campaign_id:null,destination:null,call_disposition_id:null,bucket_id:null,inbound_route_id:null,start:null,billsec__range_min:null,billsec__range_max:null,start__date_local_today:!1,contact_id:""})}onViewTodaysEventsChecked(e){e.target.checked?(this.filterForm.get("start").setValue(""),this.filterForm.get("start").disable()):this.filterForm.get("start").enable()}onFilterResults(){this.paginator.currentPage=1,this._getRecentCalls(),this._snackBar.open("Filtering..","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}copyToClipboard(){this._utils.copyToClipboard(this.fsFileUrl),this.copiedToClipboard=!0}downloadFile(e){this.permissionService.hasPermission("call_recordings_read")&&this._fileSystemFileService.download(e).subscribe({next:e=>{let t=e.type,n=[];n.push(e);let i=document.createElement("a");i.href=window.URL.createObjectURL(new Blob(n,{type:t}));const c="call-recording-"+(new Date).toISOString().split(".")[0];i.setAttribute("download",c),document.body.appendChild(i),i.click()},error:e=>{this.loading=!1,404===e.status?this._snackBar.open("File Not Found","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):403===e.status?this._snackBar.open("You don't have permission to access this file","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):this._snackBar.open(this._utils.handleErrorResponse(e,"Error Downloading File"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}getFileUrlPath(e){this.permissionService.hasPermission("call_recordings_read")?(this.fsFileUrl="",this._fileSystemFileService.getFileUrl(e).subscribe({next:e=>{this.fsFileUrl=e.file_url}})):this.fsFileUrl=""}openContact(e){e&&this._userHasContactReadPermission()&&this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"Details",contactIds:[e],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&"viewOnDashboard"===t&&this.viewContactOnDashboard(e)}})}onProgressBarClick(e,t){if(this.audio&&this.audio.duration){const n=t.getBoundingClientRect();this.audio.currentTime=this.audio.duration*((e.clientX-n.left)/n.width)}}pauseAudio(){this.pausedAudio=this.audioPlaying,this.audio.pause()}stopAudio(){this.pausedAudio=null,this.audio.pause(),this.audio=null,this.audioPlaying=null,this.currentTime=0,this.progress=0}playAudio(e,t){if(!this.permissionService.hasPermission("call_recordings_read"))return;const n=this.recentCalls.find(t=>t.id===e);if(this.audio&&this.pausedAudio&&this.pausedAudio===n.call_recording_fsfile_id)return this.audio.play().catch(()=>{}),void(this.pausedAudio=null);this.audioPlaying&&(this.stopAudio(),setTimeout(()=>{},300)),this.fileFetchedMap.has(n.call_recording_fsfile_id)?this._setupAudio(n.call_recording_fsfile_id):this._fileSystemFileService.download(n.call_recording_fsfile_id).subscribe({next:e=>{this.fileFetchedMap.set(n.call_recording_fsfile_id,e),this._setupAudio(n.call_recording_fsfile_id)},error:e=>{404===e.status?this._snackBar.open("File Not Found","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):403===e.status?this._snackBar.open("You don't have permission to access this file","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):this._snackBar.open(this._utils.handleErrorResponse(e,"Error Playing Audio"),"X",{duration:3e3,verticalPosition:"top",panelClass:"error"}),this.audioPlaying=null}})}_setupAudio(e){this.audioPlaying=e,this.audio=document.createElement("audio"),this.audio.src=URL.createObjectURL(this.fileFetchedMap.get(e)),this.audio.play().catch(()=>{}),this.audio.ontimeupdate=()=>{if(this.audio){const e=this.audio.currentTime,t=this.audio.duration;isNaN(t)||(this.remainingTime=t-e,this.currentTime=e,this.progress=e/t*100)}},this.audio.onended=()=>{this.audioPlaying=null}}refreshRecentCallsTable(){this.timerInterval||(this.loading=!0,this._getRecentCalls(),this.timerInterval=setInterval(()=>{this.timerCount++,this.timerCount>=15&&(clearInterval(this.timerInterval),this.timerInterval=null,this.timerCount=0)},1e3))}goToPage(e){this.paginator.currentPage=e,this._getRecentCalls()}updateResultsPerPage(e){this.paginator.currentPage=1,this.paginator.resultsPerPage=e,this._getRecentCalls()}_userHasContactReadPermission(){return!!this._permissionService.hasPermission("contacts_read")||(this._snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}),!1)}viewContactOnDashboard(e){if(!this._userHasContactReadPermission())return;let t;if(e)t=e;else{const e=this.selection.selected[0];if(!e||!e.contact)return;t=e.contact}this._agentContactService.getContact(t),this._agentNavService.activeTopSectionSubject.next("dashboard"),this._agentNavService.activeDashboardSectionSubject.next("contact"),this.selection.clear()}onCheckboxChange(e,t){e.checked?(this.selection.selected.length&&this.selection.selected[0].id!==t.id&&this.selection.clear(),this.selection.select(t)):this.selection.deselect(t)}onTableRowClick(e){this.selection.isSelected(e)?this.selection.deselect(e):(this.selection.selected.length&&this.selection.selected[0].id!==e.id&&this.selection.clear(),this.selection.select(e))}openContactDialog(e){this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"Details",contactIds:[e],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&"viewOnDashboard"===t?this.viewContactOnDashboard(e):this.selection.clear()}})}viewContact(e){this._userHasContactReadPermission()&&(e||(e=this.selection.selected[0]),this.openContactDialog(e.contact))}_getRecentCalls(){this.loading=!0,this._myRecentCallsService.filter(this.paginator.resultsPerPage,this.paginator.currentPage,this.filterForm.value).subscribe({next:e=>{this.recentCalls=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.loading=!1,this._createInboundRouteMap()},error:e=>{this.loading=!1,this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Recent Calls"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}_createInboundRouteMap(){const e=this.recentCalls.map(e=>e.inbound_route);let t=[...new Set(e)];t=t.filter(e=>e),t.length&&this._inboundRouteMinimalService.getIdIn(t).subscribe({next:e=>{e.results.forEach(e=>{this.inboundRouteMap[e.id]=e.name?e.name:e.did})}})}_getLiveFilters(){this._liveFilterService.list("max").subscribe({next:e=>{this.liveFilters=e.results,e.results.forEach(e=>{this.liveFilterMap[e.id]=e.name})}})}_getCallBackQueues(){this._callBackQueueService.list("max").subscribe({next:e=>{e.results.forEach(e=>{this.callBackQueueMap[e.id]=e.name})}})}_getWebCallBacks(){this._webCallBackService.list("max").subscribe({next:e=>{e.results.forEach(e=>{this.webCallBackMap[e.id]=e.name})}})}_getSystemDispositions(){this._systemDispositionService.list().subscribe({next:e=>{const t=["Answered Machine","Answered Notsure"],n=["Answered Human","Answered Human Agentconnect","Answered Machine Agentconnect","Answered Notsure Agentconnect","Answered Agentconnect"],i=["Answered Human Abandoned","Answered Machine Abandoned","Answered Notsure Abandoned","Answered Abandoned"];e.results.forEach(e=>{e=n.includes(e)?{group:"agent_connect",name:e}:i.includes(e)?{group:"abandoned",name:e}:t.includes(e)?{group:"answered_machine",name:e}:{group:"none",name:e},this.systemDispositions.push(e)}),this.systemDispositions.forEach(e=>{-1===this.systemDispoGroups.findIndex(t=>t===e.group)&&this.systemDispoGroups.push(e.group)})}})}_getCallTypes(){this._callTypeService.list().subscribe({next:e=>{this.callTypes=e.results}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(A.a),a.bc(l.a),a.bc(b.a),a.bc(Ul),a.bc(g.a),a.bc(u.a),a.bc(te.f),a.bc(Y.b),a.bc(k.a),a.bc(Qg.a),a.bc(Rg.a),a.bc(r.a),a.bc(Vl.a),a.bc(Ag.a),a.bc(wa.a),a.bc(d.a),a.bc(D.a),a.bc($e.a),a.bc(Eg.a),a.bc(q.a),a.bc(Vg.a),a.bc(A.a),a.bc(f.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-recent-calls"]],decls:115,vars:17,consts:[[1,"dyn-card","dyn-m-0"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],["mat-stroked-button","","color","primary",1,"dyn-m-r-10",3,"click"],[1,"dyn-vertical-middle","dyn-m-r-5"],["mat-stroked-button","","color","",3,"click"],["class","dyn-vertical-middle",4,"ngIf"],["mat-mini-fab","","color","","matTooltip","Refresh Table",1,"dyn-no-shadow","dyn-m-l-10","refresh-btn",3,"click"],["color","primary"],[1,"dyn-m-0"],["class","dyn-bg-grey filter-section dyn-p-20 dyn-m-b-20",4,"ngIf"],[2,"overflow","auto"],["mat-table","",1,"dyn-full-width","collapse-view",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","dyn-p-l-20",4,"matCellDef"],["matColumnDef","bucket"],["mat-header-cell","","class","dyn-p-r-20",4,"matHeaderCellDef"],["mat-cell","","class","dyn-p-r-20",4,"matCellDef"],["matColumnDef","call_back_queue"],["matColumnDef","campaign"],["matColumnDef","duration"],["matColumnDef","end"],["matColumnDef","inbound"],["matColumnDef","inbound_route"],["matColumnDef","live_filter"],["matColumnDef","queue"],["matColumnDef","transferred_to"],["matColumnDef","web_call_back"],["matColumnDef","created_on"],["matColumnDef","contact"],["matColumnDef","start"],["matColumnDef","call_type"],["matColumnDef","destination"],["matColumnDef","source"],["matColumnDef","system_disposition"],["matColumnDef","call_disposition"],["matColumnDef","billsec"],["matColumnDef","app_user"],["matColumnDef","controls","stickyEnd",""],["mat-header-cell","","style","padding-left: 10px!important;","class","dyn-border-left",4,"matHeaderCellDef"],["mat-cell","","style","padding-left: 0!important; padding-right: 0!important;","class","dyn-border-left",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","dyn-table-hover",3,"even","dblclick","click",4,"matRowDef","matRowDefColumns"],["class","dyn-p-20",4,"ngIf"],["class","dyn-text-center dyn-p-20 dyn-text-muted",4,"ngIf"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage",4,"ngIf"],["copyFilePathMenu","matMenu"],[1,"dyn-p-10",3,"click"],["type","text",1,"dyn-m-r-10",2,"min-width","160px",3,"value"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"dyn-agent-table-pop-up","dyn-flex","dyn-align-items","dyn-space-between",3,"ngClass"],[1,"dyn-p-r-50"],["mat-stroked-button","","color","",1,"dyn-m-r-15",2,"border-color","#fff",3,"click"],[1,"material-icons","dyn-vertical-middle"],["mat-raised-button","",1,"dyn-m-r-20",3,"disabled","click"],["mat-raised-button","",3,"disabled","click"],[1,"dyn-vertical-middle"],[1,"dyn-bg-grey","filter-section","dyn-p-20","dyn-m-b-20"],[3,"formGroup","keydown.enter"],[2,"display","grid","grid-gap","5px 12px","grid-template-columns","repeat(auto-fit, minmax(160px, 1fr))"],["formControlName","contact_id","type","number",1,"dyn-full-width"],["formControlName","call_type",1,"dyn-full-width"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["formControlName","queue_id",1,"dyn-full-width"],[3,"ngValue",4,"ngFor","ngForOf"],["id","system_disposition","appearance","outline",1,"dyn-full-width","dyn-search-select"],["formControlName","system_disposition","disableRipple",""],["systemDispoSelect",""],[2,"width","296px"],[1,"dyn-menu-option-sm","dyn-full-width",3,"value"],[4,"ngFor","ngForOf"],[1,"dyn-text-sm","dyn-menu-option-sm","dyn-full-width",3,"value"],[1,"dyn-flex","dyn-align-items"],["type","number","formControlName","billsec__range_min",1,"dyn-full-width"],[1,"dyn-p-l-10","dyn-p-r-10"],["type","number","formControlName","billsec__range_max",1,"dyn-full-width"],["formControlName","live_filter_id",1,"dyn-full-width"],["type","text","formControlName","start",1,"dyn-full-width",3,"selectMode","owlDateTime","owlDateTimeTrigger"],["hour12Timer","true",3,"disabled"],["dt1",""],["formControlName","campaign_id",1,"dyn-full-width"],["type","text","formControlName","destination",1,"dyn-full-width"],["formControlName","call_disposition_id",1,"dyn-full-width"],["formControlName","bucket_id",1,"dyn-full-width"],[1,"dyn-m-t-20","dyn-text-center"],["type","checkbox","id","start__date_local_today","formControlName","start__date_local_today",3,"change"],["for","start__date_local_today"],["mat-raised-button","","color","",1,"dyn-m-l-10",3,"click"],["mat-raised-button","","color","primary",1,"dyn-m-l-10",3,"click"],[3,"value"],["class","dyn-text-sm dyn-menu-option-sm dyn-full-width",3,"value",4,"ngIf"],["mat-header-cell",""],["mat-cell","",1,"dyn-p-l-20"],[1,"dyn-p-l-5",3,"checked","click","change"],["mat-header-cell","",1,"dyn-p-r-20"],["mat-cell","",1,"dyn-p-r-20"],["src","/assets/img/check-icon.svg","height","18px","class","dyn-vertical-middle dyn-m-l-5",4,"ngIf"],["src","/assets/img/cancel-icon.svg","height","18px","class","dyn-vertical-middle dyn-m-l-5",4,"ngIf"],["src","/assets/img/check-icon.svg","height","18px",1,"dyn-vertical-middle","dyn-m-l-5"],["src","/assets/img/cancel-icon.svg","height","18px",1,"dyn-vertical-middle","dyn-m-l-5"],[1,"dyn-link","dyn-underline",3,"click"],["mat-header-cell","",1,"dyn-border-left",2,"padding-left","10px!important"],["mat-cell","",1,"dyn-border-left",2,"padding-left","0!important","padding-right","0!important"],[2,"padding-left","10px","padding-right","10px"],["mat-mini-fab","","color","","class","dyn-no-shadow dyn-button-sm dyn-m-r-5 dyn-vertical-middle",3,"click",4,"ngIf"],["mat-mini-fab","","color","","matTooltip","Play Audio","class","dyn-no-shadow dyn-button-sm dyn-m-r-5 dyn-vertical-middle",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","color","","class","dyn-no-shadow dyn-button-sm dyn-m-r-5 dyn-vertical-middle","matTooltip","Pause Audio",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","color","","matTooltip","Download File",1,"dyn-no-shadow","dyn-button-sm","dyn-vertical-middle",3,"disabled","click"],["color","primary",3,"ngClass"],["mat-button","","color","primary","class","dyn-m-l-10",3,"disabled","mat-menu-trigger-for","click",4,"ngIf"],["class","dyn-m-t-10",4,"ngIf"],["mat-mini-fab","","color","",1,"dyn-no-shadow","dyn-button-sm","dyn-m-r-5","dyn-vertical-middle",3,"click"],["mat-mini-fab","","color","","matTooltip","Play Audio",1,"dyn-no-shadow","dyn-button-sm","dyn-m-r-5","dyn-vertical-middle",3,"disabled","click"],["mat-mini-fab","","color","","matTooltip","Pause Audio",1,"dyn-no-shadow","dyn-button-sm","dyn-m-r-5","dyn-vertical-middle",3,"disabled","click"],["mat-button","","color","primary",1,"dyn-m-l-10",3,"disabled","mat-menu-trigger-for","click"],[1,"dyn-m-t-10"],[3,"click"],["progressBar",""],["mode","determinate",3,"value"],["mat-header-row",""],["mat-row","",1,"dyn-table-hover",3,"dblclick","click"],[1,"dyn-p-20"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-text-center","dyn-p-20","dyn-text-muted"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"h1"),a.dd(3,"Recent Calls"),a.hc(),a.ic(4,"div"),a.ic(5,"button",2),a.qc("click",(function(){return t.showEditTableDialog()})),a.ic(6,"mat-icon",3),a.dd(7,"edit"),a.hc(),a.dd(8," Edit Table "),a.hc(),a.ic(9,"button",4),a.qc("click",(function(){return t.showFilterSection=!t.showFilterSection})),a.bd(10,Hg,2,0,"mat-icon",5),a.bd(11,Lg,2,0,"mat-icon",5),a.dd(12," Filter Results "),a.hc(),a.ic(13,"button",6),a.qc("click",(function(){return t.refreshRecentCallsTable()})),a.ic(14,"mat-icon",7),a.dd(15,"refresh"),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(16,"hr",8),a.bd(17,nh,95,22,"div",9),a.ic(18,"div",10),a.ic(19,"table",11),a.gc(20,12),a.bd(21,ih,2,0,"th",13),a.bd(22,ch,2,1,"td",14),a.fc(),a.gc(23,15),a.bd(24,ah,2,0,"th",16),a.bd(25,oh,2,1,"td",17),a.fc(),a.gc(26,18),a.bd(27,sh,2,0,"th",16),a.bd(28,rh,2,1,"td",17),a.fc(),a.gc(29,19),a.bd(30,dh,2,0,"th",16),a.bd(31,lh,2,1,"td",17),a.fc(),a.gc(32,20),a.bd(33,uh,2,0,"th",16),a.bd(34,gh,3,3,"td",17),a.fc(),a.gc(35,21),a.bd(36,hh,2,0,"th",16),a.bd(37,bh,3,4,"td",17),a.fc(),a.gc(38,22),a.bd(39,ph,2,0,"th",16),a.bd(40,fh,3,2,"td",17),a.fc(),a.gc(41,23),a.bd(42,Sh,2,0,"th",16),a.bd(43,_h,2,1,"td",17),a.fc(),a.gc(44,24),a.bd(45,yh,2,0,"th",16),a.bd(46,Ch,2,1,"td",17),a.fc(),a.gc(47,25),a.bd(48,Ph,2,0,"th",16),a.bd(49,wh,2,1,"td",17),a.fc(),a.gc(50,26),a.bd(51,Mh,2,0,"th",16),a.bd(52,xh,2,1,"td",17),a.fc(),a.gc(53,27),a.bd(54,Bh,2,0,"th",16),a.bd(55,kh,2,1,"td",17),a.fc(),a.gc(56,28),a.bd(57,Fh,2,0,"th",16),a.bd(58,Ih,3,4,"td",17),a.fc(),a.gc(59,29),a.bd(60,Dh,2,0,"th",16),a.bd(61,Th,3,1,"td",17),a.fc(),a.gc(62,30),a.bd(63,jh,2,0,"th",16),a.bd(64,Oh,3,4,"td",17),a.fc(),a.gc(65,31),a.bd(66,Nh,2,0,"th",16),a.bd(67,qh,2,1,"td",17),a.fc(),a.gc(68,32),a.bd(69,$h,2,0,"th",16),a.bd(70,Eh,2,1,"td",17),a.fc(),a.gc(71,33),a.bd(72,Ah,2,0,"th",16),a.bd(73,Qh,2,1,"td",17),a.fc(),a.gc(74,34),a.bd(75,Rh,2,0,"th",16),a.bd(76,Uh,2,1,"td",17),a.fc(),a.gc(77,35),a.bd(78,Vh,2,0,"th",16),a.bd(79,Wh,2,1,"td",17),a.fc(),a.gc(80,36),a.bd(81,zh,2,0,"th",16),a.bd(82,Hh,3,3,"td",17),a.fc(),a.gc(83,37),a.bd(84,Lh,2,0,"th",16),a.bd(85,Xh,2,1,"td",17),a.fc(),a.gc(86,38),a.bd(87,Gh,2,0,"th",39),a.bd(88,nb,10,9,"td",40),a.fc(),a.bd(89,ib,1,0,"tr",41),a.bd(90,cb,1,2,"tr",42),a.hc(),a.bd(91,ab,3,0,"div",43),a.bd(92,ob,2,0,"div",44),a.hc(),a.bd(93,sb,1,6,"paginator",45),a.ic(94,"mat-menu",null,46),a.ic(96,"div",47),a.qc("click",(function(e){return e.stopPropagation()})),a.dc(97,"input",48),a.ic(98,"button",49),a.qc("click",(function(){return t.copyToClipboard()})),a.dd(99),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(100,"div",50),a.ic(101,"div",51),a.ic(102,"button",52),a.qc("click",(function(){return t.selection.clear()})),a.ic(103,"i",53),a.dd(104,"close"),a.hc(),a.dd(105," Clear Selection "),a.hc(),a.hc(),a.ic(106,"div"),a.ic(107,"button",54),a.qc("click",(function(){return t.viewContactOnDashboard()})),a.ic(108,"i",53),a.dd(109,"arrow_back"),a.hc(),a.dd(110," View on Dashboard "),a.hc(),a.ic(111,"button",55),a.qc("click",(function(){return t.viewContact()})),a.ic(112,"i",53),a.dd(113,"edit"),a.hc(),a.dd(114," Edit Contact "),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(10),a.Bc("ngIf",!t.showFilterSection),a.Pb(1),a.Bc("ngIf",t.showFilterSection),a.Pb(6),a.Bc("ngIf",t.showFilterSection),a.Pb(2),a.Bc("dataSource",t.recentCalls),a.Pb(70),a.Bc("matHeaderRowDef",t.selectedColumns),a.Pb(1),a.Bc("matRowDefColumns",t.selectedColumns),a.Pb(1),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.recentCalls.length&&!t.loading),a.Pb(1),a.Bc("ngIf",t.recentCalls.length),a.Pb(4),a.Bc("value",t.fsFileUrl),a.Pb(1),a.Bc("disabled",t.copiedToClipboard),a.Pb(1),a.ed(t.copiedToClipboard?"Copied!":"Copy"),a.Pb(1),a.Bc("ngClass",a.Gc(15,rb,t.selection.selected.length)),a.Pb(7),a.Bc("disabled",!(null!=t.selection.selected[0]&&t.selection.selected[0].contact)),a.Pb(4),a.Bc("disabled",!(null!=t.selection.selected[0]&&t.selection.selected[0].contact)))},directives:[le.b,ge.a,J.p,ue.a,Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,cn.f,J.n,te.B,te.q,te.i,te.d,te.u,te.p,te.h,te.y,te.t,te.A,J.o,K.b,ee.a,ne.o,on.b,on.d,on.a,te.a,Uo.h,Uo.a,Xl.a,cn.e,Wg.a,Uo.j,Uo.l,fe.a,pl.a],pipes:[zg.a,J.f],styles:["td.mat-cell[_ngcontent-%COMP%], th.mat-header-cell[_ngcontent-%COMP%]{white-space:nowrap;padding:0 20px 0 0!important}th.mat-header-cell[_ngcontent-%COMP%]{padding-top:5px!important;padding-bottom:5px!important}.mat-icon[_ngcontent-%COMP%]{transition:.5s;-webkit-user-select:none;user-select:none;cursor:pointer}.mat-icon.active[_ngcontent-%COMP%]{transform:rotate(90deg)}.shading-left[_ngcontent-%COMP%]{padding-left:40px;box-sizing:border-box}"]}),e})();var lb=n("MkU4"),ub=n("/qTK"),gb=n("DqX8");const hb=["vmMessageTable"];function bb(e,t){if(1&e&&(a.ic(0,"option",39),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function pb(e,t){if(1&e){const e=a.kc();a.ic(0,"div"),a.ic(1,"label"),a.dd(2,"Select a Voice Mail"),a.hc(),a.dc(3,"br"),a.ic(4,"select",37),a.qc("ngModelChange",(function(t){return a.Qc(e),a.uc().selectedVoiceMail=t}))("ngModelChange",(function(){return a.Qc(e),a.uc().onVoicemailChange()})),a.bd(5,bb,2,2,"option",38),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(4),a.Bc("ngModel",e.selectedVoiceMail),a.Pb(1),a.Bc("ngForOf",e.voicemails)}}function vb(e,t){1&e&&(a.ic(0,"mat-icon",40),a.dd(1,"search"),a.hc())}function mb(e,t){1&e&&(a.ic(0,"mat-icon",40),a.dd(1,"close"),a.hc())}function fb(e,t){1&e&&(a.ic(0,"div"),a.ic(1,"label"),a.dd(2,"Transcript Search"),a.hc(),a.dc(3,"br"),a.dc(4,"input",52),a.hc())}function Sb(e,t){if(1&e){const e=a.kc();a.ic(0,"div",41),a.ic(1,"form",42),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc();return t.preventDefault(),n.onFilterResults()})),a.ic(2,"div",43),a.bd(3,fb,5,0,"div",4),a.ic(4,"div"),a.ic(5,"label"),a.dd(6,"Contact ID"),a.hc(),a.dc(7,"br"),a.dc(8,"input",44),a.hc(),a.ic(9,"div"),a.ic(10,"label"),a.dd(11,"Caller ID Phone Number"),a.hc(),a.dc(12,"br"),a.dc(13,"input",45),a.hc(),a.ic(14,"div"),a.ic(15,"label"),a.dd(16,"Duration (Seconds)"),a.hc(),a.dc(17,"br"),a.ic(18,"div",2),a.dc(19,"input",46),a.ic(20,"span",47),a.dd(21,"to"),a.hc(),a.dc(22,"input",48),a.hc(),a.hc(),a.hc(),a.ic(23,"div",49),a.ic(24,"button",50),a.qc("click",(function(){return a.Qc(e),a.uc().clearFilterForm()})),a.dd(25,"Clear Filters"),a.hc(),a.ic(26,"button",51),a.qc("click",(function(){return a.Qc(e),a.uc().onFilterResults()})),a.dd(27,"Filter"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("formGroup",e.filterForm),a.Pb(2),a.Bc("ngIf",e.voicemailTranscribe)}}function _b(e,t){if(1&e){const e=a.kc();a.ic(0,"th",53),a.ic(1,"mat-checkbox",54),a.qc("change",(function(t){a.Qc(e);const n=a.uc();return t?n.masterToggle():null})),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function yb(e,t){if(1&e){const e=a.kc();a.ic(0,"td",55),a.ic(1,"mat-checkbox",56),a.qc("click",(function(t){return a.Qc(e),t.stopPropagation()}))("change",(function(n){a.Qc(e);const i=t.$implicit,c=a.uc();return n&&c.selection.toggle(i),n.checked?null:c.selectedType="selected"})),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("checked",n.selection.isSelected(e))}}function Cb(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Transcript "),a.hc())}function Pb(e,t){if(1&e){const e=a.kc();a.ic(0,"span",60),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc().showFullTranscript(t)})),a.dd(1),a.vc(2,"slice"),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(' "',a.yc(2,1,e.transcript,0,30)+"..",'" ')}}function wb(e,t){if(1&e){const e=a.kc();a.ic(0,"span",60),a.qc("click",(function(){a.Qc(e);const t=a.uc(2).$implicit;return a.uc().showFullTranscript(t)})),a.dd(1),a.hc()}if(2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(' "',e.transcript,'" ')}}function Mb(e,t){if(1&e&&(a.gc(0),a.bd(1,Pb,3,5,"span",59),a.bd(2,wb,2,1,"span",59),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf",(null==e.transcript?null:e.transcript.length)>=30),a.Pb(1),a.Bc("ngIf",(null==e.transcript?null:e.transcript.length)<30)}}function xb(e,t){if(1&e&&(a.ic(0,"td",58),a.bd(1,Mb,3,2,"ng-container",4),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.transcript)}}function Bb(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Contact "),a.hc())}function kb(e,t){if(1&e){const e=a.kc();a.ic(0,"td",55),a.ic(1,"span",61),a.dd(2),a.hc(),a.ic(3,"mat-menu",null,62),a.ic(5,"button",63),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().openContact(n.contact)})),a.dd(6,"Open Contact"),a.hc(),a.ic(7,"button",63),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().viewContactOnDashboard(n.contact)})),a.dd(8,"View on Dashboard"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.Mc(4);a.Pb(1),a.Bc("mat-menu-trigger-for",n),a.Pb(1),a.fd(" ",e.contact," ")}}function Fb(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Received On "),a.hc())}function Ib(e,t){if(1&e&&(a.ic(0,"td",55),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.created_on,"MMM d, y, h:mm a")," ")}}function Db(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Duration "),a.hc())}function Tb(e,t){if(1&e&&(a.ic(0,"td",55),a.dd(1),a.vc(2,"secondFormatter"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.wc(2,1,e.duration)," ")}}function jb(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Reviewed On "),a.hc())}function Ob(e,t){if(1&e&&(a.ic(0,"td",55),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.reviewed_on,"MMM d, y, h:mm a")," ")}}function Nb(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Caller ID Number "),a.hc())}function qb(e,t){if(1&e&&(a.ic(0,"td",55),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.caller_id_number," ")}}function $b(e,t){1&e&&(a.ic(0,"th",57),a.dd(1," Controls "),a.hc())}const Eb=function(e){return{"dyn-opacity-30":e}};function Ab(e,t){if(1&e){const e=a.kc();a.ic(0,"button",69),a.qc("click",(function(){a.Qc(e);const t=a.uc().$implicit;return a.uc().playAudio(t.id,t.fsfile)})),a.ic(1,"mat-icon",67),a.dd(2,"play_arrow"),a.hc(),a.hc()}if(2&e){const e=a.uc().$implicit;a.Bc("disabled",!e.fsfile),a.Pb(1),a.Bc("ngClass",a.Gc(2,Eb,!e.fsfile))}}function Qb(e,t){if(1&e){const e=a.kc();a.ic(0,"button",70),a.qc("click",(function(){return a.Qc(e),a.uc(2).onPauseAudio()})),a.ic(1,"mat-icon",9),a.dd(2,"pause"),a.hc(),a.hc()}}function Rb(e,t){if(1&e){const e=a.kc();a.ic(0,"td",55),a.bd(1,Ab,3,4,"button",64),a.bd(2,Qb,3,0,"button",65),a.ic(3,"button",66),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().downloadFile(n.id,n.fsfile)})),a.ic(4,"mat-icon",67),a.dd(5,"cloud_download"),a.hc(),a.hc(),a.ic(6,"button",68),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().showDeleteVoicemailMessageConfirmation(n.id)})),a.dd(7,"Delete"),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.Bc("ngIf",n.audioPlaying!==e.id),a.Pb(1),a.Bc("ngIf",n.audioPlaying===e.id),a.Pb(1),a.Bc("disabled",!e.fsfile),a.Pb(1),a.Bc("ngClass",a.Gc(4,Eb,!e.fsfile))}}function Ub(e,t){1&e&&a.dc(0,"tr",71)}function Vb(e,t){1&e&&a.dc(0,"tr",72),2&e&&a.Tb("even",t.even)}function Wb(e,t){1&e&&(a.ic(0,"div",73),a.dc(1,"mat-progress-spinner",74),a.dd(2," Loading... "),a.hc())}function zb(e,t){1&e&&(a.ic(0,"div",75),a.dd(1," No Results Found "),a.hc())}function Hb(e,t){if(1&e){const e=a.kc();a.ic(0,"paginator",76),a.qc("updatePerPage",(function(t){return a.Qc(e),a.uc().updateResultsPerPage(t)}))("goPage",(function(t){return a.Qc(e),a.uc().goToPage(t)})),a.hc()}if(2&e){const e=a.uc();a.Bc("showPaginationLoader",e.paginator.showPaginationLoader)("totalCount",e.paginator.totalCount)("perPage",e.paginator.resultsPerPage)("currentPage",e.paginator.currentPage)("prevButton",e.paginator.prevButton)("nextButton",e.paginator.nextButton)}}const Lb=function(e){return{show:e}};let Xb=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r,d,l,u,g){this.agentContactService=e,this.dialog=t,this.snackBar=n,this.authService=i,this.agentNavService=c,this.voicemailService=a,this.utils=o,this.fileSystemFileService=s,this.voicemailMessageService=r,this.webPhoneSessionsService=d,this._permissionService=l,this._agentAccountSettingsService=u,this._fb=g,this.voicemails=[],this.selectedVoiceMail=null,this.voicemailMessages=[],this.alreadyGotData=!1,this.loading=!1,this.timerCount=0,this.audioPlaying=null,this.selection=new zl.c(!0,[]),this.selectedType="selected",this.voicemailTranscribe=!1,this.tableColumns=["select","caller_id_number","contact","duration","reviewed_on","created_on","controls"],this.voicemailMap=[],this.showFilterSection=!1,this.paginator={showPaginationLoader:!1,totalCount:null,prevButton:"",nextButton:"",currentPage:1,resultsPerPage:25},this.filterForm=this._fb.group({transcript_search:"",contact_id:"",duration__range_min:"",duration__range_max:"",caller_id_number:""})}ngOnInit(){this.newVoicemailReceivedSubscription=this.agentNavService.newVoicemailReceived.subscribe({next:e=>{e&&this._getVoicemailMessages()}}),this.agentDashboardNavSubscription=this.agentNavService.activeTopSectionSubject.subscribe({next:e=>{"voicemails"===e&&(this.agentNavService.showAgentVoicemailAlert&&(this.agentNavService.showAgentVoicemailAlert=!1),this.alreadyGotData||(this._getVoicemails(),this.alreadyGotData=!0))}}),this.accountSettingsSubscription=this._agentAccountSettingsService.accountSettingsSubject.subscribe({next:e=>{e&&(this.accountSettings=e,this.voicemailTranscribe=this.accountSettings.voicemail_transcribe,this.voicemailTranscribe&&(this.tableColumns.includes("transcript")||this.tableColumns.splice(3,0,"transcript")))}})}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe(),this.accountSettingsSubscription.unsubscribe(),this.newVoicemailReceivedSubscription.unsubscribe()}clearFilterForm(){this.filterForm.reset(),this.paginator.currentPage=1,this._getVoicemailMessages(()=>{this.snackBar.open("Filter Form Cleared","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})})}onFilterResults(){this.paginator.currentPage=1,this._getVoicemailMessages(()=>{this.snackBar.open("Results Filtered","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})})}showFullTranscript(e){this.dialog.open(gb.a,{width:"600px",data:{voicemailMessage:e,voicemailMap:this.voicemailMap}}).afterClosed().subscribe({next:()=>{this._getVoicemailMessages()}})}isAllSelected(){const e=this.selection.selected.length;return(1!==e||1!==this.paginator.totalCount)&&e===this.voicemailMessages.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.voicemailMessages.forEach(e=>this.selection.select(e))}onBulkDelete(e){const t=(e?[e]:this.selection.selected).map(e=>e.id);1===t.length?this.showDeleteVoicemailMessageConfirmation(t[0]):this.dialog.open(en.a,{width:"600px",data:{title:`Delete these ${t.length} Voicemail Messages?`,buttonText:"Delete"}}).afterClosed().subscribe({next:e=>{e&&this.voicemailMessageService.bulkDelete(t).subscribe({next:e=>{e&&200===e.status?this.snackBar.open(e.body.message,"X",{duration:3e4,verticalPosition:"top",panelClass:["success"]}):(this.selection.clear(),this._getVoicemailMessages(),this.snackBar.open("Messages Successfully Deleted","X",{duration:3e3,verticalPosition:"top",panelClass:["success"]}))},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Deleting Messages"),"X",{duration:5e3,verticalPosition:"top",panelClass:["error"]})}})}})}showDeleteVoicemailMessageConfirmation(e){this.dialog.open(en.a,{width:"500px",data:{title:"Delete this voicemail message?",buttonText:"Delete"}}).afterClosed().subscribe({next:t=>{t&&this._deleteVoicemailMessage(e)}})}_deleteVoicemailMessage(e){this.voicemailMessageService.delete(e).subscribe({next:()=>{this._getVoicemailMessages(),this.snackBar.open("Voicemail Message Deleted","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})},error:e=>{this.snackBar.open(this.utils.handleErrorResponse(e,"Error Deleting Voicemail Message"),"X",{duration:5e4,verticalPosition:"top",panelClass:["error"]})}})}downloadFile(e,t){this.fileSystemFileService.download(t).subscribe({next:t=>{let n=t.type,i=[];i.push(t);let c=document.createElement("a");c.href=window.URL.createObjectURL(new Blob(i,{type:n}));const a="voice-mail-"+(new Date).toISOString().split(".")[0];c.setAttribute("download",a),document.body.appendChild(c),c.click(),this._updateReviewedOnDate(e)},error:e=>{404===e.status?this.snackBar.open("File Not Found","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):403===e.status?this.snackBar.open("You don't have permission to access this file","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open(this.utils.handleErrorResponse(e,"Error Downloading File"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}})}goToPage(e){this.paginator.currentPage=e,this._getVoicemailMessages()}updateResultsPerPage(e){this.paginator.currentPage=1,this.paginator.resultsPerPage=e,this._getVoicemailMessages()}openContact(e){this._userHasContactReadPermission()&&this.dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"Details",contactIds:[e],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{if(t&&"viewOnDashboard"===t){if(!this._userHasContactReadPermission())return;this.agentContactService.getContact(e),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact")}}})}onVoicemailChange(){this.paginator.currentPage=1,this.paginator.resultsPerPage=25,this._getVoicemailMessages()}onPauseAudio(){this.audio.pause(),this.audio=null,this.audioPlaying=null}playAudio(e,t){this.fileSystemFileService.download(t).subscribe({next:t=>{this.audio&&(this.audio.pause(),this.audio=null),this.audioPlaying=e,this.audio=document.createElement("audio"),this.audio.src=URL.createObjectURL(t),this.audio.play().catch(()=>{}),this.audio.onended=()=>{this.audioPlaying=null},this._updateReviewedOnDate(e)},error:e=>{404===e.status?this.snackBar.open("File Not Found","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):403===e.status?this.snackBar.open("You don't have permission to access this file","X",{duration:3e4,verticalPosition:"top",panelClass:["error"]}):this.snackBar.open(this.utils.handleErrorResponse(e,"Error Playing Audio"),"X",{duration:3e3,verticalPosition:"top",panelClass:["error"]})}})}refreshRecentVoiceMails(){this.timerInterval||(this.loading=!0,this.voicemailMessageService.getByVoicemail(this.selectedVoiceMail,this.paginator.resultsPerPage,this.paginator.currentPage,this.filterForm.value).subscribe({next:e=>{this.voicemailMessages=e.results,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.paginator.totalCount=e.count,this.loading=!1,this.timerInterval=setInterval(()=>{this.timerCount++,this.timerCount>=15&&(clearInterval(this.timerInterval),this.timerInterval=null,this.timerCount=0)},1e3)},error:e=>{this.loading=!1,this.snackBar.open(this.utils.handleErrorResponse(e,"Error Getting Recent Calls"),"X",{duration:3e3,verticalPosition:"top",panelClass:["success"]})}}))}showDeleteConfirmation(e){this.dialog.open(en.a,{width:"400px",data:{title:"Delete This Message?",buttonText:"Delete"}}).afterClosed().subscribe({next:t=>{t&&this.voicemailMessageService.delete(e.id).subscribe({next:()=>{const t=this.voicemailMessages.findIndex(t=>t.id===e.id);this.voicemailMessages.splice(t,1),this.vmMessageTable.renderRows(),this.snackBar.open("Message Deleted Successfully","X",{duration:3e3,verticalPosition:"top",panelClass:"success"})}})}})}viewContactOnDashboard(e){if(!this._userHasContactReadPermission())return;const t=this.agentContactService.contactSubject.value;(!t||t&&t.id!==e)&&this.agentContactService.getContact(e),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact")}_userHasContactReadPermission(){return!!this._permissionService.hasPermission("contacts_read")||(this.snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}),!1)}_getVoicemailMessages(e){this.voicemailMessageService.getByVoicemail(this.selectedVoiceMail,this.paginator.resultsPerPage,this.paginator.currentPage,this.filterForm.value).subscribe({next:t=>{this.voicemailMessages=t.results,this.paginator.totalCount=t.count,this.paginator.nextButton=t.next,this.paginator.prevButton=t.previous,this.loading=!1,e&&e()}})}_getVoicemails(){this.loading=!0,this.voicemailService.getByUserId(this.authService.getUserId(),200,this.paginator.currentPage).subscribe({next:e=>{e.results.length&&(this.selectedVoiceMail=e.results[0].id,this.voicemailMap[e.results[0].id]=e.results[0].name,this._getVoicemailMessages()),this.voicemails=e.results},error:()=>{this.loading=!1}})}_updateReviewedOnDate(e){this.voicemailMessageService.updateReviewedOnDate(e).subscribe({next:t=>{const n=this.voicemailMessages.findIndex(t=>t.id===e);this.voicemailMessages[n]=t,this.vmMessageTable.renderRows()}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(f.a),a.bc(Y.b),a.bc(k.a),a.bc(r.a),a.bc(d.a),a.bc(lb.a),a.bc(D.a),a.bc(wa.a),a.bc(ub.a),a.bc(C.a),a.bc(A.a),a.bc(P.a),a.bc(te.f))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-voicemails"]],viewQuery:function(e,t){var n;1&e&&a.Wc(hb,!0),2&e&&a.Lc(n=a.rc())&&(t.vmMessageTable=n.first)},decls:65,vars:19,consts:[[1,"dyn-card"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[1,"dyn-flex","dyn-align-items"],[1,"dyn-m-r-20"],[4,"ngIf"],["mat-stroked-button","",1,"dyn-m-r-10",3,"click"],["class","dyn-vertical-middle",4,"ngIf"],["mat-raised-button","","color","primary",1,"dyn-m-r-20",3,"disabled","click"],["mat-mini-fab","","color","","matTooltip","Refresh Table",1,"dyn-no-shadow",3,"click"],["color","primary"],[1,"dyn-m-0"],["class","dyn-bg-grey filter-section dyn-p-20",4,"ngIf"],["mat-table","",1,"dyn-full-width",3,"dataSource"],["vmMessageTable",""],["matColumnDef","select"],["mat-header-cell","","class","dyn-p-r-10",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","transcript"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","dyn-italic",4,"matCellDef"],["matColumnDef","contact"],["matColumnDef","created_on"],["matColumnDef","duration"],["matColumnDef","reviewed_on"],["matColumnDef","caller_id_number"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"even",4,"matRowDef","matRowDefColumns"],["class","dyn-p-20",4,"ngIf"],["class","dyn-text-center dyn-p-20 dyn-text-muted",4,"ngIf"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage",4,"ngIf"],[1,"dyn-table-pop-up","dyn-flex","dyn-align-items","dyn-space-between",3,"ngClass"],[1,"dyn-p-r-50"],["mat-stroked-button","","color","",1,"dyn-m-r-15",2,"border-color","#fff",3,"click"],[1,"material-icons","dyn-vertical-middle"],[1,"dyn-inline-block","dyn-m-r-15"],["mat-raised-button","",1,"dyn-m-r-15",3,"click"],[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"dyn-vertical-middle"],[1,"dyn-bg-grey","filter-section","dyn-p-20"],[3,"formGroup","keydown.enter"],[2,"display","grid","grid-gap","5px 12px","grid-template-columns","repeat(auto-fit, minmax(160px, 1fr))"],["type","number","formControlName","contact_id",1,"dyn-full-width"],["type","number","formControlName","caller_id_number",1,"dyn-full-width"],["type","number","formControlName","duration__range_min",1,"dyn-full-width"],[1,"dyn-p-l-10","dyn-p-r-10"],["type","number","formControlName","duration__range_max",1,"dyn-full-width"],[1,"dyn-m-t-20","dyn-text-center"],["mat-raised-button","","color","",1,"dyn-m-l-10",3,"click"],["mat-raised-button","","color","primary",1,"dyn-m-l-10",3,"click"],["type","text","formControlName","transcript_search",1,"dyn-full-width"],["mat-header-cell","",1,"dyn-p-r-10"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],["mat-header-cell",""],["mat-cell","",1,"dyn-italic"],["matTooltip","See Full Transcript","class","dyn-hover",3,"click",4,"ngIf"],["matTooltip","See Full Transcript",1,"dyn-hover",3,"click"],[1,"dyn-link","dyn-underline",3,"mat-menu-trigger-for"],["contactMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-mini-fab","","color","","class","dyn-no-shadow dyn-button-sm dyn-m-r-5","matTooltip","Play Audio",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","color","","class","dyn-no-shadow dyn-button-sm dyn-m-r-5","matTooltip","Play Audio",3,"click",4,"ngIf"],["mat-mini-fab","","color","","matTooltip","Download File",1,"dyn-no-shadow","dyn-button-sm",3,"disabled","click"],["color","primary",3,"ngClass"],["mat-button","","color","warn",3,"click"],["mat-mini-fab","","color","","matTooltip","Play Audio",1,"dyn-no-shadow","dyn-button-sm","dyn-m-r-5",3,"disabled","click"],["mat-mini-fab","","color","","matTooltip","Play Audio",1,"dyn-no-shadow","dyn-button-sm","dyn-m-r-5",3,"click"],["mat-header-row",""],["mat-row",""],[1,"dyn-p-20"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-text-center","dyn-p-20","dyn-text-muted"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"div",2),a.ic(3,"h1",3),a.dd(4,"Voice Mails"),a.hc(),a.bd(5,pb,6,2,"div",4),a.hc(),a.ic(6,"div"),a.ic(7,"button",5),a.qc("click",(function(){return t.showFilterSection=!t.showFilterSection})),a.bd(8,vb,2,0,"mat-icon",6),a.bd(9,mb,2,0,"mat-icon",6),a.dd(10),a.hc(),a.ic(11,"button",7),a.qc("click",(function(){return t.webPhoneSessionsService.recordVoiceMailGreeting(t.selectedVoiceMail)})),a.ic(12,"mat-icon"),a.dd(13,"mic"),a.hc(),a.dd(14," Record Greeting "),a.hc(),a.ic(15,"button",8),a.qc("click",(function(){return t.refreshRecentVoiceMails()})),a.ic(16,"mat-icon",9),a.dd(17,"refresh"),a.hc(),a.hc(),a.hc(),a.hc(),a.dc(18,"hr",10),a.bd(19,Sb,28,2,"div",11),a.ic(20,"table",12,13),a.gc(22,14),a.bd(23,_b,2,2,"th",15),a.bd(24,yb,2,1,"td",16),a.fc(),a.gc(25,17),a.bd(26,Cb,2,0,"th",18),a.bd(27,xb,2,1,"td",19),a.fc(),a.gc(28,20),a.bd(29,Bb,2,0,"th",18),a.bd(30,kb,9,2,"td",16),a.fc(),a.gc(31,21),a.bd(32,Fb,2,0,"th",18),a.bd(33,Ib,3,4,"td",16),a.fc(),a.gc(34,22),a.bd(35,Db,2,0,"th",18),a.bd(36,Tb,3,3,"td",16),a.fc(),a.gc(37,23),a.bd(38,jb,2,0,"th",18),a.bd(39,Ob,3,4,"td",16),a.fc(),a.gc(40,24),a.bd(41,Nb,2,0,"th",18),a.bd(42,qb,2,1,"td",16),a.fc(),a.gc(43,25),a.bd(44,$b,2,0,"th",18),a.bd(45,Rb,8,6,"td",16),a.fc(),a.bd(46,Ub,1,0,"tr",26),a.bd(47,Vb,1,2,"tr",27),a.hc(),a.bd(48,Wb,3,0,"div",28),a.bd(49,zb,2,0,"div",29),a.bd(50,Hb,1,6,"paginator",30),a.hc(),a.ic(51,"div",31),a.ic(52,"div",32),a.ic(53,"button",33),a.qc("click",(function(){return t.selection.clear()})),a.ic(54,"i",34),a.dd(55,"close"),a.hc(),a.dd(56," Clear Selection "),a.hc(),a.hc(),a.ic(57,"div"),a.ic(58,"span",35),a.dd(59),a.vc(60,"number"),a.hc(),a.ic(61,"button",36),a.qc("click",(function(){return t.onBulkDelete()})),a.ic(62,"i",34),a.dd(63,"delete"),a.hc(),a.dd(64),a.hc(),a.hc(),a.hc()),2&e&&(a.Pb(5),a.Bc("ngIf",t.voicemails.length>1),a.Pb(3),a.Bc("ngIf",!t.showFilterSection),a.Pb(1),a.Bc("ngIf",t.showFilterSection),a.Pb(1),a.fd(" ",t.showFilterSection?"Hide Filters":"Filter Results"," "),a.Pb(1),a.Bc("disabled",!t.selectedVoiceMail),a.Pb(8),a.Bc("ngIf",t.showFilterSection),a.Pb(1),a.Bc("dataSource",t.voicemailMessages),a.Pb(26),a.Bc("matHeaderRowDef",t.tableColumns),a.Pb(1),a.Bc("matRowDefColumns",t.tableColumns),a.Pb(1),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.voicemailMessages.length&&!t.loading),a.Pb(1),a.Bc("ngIf",t.voicemailMessages.length),a.Pb(1),a.Bc("ngClass",a.Gc(17,Lb,t.selection.selected.length)),a.Pb(8),a.fd(" (","selected"===t.selectedType?t.selection.selected.length:a.wc(60,15,t.paginator.totalCount),") Messages Selected "),a.Pb(5),a.fd(" Delete ",t.selection.selected.length>1?"Messages":"Message"," "))},directives:[J.p,le.b,ge.a,ue.a,Uo.n,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,J.n,te.y,te.p,te.s,J.o,te.t,te.A,te.B,te.q,te.i,te.u,te.d,te.h,Uo.h,Xl.a,Uo.a,cn.e,cn.f,cn.c,Uo.j,Uo.l,fe.a,pl.a],pipes:[J.g,J.x,J.f,Vs.a],encapsulation:2}),e})();var Gb=n("lJYf"),Yb=n("MvQF"),Jb=n("Dh3D");const Zb=["calendarEventsTable"];function Kb(e,t){1&e&&(a.ic(0,"mat-icon",28),a.dd(1,"search"),a.hc())}function ep(e,t){1&e&&(a.ic(0,"mat-icon",28),a.dd(1,"close"),a.hc())}function tp(e,t){if(1&e&&(a.ic(0,"option",35),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Bc("ngValue",e.id),a.Pb(1),a.ed(e.name)}}function np(e,t){if(1&e){const e=a.kc();a.ic(0,"div",29),a.ic(1,"form",30),a.qc("keydown.enter",(function(t){a.Qc(e);const n=a.uc();return t.preventDefault(),n.onFilterCalendarEvents()})),a.ic(2,"div",31),a.ic(3,"div"),a.ic(4,"label"),a.dd(5,"First Name"),a.hc(),a.dc(6,"br"),a.dc(7,"input",32),a.hc(),a.ic(8,"div"),a.ic(9,"label"),a.dd(10,"Last Name"),a.hc(),a.dc(11,"br"),a.dc(12,"input",33),a.hc(),a.ic(13,"div"),a.ic(14,"label"),a.dd(15,"Type"),a.hc(),a.dc(16,"br"),a.ic(17,"select",34),a.dc(18,"option",35),a.bd(19,tp,2,2,"option",36),a.hc(),a.hc(),a.ic(20,"div",37),a.ic(21,"label"),a.dd(22,"Created On Range"),a.hc(),a.dc(23,"br"),a.dc(24,"input",38),a.dc(25,"owl-date-time",39,40),a.hc(),a.ic(27,"div",37),a.ic(28,"label"),a.dd(29,"Event Start Range"),a.hc(),a.dc(30,"br"),a.dc(31,"input",41),a.dc(32,"owl-date-time",39,42),a.hc(),a.ic(34,"div"),a.ic(35,"label"),a.dd(36,"Notified"),a.hc(),a.dc(37,"br"),a.ic(38,"select",43),a.dc(39,"option",35),a.ic(40,"option",35),a.dd(41,"True"),a.hc(),a.ic(42,"option",35),a.dd(43,"False"),a.hc(),a.hc(),a.hc(),a.hc(),a.ic(44,"div",44),a.ic(45,"input",45),a.qc("change",(function(){return a.Qc(e),a.uc().onFilterCheckboxChanged()})),a.hc(),a.ic(46,"label",46),a.dd(47,"Filter for Current & Future Calendar Events"),a.hc(),a.ic(48,"input",47),a.qc("change",(function(){return a.Qc(e),a.uc().onFilterCheckboxChanged()})),a.hc(),a.ic(49,"label",48),a.dd(50,"View Today's Events"),a.hc(),a.ic(51,"button",49),a.qc("click",(function(){return a.Qc(e),a.uc().onClearFilters()})),a.dd(52," Clear Filters "),a.hc(),a.ic(53,"button",50),a.qc("click",(function(){return a.Qc(e),a.uc().onFilterCalendarEvents()})),a.dd(54,"Filter"),a.hc(),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.Mc(26),t=a.Mc(33),n=a.uc();a.Pb(1),a.Bc("formGroup",n.filterForm),a.Pb(17),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngForOf",n.agentCalendarEventTypeService.calendarEventTypes),a.Pb(1),a.Bc("matTooltipDisabled",!n.filterForm.get("created_on").disabled)("matTooltip",'Date range fields are disabled if "Filter for Current & Future Calendar Events" or "View Today\'s Events" are selected'),a.Pb(4),a.Bc("selectMode","range")("owlDateTime",e)("owlDateTimeTrigger",e),a.Pb(1),a.Bc("disabled",!0===n.filterForm.get("event_start__date_local_today").value),a.Pb(2),a.Bc("matTooltipDisabled",!n.filterForm.get("event_start").disabled)("matTooltip",'Date range fields are disabled if "Filter for Current & Future Calendar Events" or "View Today\'s Events" are selected'),a.Pb(4),a.Bc("selectMode","range")("owlDateTime",t)("owlDateTimeTrigger",t),a.Pb(1),a.Bc("disabled",!0===n.filterForm.get("event_start__date_local_today").value),a.Pb(7),a.Bc("ngValue",null),a.Pb(1),a.Bc("ngValue",!0),a.Pb(2),a.Bc("ngValue",!1)}}function ip(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," Type "),a.hc())}function cp(e,t){if(1&e&&(a.ic(0,"td",52),a.dd(1),a.hc()),2&e){const e=t.$implicit,n=a.uc();a.Pb(1),a.fd(" ",n.agentCalendarEventTypeService.calendarEventTypeMap[e.type]," ")}}function ap(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," Contact "),a.hc())}function op(e,t){if(1&e){const e=a.kc();a.ic(0,"td",52),a.ic(1,"span",53),a.dd(2),a.hc(),a.ic(3,"mat-menu",null,54),a.ic(5,"button",55),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().openContact(n.contact)})),a.dd(6,"Open Contact"),a.hc(),a.ic(7,"button",55),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc().viewContactOnDashboard(n.contact)})),a.dd(8,"View on Dashboard"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.Mc(4);a.Pb(1),a.Bc("mat-menu-trigger-for",n),a.Pb(1),a.fd(" ",e.contact," ")}}function sp(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," First Name "),a.hc())}function rp(e,t){if(1&e&&(a.ic(0,"td",52),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.first_name," ")}}function dp(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," Last Name "),a.hc())}function lp(e,t){if(1&e&&(a.ic(0,"td",52),a.dd(1),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",e.last_name," ")}}function up(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," Description "),a.hc())}function gp(e,t){if(1&e&&(a.ic(0,"span",58),a.dd(1),a.vc(2,"slice"),a.hc()),2&e){const e=a.uc(2).$implicit;a.Bc("matTooltip",e.description),a.Pb(1),a.fd(" ",a.yc(2,2,e.description,0,22)+".."," ")}}function hp(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.hc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.ed(e.description)}}function bp(e,t){if(1&e&&(a.gc(0),a.bd(1,gp,3,6,"span",57),a.bd(2,hp,2,1,"span",56),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf",e.description.length>=22),a.Pb(1),a.Bc("ngIf",e.description.length<22)}}function pp(e,t){if(1&e&&(a.ic(0,"td",52),a.bd(1,bp,3,2,"ng-container",56),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.Bc("ngIf",e.description)}}function vp(e,t){1&e&&(a.ic(0,"th",59),a.dd(1," Event Start "),a.hc())}function mp(e,t){if(1&e&&(a.ic(0,"td",52),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.event_start,"MMM d, y, h:mm a")," ")}}function fp(e,t){1&e&&(a.ic(0,"th",59),a.dd(1,"Created On"),a.hc())}function Sp(e,t){if(1&e&&(a.ic(0,"td",52),a.dd(1),a.vc(2,"date"),a.hc()),2&e){const e=t.$implicit;a.Pb(1),a.fd(" ",a.xc(2,1,e.created_on,"MMM d, y, h:mm a")," ")}}function _p(e,t){1&e&&(a.ic(0,"th",51),a.dd(1," Controls "),a.hc())}function yp(e,t){if(1&e){const e=a.kc();a.ic(0,"td",52),a.ic(1,"button",60),a.qc("click",(function(){a.Qc(e);const n=t.$implicit,i=t.index;return a.uc().showEditCalendarEventDialog(n,i)})),a.dd(2,"Edit"),a.hc(),a.ic(3,"button",61),a.qc("click",(function(){a.Qc(e);const n=t.$implicit,i=t.index;return a.uc().showDeleteCalendarEventConfirmation(n,i)})),a.dd(4,"Delete"),a.hc(),a.hc()}}function Cp(e,t){1&e&&a.dc(0,"tr",62)}function Pp(e,t){1&e&&a.dc(0,"tr",63)}function wp(e,t){1&e&&(a.ic(0,"div",64),a.dc(1,"mat-progress-spinner",65),a.dd(2," Loading... "),a.hc())}function Mp(e,t){1&e&&(a.ic(0,"div",66),a.dc(1,"img",67),a.ic(2,"h3",68),a.dd(3,"No Calendar Events to show"),a.hc(),a.hc())}function xp(e,t){if(1&e){const e=a.kc();a.ic(0,"paginator",69),a.qc("updatePerPage",(function(t){return a.Qc(e),a.uc().updateResultsPerPage(t)}))("goPage",(function(t){return a.Qc(e),a.uc().goToPage(t)})),a.hc()}if(2&e){const e=a.uc();a.Bc("showPaginationLoader",e.paginator.showPaginationLoader)("totalCount",e.paginator.totalCount)("perPage",e.paginator.resultsPerPage)("currentPage",e.paginator.currentPage)("prevButton",e.paginator.prevButton)("nextButton",e.paginator.nextButton)}}const Bp=function(){return["type","contact","first_name","last_name","description","event_start","created_on","controls"]};let kp=(()=>{class e{constructor(e,t,n,i,c,a,o,s,r){this._fb=e,this._agentContactService=t,this._dialog=n,this._utils=i,this._snackBar=c,this._agentNavService=a,this._myCalendarEventService=o,this._permissionService=s,this.agentCalendarEventTypeService=r,this.calendarEvents=[],this.alreadyGotData=!1,this.timerCount=0,this.showFilterSection=!0,this.sortBy=null,this.calendarEventTone=new Audio,this.paginator={showPaginationLoader:!1,totalCount:null,prevButton:"",nextButton:"",currentPage:1,resultsPerPage:25},this.filterForm=this._fb.group({first_name:"",last_name:"",type_id:null,created_on:"",event_start:"",event_start__date_local_today:!1,event_start__date_local_future:!0,notified:null})}ngOnInit(){$.listen(e=>{"calendar_event"===e.method&&(this.calendarEventTone.src="/assets/audio/calendar-events/calendar-event-tone.mp3",this.calendarEventTone.play().catch(()=>{}),this._agentNavService.showAgentCalendarEventAlert=!0)}),this.agentDashboardNavSubscription=this._agentNavService.activeTopSectionSubject.subscribe({next:e=>{"calendar-events"===e&&(this._agentNavService.showAgentCalendarEventAlert=!1,this.alreadyGotData||(this.loading=!0,this._getCalendarEvents(),this.alreadyGotData=!0,this.agentCalendarEventTypeService.calendarEventTypes.length||this.agentCalendarEventTypeService.getCalendarEventTypes()))}}),(this.filterForm.get("event_start__date_local_today").value||this.filterForm.get("event_start__date_local_future").value)&&(this.filterForm.get("created_on").setValue(""),this.filterForm.get("created_on").disable(),this.filterForm.get("event_start").setValue(""),this.filterForm.get("event_start").disable())}ngOnDestroy(){this.agentDashboardNavSubscription.unsubscribe()}onClearFilters(){this.filterForm.setValue({first_name:"",last_name:"",type_id:null,created_on:"",event_start:"",event_start__date_local_today:!1,event_start__date_local_future:!1,notified:null}),this._getCalendarEvents()}onFilterCalendarEvents(){this.paginator.currentPage=1,this._getCalendarEvents()}onSortData(e){this.paginator.currentPage=1,this.sortBy=""===e.direction?null:{field:e.active,order:e.direction},this._getCalendarEvents()}_getCalendarEvents(){this._myCalendarEventService.filter(this.paginator.resultsPerPage,this.paginator.currentPage,this.filterForm.value,this.sortBy).subscribe({next:e=>{this.calendarEvents=e.results,this.paginator.totalCount=e.count,this.paginator.nextButton=e.next,this.paginator.prevButton=e.previous,this.loading=!1},error:e=>{this._snackBar.open(this._utils.handleErrorResponse(e,"Error Getting Calendar Events"),"X",{duration:3e4,verticalPosition:"top",panelClass:["error"]})}})}onFilterCheckboxChanged(){this.filterForm.get("event_start__date_local_today").value||this.filterForm.get("event_start__date_local_future").value?(this.filterForm.get("created_on").setValue(""),this.filterForm.get("created_on").disable(),this.filterForm.get("event_start").setValue(""),this.filterForm.get("event_start").disable()):(this.filterForm.get("created_on").enable(),this.filterForm.get("event_start").enable())}goToPage(e){this.paginator.currentPage=e,this._getCalendarEvents()}updateResultsPerPage(e){this.paginator.currentPage=1,this.paginator.resultsPerPage=e,this._getCalendarEvents()}openContact(e){this._userHasContactReadPermission()&&this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"Details",contactIds:[e],contactsTotal:null},autoFocus:!1}).afterClosed().subscribe({next:t=>{if(t&&"viewOnDashboard"===t){if(!this._userHasContactReadPermission())return;this._agentContactService.getContact(e),this._agentNavService.activeTopSectionSubject.next("dashboard"),this._agentNavService.activeDashboardSectionSubject.next("contact")}}})}refreshCalendarEventTable(){this.timerInterval||(this.loading=!0,this._getCalendarEvents(),this._startInterval())}viewContactOnDashboard(e){if(!this._userHasContactReadPermission())return;const t=this._agentContactService.contactSubject.value;(!t||t&&t.id!==e)&&this._agentContactService.getContact(e),this._agentNavService.activeTopSectionSubject.next("dashboard"),this._agentNavService.activeDashboardSectionSubject.next("contact")}showEditCalendarEventDialog(e,t){this._dialog.open(Gb.a,{width:"800px",data:{calendarEvent:e}}).afterClosed().subscribe({next:e=>{e&&(this.calendarEvents[t]=e,this.calendarEventsTable.renderRows())}})}showDeleteCalendarEventConfirmation(e,t){this._dialog.open(en.a,{width:"400px",data:{title:"Delete Event?",buttonText:"Delete"}}).afterClosed().subscribe({next:n=>{n&&this._deleteCalendarEvent(e,t)}})}_userHasContactReadPermission(){return!!this._permissionService.hasPermission("contacts_read")||(this._snackBar.open("You do not have permission to view contacts","X",{duration:5e3,verticalPosition:"top",panelClass:["error"]}),!1)}_deleteCalendarEvent(e,t){this._myCalendarEventService.delete(e.id).subscribe({next:()=>{this.calendarEvents.splice(t,1),this.calendarEventsTable.renderRows(),this._snackBar.open("Event Deleted","X",{duration:2500,verticalPosition:"top",panelClass:["success"]})}})}_startInterval(){this.timerInterval=setInterval(()=>{this.timerCount++,this.timerCount>=15&&(clearInterval(this.timerInterval),this.timerInterval=null,this.timerCount=0)},1e3)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(te.f),a.bc(f.a),a.bc(Y.b),a.bc(D.a),a.bc(k.a),a.bc(d.a),a.bc(Yb.a),a.bc(A.a),a.bc(ds))},e.\u0275cmp=a.Vb({type:e,selectors:[["agent-calendar-events"]],viewQuery:function(e,t){var n;1&e&&a.jd(Zb,!0),2&e&&a.Lc(n=a.rc())&&(t.calendarEventsTable=n.first)},decls:48,vars:12,consts:[[1,"dyn-card","dyn-m-0"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[1,"dyn-m-b-0"],[1,"dyn-text-muted","dyn-m-t-0","dyn-m-b-20"],["mat-stroked-button","",1,"dyn-m-r-10",3,"click"],["class","dyn-vertical-middle",4,"ngIf"],["mat-mini-fab","","color","","matTooltip","Refresh Table",1,"dyn-no-shadow",3,"click"],["color","primary"],["class","dyn-bg-grey filter-section dyn-p-20",4,"ngIf"],[1,"dyn-m-0"],["mat-table","","matSort","",1,"dyn-full-width",3,"dataSource","matSortChange"],["calendarEventsTable",""],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","contact"],["matColumnDef","first_name"],["matColumnDef","last_name"],["matColumnDef","description"],["matColumnDef","event_start"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","created_on"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","dyn-p-20",4,"ngIf"],["class","dyn-text-center dyn-m-t-50 dyn-m-b-50",4,"ngIf"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage",4,"ngIf"],[1,"dyn-vertical-middle"],[1,"dyn-bg-grey","filter-section","dyn-p-20"],[3,"formGroup","keydown.enter"],[2,"display","grid","grid-gap","5px 12px","grid-template-columns","repeat(auto-fit, minmax(160px, 1fr))"],["type","text","formControlName","first_name",1,"dyn-full-width"],["type","text","formControlName","last_name",1,"dyn-full-width"],["formControlName","type_id",1,"dyn-full-width"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"matTooltipDisabled","matTooltip"],["type","text","formControlName","created_on",1,"dyn-full-width",3,"selectMode","owlDateTime","owlDateTimeTrigger"],["hour12Timer","true",3,"disabled"],["dt2",""],["type","text","formControlName","event_start",1,"dyn-full-width",3,"selectMode","owlDateTime","owlDateTimeTrigger"],["dt1",""],["formControlName","notified",1,"dyn-full-width"],[1,"dyn-text-center","dyn-m-t-20"],["type","checkbox","id","event_start__date_local_future","formControlName","event_start__date_local_future",3,"change"],["for","event_start__date_local_future"],["type","checkbox","id","event_start__date_local_today","formControlName","event_start__date_local_today",1,"dyn-m-l-20",3,"change"],["for","event_start__date_local_today"],["mat-raised-button","","color","",1,"dyn-m-l-20",3,"click"],["mat-raised-button","","color","primary",1,"dyn-m-l-10",3,"click"],["mat-header-cell",""],["mat-cell",""],[1,"dyn-link","dyn-underline",3,"mat-menu-trigger-for"],["contactMenu","matMenu"],["mat-menu-item","",3,"click"],[4,"ngIf"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],["mat-header-cell","","mat-sort-header",""],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"dyn-p-20"],["diameter","20","mode","indeterminate",1,"dyn-inline-block","dyn-vertical-middle"],[1,"dyn-text-center","dyn-m-t-50","dyn-m-b-50"],["src","/assets/img/warning-icon.svg",2,"height","60px"],[1,"dyn-m-t-10","dyn-m-b-10"],[3,"showPaginationLoader","totalCount","perPage","currentPage","prevButton","nextButton","updatePerPage","goPage"]],template:function(e,t){1&e&&(a.ic(0,"div",0),a.ic(1,"div",1),a.ic(2,"div"),a.ic(3,"h1",2),a.dd(4,"Calendar Events"),a.hc(),a.ic(5,"p",3),a.dd(6," Calendar Events are event reminders that create alerts for important tasks. "),a.hc(),a.hc(),a.ic(7,"div"),a.ic(8,"button",4),a.qc("click",(function(){return t.showFilterSection=!t.showFilterSection})),a.bd(9,Kb,2,0,"mat-icon",5),a.bd(10,ep,2,0,"mat-icon",5),a.dd(11),a.hc(),a.ic(12,"button",6),a.qc("click",(function(){return t.refreshCalendarEventTable()})),a.ic(13,"mat-icon",7),a.dd(14,"refresh"),a.hc(),a.hc(),a.hc(),a.hc(),a.bd(15,np,55,18,"div",8),a.dc(16,"hr",9),a.ic(17,"table",10,11),a.qc("matSortChange",(function(e){return t.onSortData(e)})),a.gc(19,12),a.bd(20,ip,2,0,"th",13),a.bd(21,cp,2,1,"td",14),a.fc(),a.gc(22,15),a.bd(23,ap,2,0,"th",13),a.bd(24,op,9,2,"td",14),a.fc(),a.gc(25,16),a.bd(26,sp,2,0,"th",13),a.bd(27,rp,2,1,"td",14),a.fc(),a.gc(28,17),a.bd(29,dp,2,0,"th",13),a.bd(30,lp,2,1,"td",14),a.fc(),a.gc(31,18),a.bd(32,up,2,0,"th",13),a.bd(33,pp,2,1,"td",14),a.fc(),a.gc(34,19),a.bd(35,vp,2,0,"th",20),a.bd(36,mp,3,4,"td",14),a.fc(),a.gc(37,21),a.bd(38,fp,2,0,"th",20),a.bd(39,Sp,3,4,"td",14),a.fc(),a.gc(40,22),a.bd(41,_p,2,0,"th",13),a.bd(42,yp,5,0,"td",14),a.fc(),a.bd(43,Cp,1,0,"tr",23),a.bd(44,Pp,1,0,"tr",24),a.hc(),a.bd(45,wp,3,0,"div",25),a.bd(46,Mp,4,0,"div",26),a.bd(47,xp,1,6,"paginator",27),a.hc()),2&e&&(a.Pb(9),a.Bc("ngIf",!t.showFilterSection),a.Pb(1),a.Bc("ngIf",t.showFilterSection),a.Pb(1),a.fd(" ",t.showFilterSection?"Hide Filters":"Filter Results"," "),a.Pb(4),a.Bc("ngIf",t.showFilterSection),a.Pb(2),a.Bc("dataSource",t.calendarEvents),a.Pb(26),a.Bc("matHeaderRowDef",a.Fc(10,Bp)),a.Pb(1),a.Bc("matRowDefColumns",a.Fc(11,Bp)),a.Pb(1),a.Bc("ngIf",t.loading),a.Pb(1),a.Bc("ngIf",!t.calendarEvents.length&&!t.loading),a.Pb(1),a.Bc("ngIf",t.calendarEvents.length&&!t.loading))},directives:[le.b,J.p,ue.a,ge.a,Uo.n,Jb.a,Uo.c,Uo.i,Uo.b,Uo.k,Uo.m,te.B,te.q,te.i,te.d,te.p,te.h,te.y,te.t,te.A,J.o,on.b,on.d,on.a,te.a,Uo.h,Uo.a,cn.e,cn.f,cn.c,Jb.b,Uo.j,Uo.l,fe.a,pl.a],pipes:[J.x,J.f],encapsulation:2}),e})();var Fp=n("dday");function Ip(e,t){if(1&e){const e=a.kc();a.ic(0,"div",9),a.ic(1,"div",10),a.ic(2,"p",11),a.ic(3,"mat-icon",12),a.dd(4,"warning"),a.hc(),a.ic(5,"mat-icon",12),a.dd(6,"phone_disabled"),a.hc(),a.dd(7," You dont have a phone setup for your user account "),a.hc(),a.hc(),a.ic(8,"button",13),a.qc("click",(function(){return a.Qc(e),a.uc().showNoPhoneWarning=!1})),a.ic(9,"mat-icon"),a.dd(10,"close"),a.hc(),a.hc(),a.hc()}2&e&&a.Bc("@slideInOut",void 0)}function Dp(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"button",16),a.qc("click",(function(){return a.Qc(e),a.uc(2).onCloseBanner()})),a.ic(2,"mat-icon"),a.dd(3,"close"),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc(2);a.Pb(2),a.Yc("color",e.banner.text_color)}}function Tp(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",14),a.ic(2,"div",15),a.dd(3),a.hc(),a.bd(4,Dp,4,2,"ng-container",1),a.hc(),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Yc("background-color",e.banner.bg_color)("color",e.banner.text_color),a.Bc("@slideInOut",void 0),a.Pb(1),a.Tb("dyn-text-center",e.banner.text_align_center),a.Pb(1),a.fd(" ",e.banner.text," "),a.Pb(1),a.Bc("ngIf",!1!==(null==e.banner?null:e.banner.closeable))}}function jp(e,t){if(1&e){const e=a.kc();a.ic(0,"button",21),a.qc("click",(function(){a.Qc(e);const t=a.uc(2);return t.agentQueueService.deleteQueueAgent(null==t.agentQueueService.queueAgentPausedNotification?null:t.agentQueueService.queueAgentPausedNotification.queue),t.agentQueueService.removePausedNotification()})),a.dd(1,"Exit Queue"),a.hc()}}function Op(e,t){if(1&e){const e=a.kc();a.gc(0),a.ic(1,"div",17),a.ic(2,"span"),a.dd(3),a.hc(),a.ic(4,"div"),a.bd(5,jp,2,0,"button",18),a.ic(6,"button",19),a.qc("click",(function(){a.Qc(e);const t=a.uc();return t.agentQueueService.unPauseQueueAgent(null==t.agentQueueService.queueAgentPausedNotification?null:t.agentQueueService.queueAgentPausedNotification.queue)})),a.dd(7),a.hc(),a.ic(8,"button",20),a.qc("click",(function(){return a.Qc(e),a.uc().agentQueueService.removePausedNotification()})),a.ic(9,"mat-icon"),a.dd(10,"close"),a.hc(),a.hc(),a.hc(),a.hc(),a.fc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("@slideInOut",void 0),a.Pb(2),a.fd(' You are paused in queue "',e.agentQueueService.queueMap[null==e.agentQueueService.queueAgentPausedNotification?null:e.agentQueueService.queueAgentPausedNotification.queue]?e.agentQueueService.queueMap[null==e.agentQueueService.queueAgentPausedNotification?null:e.agentQueueService.queueAgentPausedNotification.queue].name:"",'" '),a.Pb(2),a.Bc("ngIf",!e.agentQueueService.isAgentStaticMember(null==e.agentQueueService.queueAgentPausedNotification?null:e.agentQueueService.queueAgentPausedNotification.queue)),a.Pb(1),a.Bc("disabled",e.agentQueueService.queueAgentBeingResumed===(null==e.agentQueueService.queueAgentPausedNotification?null:e.agentQueueService.queueAgentPausedNotification.queue)),a.Pb(1),a.fd(" ",e.agentQueueService.queueAgentBeingResumed===(null==e.agentQueueService.queueAgentPausedNotification?null:e.agentQueueService.queueAgentPausedNotification.queue)?"Resuming...":"Resume"," ")}}function Np(e,t){1&e&&(a.ic(0,"span",30),a.dd(1," Out of Leads "),a.hc())}function qp(e,t){1&e&&(a.gc(0),a.dd(1," Campaign Ready "),a.fc())}function $p(e,t){1&e&&(a.gc(0),a.dd(1," Not Campaign Ready "),a.fc())}const Ep=function(e){return{light:e}};function Ap(e,t){if(1&e&&(a.ic(0,"div"),a.ic(1,"div",22),a.ic(2,"div",23),a.ic(3,"div"),a.ic(4,"p",24),a.dd(5),a.hc(),a.hc(),a.ic(6,"div"),a.bd(7,Np,2,0,"span",25),a.ic(8,"div",26),a.ic(9,"div",27),a.bd(10,qp,2,0,"ng-container",1),a.bd(11,$p,2,0,"ng-container",1),a.hc(),a.dc(12,"img",28),a.dc(13,"img",29),a.hc(),a.hc(),a.hc(),a.hc(),a.hc()),2&e){const e=a.uc(2);a.Pb(1),a.Yc("background",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].color),a.Bc("ngClass",a.Gc(16,Ep,"#ffffff"===e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].color||"#fff"===e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].color)),a.Pb(4),a.fd(" Campaign: ",e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign]?e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].name:""," "),a.Pb(2),a.Bc("ngIf",e.agentCampaignService.outOfLeadCampaigns.includes(e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign].id)),a.Pb(2),a.Bc("matTooltipDisabled",e.agentStatusService.agentStatusSubject.value&&(null==e.agentStatusService.agentStatusSubject.value?null:e.agentStatusService.agentStatusSubject.value.ready)),a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value&&(null==e.agentStatusService.agentStatusSubject.value?null:e.agentStatusService.agentStatusSubject.value.ready)),a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value&&!(null!=e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.ready)),a.Pb(1),a.Yc("height",e.agentStatusService.agentStatusSubject.value&&!e.agentStatusService.agentStatusSubject.value.ready?"18px":"0")("visibility",e.agentStatusService.agentStatusSubject.value&&!e.agentStatusService.agentStatusSubject.value.ready?"visible":"hidden"),a.Pb(1),a.Yc("height",e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.ready?"18px":"0")("visibility",e.agentStatusService.agentStatusSubject.value&&e.agentStatusService.agentStatusSubject.value.ready?"visible":"hidden")}}function Qp(e,t){if(1&e&&(a.gc(0),a.bd(1,Ap,14,18,"div",1),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.agentStatusService.agentStatusSubject.value.campaign&&e.agentCampaignService.campaignMap[e.agentStatusService.agentStatusSubject.value.campaign])}}function Rp(e,t){if(1&e&&(a.ic(0,"span"),a.dd(1),a.hc()),2&e){const e=a.uc(4);a.Pb(1),a.fd(" (",e.webPhoneSessionsService.activeSession.data.inboundRouteName,") ")}}function Up(e,t){if(1&e&&(a.gc(0),a.dd(1),a.bd(2,Rp,2,1,"span",1),a.fc()),2&e){const e=a.uc(3);a.Pb(1),a.fd(" ",e.webPhoneSessionsService.activeSession.data.inboundRouteDID," "),a.Pb(1),a.Bc("ngIf",e.webPhoneSessionsService.activeSession.data.inboundRouteName)}}function Vp(e,t){if(1&e&&(a.ic(0,"div",32),a.ic(1,"p",24),a.dd(2),a.ic(3,"span",33),a.dd(4," Dialed Number: "),a.bd(5,Up,3,2,"ng-container",1),a.hc(),a.hc(),a.hc()),2&e){const e=a.uc(2);a.Yc("background",null==e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId]?null:e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId].color),a.Pb(1),a.Yc("color","#ffffff"===(null==e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId]?null:e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId].color)?"#000":"#fff"),a.Pb(1),a.fd(" Queue Call From (",null==e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId]?null:e.agentQueueService.queueMap[e.webPhoneSessionsService.activeSession.data.queueId].name,") "),a.Pb(3),a.Bc("ngIf",e.webPhoneSessionsService.activeSession&&e.webPhoneSessionsService.activeSession.data.inboundRouteDID)}}function Wp(e,t){if(1&e&&(a.gc(0),a.bd(1,Vp,6,6,"div",31),a.fc()),2&e){const e=a.uc();a.Pb(1),a.Bc("ngIf",e.webPhoneSessionsService.activeSession.data.queueId)}}function zp(e,t){if(1&e&&(a.gc(0),a.ic(1,"div",34),a.ic(2,"div",35),a.ic(3,"h3"),a.dd(4,"Daily Stats"),a.hc(),a.hc(),a.ic(5,"div",36),a.ic(6,"div",37),a.ic(7,"div",38),a.dd(8),a.hc(),a.ic(9,"div",39),a.dd(10,"Completed Calls"),a.hc(),a.hc(),a.ic(11,"div",37),a.ic(12,"div",38),a.dd(13),a.hc(),a.ic(14,"div",39),a.dd(15,"Current Status"),a.hc(),a.hc(),a.ic(16,"div",37),a.ic(17,"div",38),a.dd(18),a.hc(),a.ic(19,"div",39),a.dd(20,"Active Time"),a.hc(),a.hc(),a.ic(21,"div",37),a.ic(22,"div",38),a.dd(23),a.hc(),a.ic(24,"div",39),a.dd(25,"Current Campaign"),a.hc(),a.hc(),a.ic(26,"div",37),a.ic(27,"div",38),a.dd(28),a.hc(),a.ic(29,"div",39),a.dd(30,"Goals"),a.hc(),a.hc(),a.ic(31,"div",37),a.ic(32,"div",38),a.dd(33),a.hc(),a.ic(34,"div",39),a.dd(35,"Last Call Disposition"),a.hc(),a.hc(),a.hc(),a.hc(),a.fc()),2&e){const e=a.uc();a.Pb(8),a.fd(" ",null!=e.agentDailyStatService.dailyStats&&e.agentDailyStatService.dailyStats.calls?null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.calls:0," "),a.Pb(5),a.fd(" ",null!=e.agentDailyStatService.dailyStats&&e.agentDailyStatService.dailyStats.agent_status?null==e.agentStatusService.statusMap[null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.agent_status]?null:e.agentStatusService.statusMap[null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.agent_status].name:"N/A"," "),a.Pb(5),a.fd(" ",null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.active_time," "),a.Pb(5),a.fd(" ",null!=e.agentDailyStatService.dailyStats&&e.agentDailyStatService.dailyStats.campaign?null==e.agentCampaignService.campaignMap[null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.campaign]?null:e.agentCampaignService.campaignMap[null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.campaign].name:"N/A"," "),a.Pb(5),a.fd(" ",null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.goals," "),a.Pb(5),a.fd(" ",null!=e.agentDailyStatService.dailyStats&&e.agentDailyStatService.dailyStats.last_call_disposition_id?e.agentCallDispositionService.callDispositionMap[null==e.agentDailyStatService.dailyStats?null:e.agentDailyStatService.dailyStats.last_call_disposition_id]:"N/A"," ")}}function Hp(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.gd(" ",e.first_name," ",e.last_name," ")}}function Lp(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(" ",e._phone_numbers[0].phone_number," ")}}function Xp(e,t){if(1&e&&(a.gc(0),a.dd(1),a.fc()),2&e){const e=a.uc(2).$implicit;a.Pb(1),a.fd(" Contact: ",e.id," ")}}function Gp(e,t){if(1&e&&(a.gc(0),a.bd(1,Lp,2,1,"ng-container",1),a.bd(2,Xp,2,1,"ng-container",1),a.fc()),2&e){const e=a.uc().$implicit;a.Pb(1),a.Bc("ngIf",e._phone_numbers&&e._phone_numbers.length),a.Pb(1),a.Bc("ngIf",!(null!=e._phone_numbers&&e._phone_numbers.length))}}function Yp(e,t){1&e&&(a.ic(0,"mat-icon",48),a.dd(1,"settings_phone"),a.hc())}const Jp=function(e){return{"active-contact":e}},Zp=function(e){return{"dyn-link":e}};function Kp(e,t){if(1&e){const e=a.kc();a.ic(0,"div",44),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).agentStoredContactService.loadContact(n.id,n)})),a.ic(1,"div",23),a.ic(2,"div",45),a.bd(3,Hp,2,2,"ng-container",1),a.bd(4,Gp,3,2,"ng-container",1),a.hc(),a.bd(5,Yp,2,0,"mat-icon",46),a.ic(6,"mat-icon",47),a.qc("click",(function(){a.Qc(e);const n=t.$implicit;return a.uc(2).agentStoredContactService.removeContact(n.id)})),a.dd(7,"close"),a.hc(),a.hc(),a.hc()}if(2&e){const e=t.$implicit,n=a.uc(2);a.Tb("has-stored-note",n.agentNoteService.contactHasStoredNote(e.id)),a.Bc("ngClass",a.Gc(7,Jp,e.id===(null==n.agentContactService.contactSubject.value?null:n.agentContactService.contactSubject.value.id))),a.Pb(2),a.Bc("ngClass",a.Gc(9,Zp,e.id===n.agentContactService.contactSubject.value?n.agentContactService.contactSubject.value.id:null)),a.Pb(1),a.Bc("ngIf",e.first_name||e.last_name),a.Pb(1),a.Bc("ngIf",!e.first_name&&!e.last_name),a.Pb(1),a.Bc("ngIf",n.agentPostCallService.isContactInPostCall(e.id))}}function ev(e,t){if(1&e){const e=a.kc();a.ic(0,"div",40),a.bd(1,Kp,8,11,"div",41),a.ic(2,"div",42),a.qc("click",(function(){return a.Qc(e),a.uc().agentStoredContactService.storeContact()})),a.ic(3,"mat-icon",43),a.dd(4,"add"),a.hc(),a.hc(),a.hc()}if(2&e){const e=a.uc();a.Pb(1),a.Bc("ngForOf",e.agentStoredContactService.storedContacts)}}function tv(e,t){1&e&&a.dc(0,"app-connectors")}function nv(e,t){if(1&e&&a.dc(0,"app-agent-leaderboard",7),2&e){const e=a.uc();a.Bc("hidden","agent-leaderboard"!==e.agentNavService.activeTopSectionSubject.value)}}const iv=function(e){return{show:e}};let cv=(()=>{class e{constructor(e,t,n,i,c,o,s,r,d,l,u,g,h,b,p,v,m,f,S,_,y,C,P,w,M,x,B,k,F,I,D,T){this._renderer=e,this._agentDarkModeService=t,this._snackBar=n,this._utils=i,this._dialog=c,this._webPhoneService=o,this._myWebPhoneService=s,this._authService=r,this._permissionService=d,this._agentContactFieldService=l,this._agentContactDispositionService=u,this._myAgentStatusService=g,this._webPhoneOverlayService=h,this._myFullAgentStatusService=b,this._returnUrlService=p,this._route=v,this._router=m,this.agentNoteService=f,this.agentAccountSettingService=S,this.userPreferenceService=_,this.webPhoneSessionsService=y,this.agentQueueService=C,this.agentConnectorService=P,this.agentStatusService=w,this.agentNavService=M,this.agentCampaignService=x,this.agentUserService=B,this.agentCallDispositionService=k,this.agentPostCallService=F,this.agentContactService=I,this.agentStoredContactService=D,this.agentDailyStatService=T,this.open=new a.r,this.incomingSmsAudio=new Audio,this.showBackgroundFlash=!1,this.showNoPhoneWarning=!1,this.agentStatusIntervalMinutes=1,this.idleTimeoutMinutes=10,this.userIsIdle=!1,this.accountSettings=null,this.frontEndAgentStatusSyncMinutes=2,this.banners=[],this.banner=null,this.chromeMessageHandler=e=>{var t;if(e.source===window&&"PhoneCallEvent"===(null===(t=e.data)||void 0===t?void 0:t.type)){const t=e.data.data;t&&this.webPhoneSessionsService.call(t)}}}refreshUserState(){this.userIsIdle=!1,clearTimeout(this.userActivityTimeout),this._setIdleTimeout()}onBeforeUnload(){this.agentConnectorService.externalPopUpWindow&&this.agentConnectorService.externalPopUpWindow.close()}ngOnInit(){var e;if(this._agentDarkModeService.darkModeEnabled&&this._renderer.addClass(document.body,"dark-theme"),this.accountSettingSubscription=this.agentAccountSettingService.accountSettingsSubject.pipe(Object(H.a)()).subscribe({next:e=>{this.accountSettings||e&&(this.accountSettings=e,this._handleBannerDisplay(),this.accountSettings.agent_dash_stats?(this._getMyFullAgentStatus(),this.agentStatusInterval=setInterval(()=>{this._getMyFullAgentStatus()},6e4*this.agentStatusIntervalMinutes),this._createAgentStatusSubscription()):this.agentStatusCheckInterval=setInterval(()=>{this._checkAgentStatusSync()},6e4*this.frontEndAgentStatusSyncMinutes))}}),this._returnUrlService.agentDashboardContactId||(null===(e=this._route.snapshot.params)||void 0===e?void 0:e.contactId)){let e;this._returnUrlService.agentDashboardContactId?(e=this._returnUrlService.agentDashboardContactId,this.agentNavService.activeTopSectionSubject.next("contacts")):this._route.snapshot.params.contactId&&(e=parseInt(this._route.snapshot.params.contactId),this._router.navigate(["agent"],{replaceUrl:!0}),setTimeout(()=>{this.agentNavService.activeTopSectionSubject.next("contacts")},1e3)),this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"Details",contactIds:[e],contactsTotal:null},autoFocus:!1}),this._returnUrlService.agentDashboardContactId=null}$.listen(e=>{var t,n,i;const c=this._authService.getUserId().replace(/-/g,"");if("create_update"===e.action&&"accountsettings"===e.model&&(null===(t=e.instance)||void 0===t?void 0:t.agent_dashboard_banners)&&(this.banners=null===(i=null===(n=e.instance)||void 0===n?void 0:n.agent_dashboard_banners)||void 0===i?void 0:i.banners,this._handleBannerDisplay(!0)),"queue_agent_paused"===e.method&&(this.agentQueueService.handleQueueAgentPausedThunderpush(),"campaigns-queues"===this.agentNavService.activeTopSectionSubject.value&&this.agentQueueService.getQueueAgents()),"connector_updated"===e.method&&this.agentConnectorService.buildConnectorButtonMap(),"connector_member_updated"===e.method&&this.agentConnectorService.getConnectors(),"call_disposition_member_updated"===e.method&&this.agentCallDispositionService.getCallDispositions(),"reregister_phone"===e.method&&(this._webPhoneService.disconnectWebphone(),this._webPhoneService.connectWebphone(this.webPhoneCredentials)),"incoming_sms"===e.method&&(this._playSmsTone("incoming"),!this._permissionService.hasPermission("sms_conversations_page"))){if(this.agentContactService.contactSubject.value&&this.agentContactService.contactSubject.value.id===e.contact_id)return;this._snackBar.open(e.message,"View Contact",{duration:8e3,verticalPosition:"top",panelClass:"success-link"}).afterDismissed().subscribe({next:t=>{t.dismissedByAction&&this._dialog.open(E.a,{width:"1400px",panelClass:["dyn-dialog-no-padding","contact-dialog"],data:{dialogType:"singleEdit",topSection:"SMS",contactIds:[e.contact_id],contactsTotal:null},autoFocus:!1})}})}if("streaming_api"===e.method&&"queue"===e.model&&e.instance&&"create_update"===e.action&&this.agentQueueService.handleQueueThunderpush(e.instance),"campaign_reached_max_dials_daily"===e.method&&this._snackBar.open(""+e.message,"X",{duration:1e4,verticalPosition:"top",panelClass:"error"}),"campaign_out_of_leads"===e.method&&this._snackBar.open(`Campaign ${e.campaign_name} is out of leads`,"X",{duration:1e4,verticalPosition:"top",panelClass:"error"}),"streaming_api"===e.method&&"queue"===e.model&&"delete"===e.action&&this.agentQueueService.handleQueueDeleteThunderpush(e.instance_pk),"streaming_api"===e.method&&"campaign"===e.model&&"create_update"===e.action&&e.instance&&this.agentCampaignService.handleCampaignThunderpush(e.instance),"streaming_api"===e.method&&"campaign"===e.model&&"delete"===e.action&&this.agentCampaignService.handleCampaignDeleteThunderpush(e.instance_pk),"voice_mail_message"===e.method&&(this.agentNavService.showAgentVoicemailAlert=!0,this.agentNavService.newVoicemailReceived.next(!0),this._snackBar.open(e.message,"X",{duration:5e3,verticalPosition:"top",panelClass:"success"})),"campaign_agent_logout"===e.method&&e.app_user_id===c&&this.agentStatusService.agentStatusSubject.value){let t=this.agentStatusService.agentStatusSubject.value;t.campaign=null,this.agentStatusService.agentStatusSubject.next(t),this._snackBar.open(e.message,"X",{duration:5e3,verticalPosition:"top",panelClass:"success"})}if("campaign_agent_login"===e.method&&e.app_user_id===c){let t=this.agentStatusService.agentStatusSubject.value;t&&(t.campaign=e.campaign_id,this.agentStatusService.agentStatusSubject.next(t),this.agentCampaignService.campaignMap[e.campaign_id]||this.agentCampaignService.getCampaignById(e.campaign_id),this._snackBar.open(e.message,"X",{duration:5e3,verticalPosition:"top",panelClass:"success"}))}if("queue_agent_logout"===e.method&&e.app_user_id===c){const t=this.agentQueueService.queueAgents.findIndex(t=>t.queue===e.queue_id);-1!==t&&this.agentQueueService.queueAgents.splice(t,1),this._snackBar.open(e.message,"X",{duration:5e3,verticalPosition:"top",panelClass:"success"})}"queue_agent_login"===e.method&&e.app_user_id===c&&this._snackBar.open(e.message,"X",{duration:5e3,verticalPosition:"top",panelClass:"success"})}),this.webPhoneSessionsService.backgroundCssFlashSubject.subscribe({next:e=>{e&&(this.showBackgroundFlash=!0,setTimeout(()=>{this.showBackgroundFlash=!1},300))}}),this.webPhoneSessionsService.registered||this._getWebphoneCredentials(),this.username=this._authService.getUsername(),this.agentStatusService.getAgentStatus(),this.agentStatusService.getStatuses(),this.agentUserService.getUser(),this.agentUserService.getUsers(),this._agentContactFieldService.getContactFields(),this.agentConnectorService.getConnectors(),this._agentContactDispositionService.getContactDispositions(),this.agentCallDispositionService.getCallDispositions(!0),this.agentAccountSettingService.getAccountSettings(),window.addEventListener("message",this.chromeMessageHandler)}ngOnDestroy(){this._renderer.removeClass(document.body,"dark-theme"),this.agentNavService.activeTopSectionSubject.next("dashboard"),this.agentNavService.activeDashboardSectionSubject.next("contact"),this.agentStatusCheckInterval&&clearInterval(this.agentStatusCheckInterval),this.agentStatusInterval&&clearInterval(this.agentStatusInterval),this.agentStatusSubscription&&this.agentStatusSubscription.unsubscribe(),this.accountSettingSubscription&&this.accountSettingSubscription.unsubscribe(),window.removeEventListener("message",this.chromeMessageHandler)}_handleBannerDisplay(e){var t,n;if(e&&this.banner){const e=this.banners.find(e=>e.id===this.banner.id);this.banner=e&&(null==e?void 0:e.active)?e:null}if((null===(t=this.accountSettings)||void 0===t?void 0:t.agent_dashboard_banners)&&(null===(n=this.accountSettings.agent_dashboard_banners)||void 0===n?void 0:n.banners)){const t=this._authService.getUserId();e||(this.banners=this.accountSettings.agent_dashboard_banners.banners);for(const e of this.banners)if(e.active&&!e.closed_by.includes(t)&&(!(e.show_to_agents.length>0)||e.show_to_agents.includes(t))){this.banner=Object.assign({},e);break}}}onCloseBanner(){this.agentAccountSettingService.updateBannerAction(this.banner.id,"closed").subscribe(),this.banner=null}_checkAgentStatusSync(){this._myAgentStatusService.get().subscribe({next:e=>{e&&this._frontEndBackEndAgentStatusSync(e)}})}_getMyFullAgentStatus(){this.userIsIdle?this.agentStatusCheckInterval||(this.agentStatusCheckInterval=setInterval(()=>{this._checkAgentStatusSync()},6e4*this.frontEndAgentStatusSyncMinutes)):(this.agentStatusCheckInterval&&(clearInterval(this.agentStatusCheckInterval),this.agentStatusCheckInterval=null),this._myFullAgentStatusService.get().subscribe({next:e=>{e.active_time=this._utils.formatSeconds(e.active_time),this.agentDailyStatService.dailyStats=e,this._frontEndBackEndAgentStatusSync({agent_status:e.agent_status,ready:e.ready,campaign:e.campaign})}}))}_frontEndBackEndAgentStatusSync(e){var t,n;let i;i=this.agentStatusService.agentStatusSubject.value?JSON.parse(JSON.stringify(this.agentStatusService.agentStatusSubject.value.agent_status)):null;const c=e.agent_status,a=JSON.parse(JSON.stringify(null===(t=this.agentStatusService.agentStatusSubject.value)||void 0===t?void 0:t.ready));i===c&&a===e.ready||this.agentStatusService.agentStatusSubject.next({ready:e.ready,agent_status:e.agent_status,campaign:e.campaign}),!1===e.ready&&e.campaign&&this.agentStatusService.statusMap[null==e?void 0:e.agent_status]&&"Set Ready"===(null===(n=this.agentStatusService.statusMap[e.agent_status])||void 0===n?void 0:n.campaign_action)&&(this.webPhoneSessionsService.activeSession||(this._webPhoneOverlayService.showOverlay=!0))}_createAgentStatusSubscription(){this.agentStatusSubscription=this.agentStatusService.agentStatusSubject.subscribe({next:e=>{e&&(this.agentDailyStatService.updateDailyStatField("agent_status",e.agent_status),this.agentDailyStatService.updateDailyStatField("campaign",e.campaign))}})}_getWebphoneCredentials(){this._myWebPhoneService.get().subscribe({next:e=>{if(!e)return void(this.showNoPhoneWarning=!0);const t={ws_url:e.ws_url,sip_uri:e.sip_uri,password:e.password};this.webPhoneCredentials=t,this._webPhoneService.storeCredentials(t)}})}_playSmsTone(e){this.incomingSmsAudio.src="/assets/audio/sms/"+e+"-sms.wav",this.incomingSmsAudio.play().catch(()=>{})}_setIdleTimeout(){this.userActivityTimeout=setTimeout(()=>{this.userIsIdle||(this.userIsIdle=!0)},6e4*this.idleTimeoutMinutes)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(a.Q),a.bc(X.a),a.bc(k.a),a.bc(D.a),a.bc(Y.b),a.bc(s.a),a.bc(U.a),a.bc(r.a),a.bc(A.a),a.bc(h.a),a.bc(N),a.bc(Q.a),a.bc(V.a),a.bc(z),a.bc(G.a),a.bc(c.a),a.bc(c.g),a.bc(R.a),a.bc(P.a),a.bc(q.a),a.bc(C.a),a.bc(u.a),a.bc(j),a.bc(p.a),a.bc(d.a),a.bc(l.a),a.bc(g.a),a.bc(b.a),a.bc(v.a),a.bc(f.a),a.bc(m.a),a.bc(L))},e.\u0275cmp=a.Vb({type:e,selectors:[["ng-component"]],hostBindings:function(e,t){1&e&&a.qc("mousemove",(function(){return t.refreshUserState()}),!1,a.Pc)("beforeunload",(function(){return t.onBeforeUnload()}),!1,a.Pc)},outputs:{open:"open"},decls:25,vars:23,consts:[["class","dyn-p-10 dyn-p-l-20 dyn-flex dyn-align-items","style","background: #FDBD00;",4,"ngIf"],[4,"ngIf"],[1,"incoming-call-flash",3,"ngClass"],["id","dashboard",1,"dyn-m-b-20"],["id","stored-contacts","class","dyn-p-20 dyn-p-b-0",4,"ngIf"],[1,"dyn-flex","dyn-space-between"],[1,"dyn-p-20",2,"flex","1","overflow","auto"],[3,"hidden"],[3,"hidden",4,"ngIf"],[1,"dyn-p-10","dyn-p-l-20","dyn-flex","dyn-align-items",2,"background","#FDBD00"],[1,"dyn-full-width","dyn-m-r-20"],[1,"dyn-m-0",2,"font-weight","600","font-size","1rem"],[1,"dyn-vertical-middle","dyn-m-r-10"],["mat-button","",2,"background","#ffde7c","min-width","50px!important",3,"click"],[1,"dyn-flex","dyn-space-between","dyn-align-items","dyn-p-t-10","dyn-p-b-10","dyn-p-l-20","dyn-p-r-20"],[1,"dyn-full-width"],["mat-icon-button","",1,"dyn-button-sm",3,"click"],[1,"dyn-border-top","dyn-bg-yellow","dyn-p-t-5","dyn-p-b-5","dyn-p-l-20","dyn-flex","dyn-space-between","dyn-align-items"],["mat-raised-button","","color","","class","dyn-m-l-20",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"dyn-m-l-10",3,"disabled","click"],["mat-icon-button","",1,"dyn-m-l-20",3,"click"],["mat-raised-button","","color","",1,"dyn-m-l-20",3,"click"],[1,"campaign-queue-color-banner",3,"ngClass"],[1,"dyn-flex","dyn-space-between","dyn-align-items"],[1,"dyn-m-0"],["class","dyn-rounded-btn dyn-m-r-10","style","padding: 2px 10px;",4,"ngIf"],[1,"dyn-flex","dyn-align-items",2,"background","#fff","border-radius","100px","padding","5px 5px 5px 10px","box-shadow","0 2px 9px 0 rgba(0,0,0,0.3)","font-size",".8rem"],["matTooltip","Reset your agent status back to Available.",1,"dyn-m-r-5",3,"matTooltipDisabled"],["src","/assets/img/circle-close-icon-red.svg","height","18px"],["src","/assets/img/circle-checkmark.svg","height","18px"],[1,"dyn-rounded-btn","dyn-m-r-10",2,"padding","2px 10px"],["style","padding: 5px 40px;",3,"background",4,"ngIf"],[2,"padding","5px 40px"],[1,"dyn-m-l-20"],[1,"agent-dash-stats-container"],[1,"dyn-text-center"],[1,"agent-dash-stats-grid"],[1,"grid-item"],[1,"stat-value"],[1,"stat-label"],["id","stored-contacts",1,"dyn-p-20","dyn-p-b-0"],["class","dyn-inline-block dyn-relative dyn-m-r-10 contact-block dyn-cursor-pointer",3,"ngClass","has-stored-note","click",4,"ngFor","ngForOf"],[1,"dyn-text-center","dyn-inline-block","add-stored-contact",3,"click"],[1,"dyn-vertical-middle"],[1,"dyn-inline-block","dyn-relative","dyn-m-r-10","contact-block","dyn-cursor-pointer",3,"ngClass","click"],[1,"dyn-text-sm","dyn-m-r-20",3,"ngClass"],["color","warn","class","dyn-m-r-20 dyn-icon-sm",4,"ngIf"],[1,"dyn-icon-sm","dyn-hover",3,"click"],["color","warn",1,"dyn-m-r-20","dyn-icon-sm"]],template:function(e,t){1&e&&(a.bd(0,Ip,11,1,"div",0),a.bd(1,Tp,5,9,"ng-container",1),a.dc(2,"agent-top-nav"),a.bd(3,Op,11,5,"ng-container",1),a.dc(4,"div",2),a.ic(5,"div",3),a.bd(6,Qp,2,1,"ng-container",1),a.bd(7,Wp,2,1,"ng-container",1),a.bd(8,zp,36,6,"ng-container",1),a.bd(9,ev,5,1,"div",4),a.ic(10,"div",5),a.ic(11,"div"),a.dc(12,"status-dropdown"),a.dc(13,"phone"),a.bd(14,tv,1,0,"app-connectors",1),a.hc(),a.ic(15,"div",6),a.dc(16,"call-disposition-quick-selection"),a.dc(17,"agent-dashboard",7),a.dc(18,"agent-campaigns-queues",7),a.dc(19,"agent-conversations",7),a.dc(20,"agent-contacts",7),a.dc(21,"agent-recent-calls",7),a.dc(22,"agent-voicemails",7),a.dc(23,"agent-calendar-events",7),a.bd(24,nv,1,1,"app-agent-leaderboard",8),a.hc(),a.hc(),a.hc()),2&e&&(a.Bc("ngIf",t.showNoPhoneWarning),a.Pb(1),a.Bc("ngIf",t.banner),a.Pb(2),a.Bc("ngIf",t.agentQueueService.queueAgentPausedNotification),a.Pb(1),a.Bc("ngClass",a.Gc(21,iv,t.showBackgroundFlash)),a.Pb(2),a.Bc("ngIf",t.agentStatusService.agentStatusSubject.value),a.Pb(1),a.Bc("ngIf",t.webPhoneSessionsService.activeSession),a.Pb(1),a.Bc("ngIf","dashboard"===t.agentNavService.activeTopSectionSubject.value&&(null==t.accountSettings?null:t.accountSettings.agent_dash_stats)),a.Pb(1),a.Bc("ngIf",t.agentStoredContactService.storedContacts.length>0),a.Pb(1),a.Tb("dyn-row-reverse",t.userPreferenceService.userPreferenceSubject.value&&"Phone Right 1"===t.userPreferenceService.userPreferenceSubject.value.agent_dashboard_layout),a.Pb(1),a.Rb(t.userPreferenceService.userPreferenceSubject.value&&"Phone Right 1"===t.userPreferenceService.userPreferenceSubject.value.agent_dashboard_layout?"dyn-m-t-20 dyn-m-r-20":"dyn-m-t-20 dyn-m-l-20"),a.Pb(3),a.Bc("ngIf",t.userPreferenceService.userPreferenceSubject.value&&"connectors"!==t.userPreferenceService.userPreferenceSubject.value.agent_dash_lower_section||"dashboard"!==t.agentNavService.activeTopSectionSubject.value||"contact"!==t.agentNavService.activeDashboardSectionSubject.value),a.Pb(3),a.Bc("hidden","dashboard"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","campaigns-queues"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","conversations"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","contacts"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","recent-calls"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","voicemails"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("hidden","calendar-events"!==t.agentNavService.activeTopSectionSubject.value),a.Pb(1),a.Bc("ngIf",t.agentAccountSettingService.accountSettings&&t.agentAccountSettingService.accountSettings.show_agent_leaderboard))},directives:[J.p,Z.a,J.n,re,Et,Wt,Sd,hl,El,$g,db,Xb,kp,ge.a,le.b,ue.a,J.o,Ai,Fp.a],styles:['.incoming-call-flash.show[_ngcontent-%COMP%]{position:fixed;bottom:0;top:0;left:0;right:0;z-index:-1;background:#9fe2d8}#stored-contacts[_ngcontent-%COMP%]   .active-contact[_ngcontent-%COMP%], #stored-contacts[_ngcontent-%COMP%]   .active-contact[_ngcontent-%COMP%]   .dyn-link[_ngcontent-%COMP%]{cursor:not-allowed}#stored-contacts[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]{padding:10px;background:#fff;box-shadow:-2px 2px 11px 0 rgba(0,0,0,.1);opacity:.7;border-left:5px solid #fff;margin:5px 0}#stored-contacts[_ngcontent-%COMP%]   .contact-block.active-contact[_ngcontent-%COMP%]{border-left:5px solid #4fc9b7;opacity:1}#stored-contacts[_ngcontent-%COMP%]   .add-stored-contact[_ngcontent-%COMP%]{border:2px dashed #dcdfe0;width:40px;height:30px;line-height:30px;cursor:pointer}#stored-contacts[_ngcontent-%COMP%]   .add-stored-contact[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#dcdfe0}#stored-contacts[_ngcontent-%COMP%]   .add-stored-contact[_ngcontent-%COMP%]:hover{border:2px dashed #c8ced1}#stored-contacts[_ngcontent-%COMP%]   .add-stored-contact[_ngcontent-%COMP%]:hover   .mat-icon[_ngcontent-%COMP%]{color:#c8ced1}#stored-contacts[_ngcontent-%COMP%]   .has-stored-note[_ngcontent-%COMP%]:before{content:"";background:red;width:10px;height:10px;border-radius:100px;display:inline-block;position:absolute;top:-3px;right:5px}#dashboard[_ngcontent-%COMP%]{background:transparent}#dashboard[_ngcontent-%COMP%]   .dashboard-connection-status[_ngcontent-%COMP%]{font-size:.9rem}#dashboard[_ngcontent-%COMP%]   .dashboard-connection-status[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]{display:inline-block}#dashboard[_ngcontent-%COMP%]   .dashboard-connection-status[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .status-title[_ngcontent-%COMP%]{padding-left:3px}#dashboard[_ngcontent-%COMP%]   .dashboard-connection-status[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .status-circle[_ngcontent-%COMP%]{display:inline-block;width:10px;height:10px;border-radius:100px;background:#bebebe;margin-left:20px;margin-right:5px}#dashboard[_ngcontent-%COMP%]   .dashboard-connection-status[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .status-circle.active[_ngcontent-%COMP%]{background:#26c281}.post-call-pop-up[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;background:#1bbf94;box-sizing:border-box;z-index:9;box-shadow:0 0 30px #a7b1bb}.campaign-queue-color-banner[_ngcontent-%COMP%]{padding:5px 40px}.campaign-queue-color-banner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.campaign-queue-color-banner.light[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000}@keyframes availablePulse{0%{box-shadow:0 0 0 0 rgba(37,193,128,.7)}70%{box-shadow:0 0 0 10px rgba(37,193,128,0)}to{box-shadow:0 0 0 0 rgba(37,193,128,0)}}@keyframes notAvailablePulse{0%{box-shadow:0 0 0 0 rgba(250,83,83,.7)}70%{box-shadow:0 0 0 10px rgba(250,83,83,0)}to{box-shadow:0 0 0 0 rgba(250,83,83,0)}}.mat-menu-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:.5}.mat-menu-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.mat-menu-panel[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{opacity:1;position:relative}@media (max-width:1000px){#dashboard-nav-links[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px}}.campaign-banner[_ngcontent-%COMP%]{padding:5px 40px}.campaign-banner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.campaign-banner.light[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000}.post-call-wrap-up-container[_ngcontent-%COMP%]   .post-call-wrap-up[_ngcontent-%COMP%]{background:#f97979;color:#fff;transition:.3s}.post-call-wrap-up-container[_ngcontent-%COMP%]   .post-call-wrap-up.change-color[_ngcontent-%COMP%]{background:#f45757}.post-call-wrap-up-container[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:space-between;align-items:center;border-radius:100px;color:#fff;font-size:.7rem;padding:3px 10px;background:transparent;border:1px solid rgba(0,0,0,.2);transition:.3ms}.post-call-wrap-up-container[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{background:rgba(0,0,0,.31)}.post-call-wrap-up-container[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);border-color:transparent}.agent-dash-stats-container[_ngcontent-%COMP%]{padding:15px 20px 10px;box-sizing:border-box}.agent-dash-stats-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px;font-size:1rem}.agent-dash-stats-container[_ngcontent-%COMP%]   .agent-dash-stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:10px}.agent-dash-stats-container[_ngcontent-%COMP%]   .agent-dash-stats-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]{background-color:#fff;padding:10px;box-sizing:border-box;text-align:center;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);font-size:1rem;color:#333}.agent-dash-stats-container[_ngcontent-%COMP%]   .agent-dash-stats-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.7rem;color:#666}'],data:{animation:[Object(o.o)("slideInOut",[Object(o.n)(":enter",[Object(o.m)({height:0,opacity:0,overflow:"hidden"}),Object(o.e)("200ms ease-out",Object(o.m)({height:"*",opacity:1,overflow:"hidden"}))]),Object(o.n)(":leave",[Object(o.m)({height:"*",opacity:1,overflow:"hidden"}),Object(o.e)("200ms ease-in",Object(o.m)({height:0,opacity:0,overflow:"hidden"}))])]),Object(o.o)("enterAnimation",[Object(o.n)(":enter",[Object(o.m)({transform:"translateY(100%)",opacity:0}),Object(o.e)("500ms",Object(o.m)({transform:"translateY(0)",opacity:1}))]),Object(o.n)(":leave",[Object(o.m)({transform:"translateY(0)",opacity:1}),Object(o.e)("500ms",Object(o.m)({transform:"translateY(100%)",opacity:0}))])])]}}),e})();const av=[{path:"",component:cv},{path:"contacts/:contactId",component:cv},{path:"**",redirectTo:"",pathMatch:"full"}];let ov=(()=>{class e{}return e.\u0275mod=a.Zb({type:e}),e.\u0275inj=a.Yb({factory:function(t){return new(t||e)},imports:[[c.j.forChild(av)],c.j]}),e})();var sv=n("yKv3"),rv=n("pKmL"),dv=n("/INB");let lv=(()=>{class e{}return e.\u0275mod=a.Zb({type:e}),e.\u0275inj=a.Yb({factory:function(t){return new(t||e)},imports:[[i.a,ov,sv.a,on.c,on.e,rv.a,dv.ManagerAgentLeaderboardModule]]}),e})()}}]);